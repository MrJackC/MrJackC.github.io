import{_ as a,c as n,a as B,o as r}from"./app-mWs04Xnh.js";const i={};function l(t,s){return r(),n("div",null,s[0]||(s[0]=[B(`<h1 id="sql窗口函数-二-——-连续问题" tabindex="-1"><a class="header-anchor" href="#sql窗口函数-二-——-连续问题"><span>SQL窗口函数（二）—— 连续问题</span></a></h1><h3 id="题目一" tabindex="-1"><a class="header-anchor" href="#题目一"><span>题目一</span></a></h3><h4 id="表格" tabindex="-1"><a class="header-anchor" href="#表格"><span>表格</span></a></h4><table><thead><tr><th>user_id</th><th>login_date</th></tr></thead><tbody><tr><td>A</td><td>2022-09-02</td></tr><tr><td>A</td><td>2022-09-03</td></tr><tr><td>A</td><td>2022-09-04</td></tr><tr><td>B</td><td>2021-11-25</td></tr><tr><td>B</td><td>2021-12-31</td></tr><tr><td>C</td><td>2022-01-01</td></tr><tr><td>C</td><td>2022-04-04</td></tr><tr><td>C</td><td>2022-09-03</td></tr><tr><td>C</td><td>2022-09-04</td></tr><tr><td>C</td><td>2022-09-05</td></tr><tr><td>A</td><td>2022-09-03</td></tr><tr><td>D</td><td>2022-10-20</td></tr><tr><td>D</td><td>2022-10-21</td></tr><tr><td>A</td><td>2022-10-03</td></tr><tr><td>D</td><td>2022-10-22</td></tr><tr><td>D</td><td>2022-10-23</td></tr><tr><td>B</td><td>2022-01-04</td></tr><tr><td>B</td><td>2022-01-05</td></tr><tr><td>B</td><td>2022-11-16</td></tr><tr><td>B</td><td>2022-11-17</td></tr></tbody></table><h4 id="脚本" tabindex="-1"><a class="header-anchor" href="#脚本"><span>脚本</span></a></h4><div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> TABLE</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> SQL_8</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">     user_id 	</span><span style="color:#C678DD;--shiki-dark:#C678DD;">varchar</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">     login_date </span><span style="color:#C678DD;--shiki-dark:#C678DD;">date</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">INSERT INTO</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> SQL_8 (user_id,login_date)</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">VALUES</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;A&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2022-09-02&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">), (</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;A&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2022-09-03&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">), (</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;A&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2022-09-04&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">), (</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;B&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2021-11-25&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">       (</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;B&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2021-12-31&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">), (</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;C&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2022-01-01&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">), (</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;C&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2022-04-04&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">), (</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;C&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2022-09-03&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">       (</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;C&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2022-09-05&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">), (</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;C&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2022-09-04&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">), (</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;A&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2022-09-03&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">), (</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;D&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2022-10-20&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">       (</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;D&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2022-10-21&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">), (</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;A&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2022-10-03&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">), (</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;D&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2022-10-22&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">), (</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;D&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2022-10-23&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">       (</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;B&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2022-01-04&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">), (</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;B&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2022-01-05&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">), (</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;B&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2022-11-16&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">), (</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;B&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2022-11-17&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span></code></pre></div><h4 id="问题" tabindex="-1"><a class="header-anchor" href="#问题"><span>问题</span></a></h4><p>找出这张表中所有的连续3天登录用户</p><h4 id="分析" tabindex="-1"><a class="header-anchor" href="#分析"><span>分析</span></a></h4><p>连续N天登录用户，要求数据行满足以下条件：</p><ol><li><p>userid 要相同，表示同一用户</p></li><li><p>同一用户每行记录以登录时间从小到大排序</p></li><li><p>后一行记录比前一行记录的登录时间多一天</p></li><li><p>数据行数大于等于N</p></li></ol><h4 id="解答" tabindex="-1"><a class="header-anchor" href="#解答"><span>解答</span></a></h4><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- 方法一</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">with</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> t1 </span><span style="color:#C678DD;--shiki-dark:#C678DD;">as</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    select distinct</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> user_id, login_date </span><span style="color:#C678DD;--shiki-dark:#C678DD;">from</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> SQL_8</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">t2 </span><span style="color:#C678DD;--shiki-dark:#C678DD;">as</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    select</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> *, </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">row_number</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">() </span><span style="color:#C678DD;--shiki-dark:#C678DD;">over</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="color:#C678DD;--shiki-dark:#C678DD;">partition</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> by</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> user_id </span><span style="color:#C678DD;--shiki-dark:#C678DD;">order by</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> login_date) </span><span style="color:#C678DD;--shiki-dark:#C678DD;">as</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> rn </span><span style="color:#C678DD;--shiki-dark:#C678DD;">from</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> t1</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">t3 </span><span style="color:#C678DD;--shiki-dark:#C678DD;">as</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    select</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> *, DATE_SUB(login_date, interval rn </span><span style="color:#C678DD;--shiki-dark:#C678DD;">day</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#C678DD;--shiki-dark:#C678DD;">as</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> sub </span><span style="color:#C678DD;--shiki-dark:#C678DD;">from</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> t2</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">select distinct</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> user_id </span><span style="color:#C678DD;--shiki-dark:#C678DD;">from</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> t3 </span><span style="color:#C678DD;--shiki-dark:#C678DD;">group by</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> user_id, sub </span><span style="color:#C678DD;--shiki-dark:#C678DD;">having</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> count</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(user_id) </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">&gt;=</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- 方法二</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">with</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> t1 </span><span style="color:#C678DD;--shiki-dark:#C678DD;">as</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    select distinct</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> user_id, login_date </span><span style="color:#C678DD;--shiki-dark:#C678DD;">from</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> SQL_8</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">t2 </span><span style="color:#C678DD;--shiki-dark:#C678DD;">as</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    select</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> *, </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">DATEDIFF</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(login_date, </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">lag</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(login_date, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#C678DD;--shiki-dark:#C678DD;">over</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="color:#C678DD;--shiki-dark:#C678DD;">partition</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> by</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> user_id </span><span style="color:#C678DD;--shiki-dark:#C678DD;">order by</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> login_date)) </span><span style="color:#C678DD;--shiki-dark:#C678DD;">as</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> diff,</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">           DATEDIFF</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(login_date, </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">lag</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(login_date, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#C678DD;--shiki-dark:#C678DD;">over</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="color:#C678DD;--shiki-dark:#C678DD;">partition</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> by</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> user_id </span><span style="color:#C678DD;--shiki-dark:#C678DD;">order by</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> login_date)) </span><span style="color:#C678DD;--shiki-dark:#C678DD;">as</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> diff2 </span><span style="color:#C678DD;--shiki-dark:#C678DD;">from</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> t1</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;"> select distinct</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> user_id </span><span style="color:#C678DD;--shiki-dark:#C678DD;">from</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> t2 </span><span style="color:#C678DD;--shiki-dark:#C678DD;">where</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> diff </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> and</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> diff2 </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 2</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> group by</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> user_id;</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="题目二" tabindex="-1"><a class="header-anchor" href="#题目二"><span>题目二</span></a></h3><h4 id="表格-1" tabindex="-1"><a class="header-anchor" href="#表格-1"><span>表格</span></a></h4><table><thead><tr><th>player_id</th><th>score</th><th>score_time</th></tr></thead><tbody><tr><td>B3</td><td>1</td><td>2022-09-20 19:00:14</td></tr><tr><td>A2</td><td>1</td><td>2022-09-20 19:01:04</td></tr><tr><td>A2</td><td>3</td><td>2022-09-20 19:01:16</td></tr><tr><td>A2</td><td>3</td><td>2022-09-20 19:02:05</td></tr><tr><td>A2</td><td>2</td><td>2022-09-20 19:02:25</td></tr><tr><td>B3</td><td>2</td><td>2022-09-20 19:02:54</td></tr><tr><td>A4</td><td>3</td><td>2022-09-20 19:03:10</td></tr><tr><td>B1</td><td>2</td><td>2022-09-20 19:03:34</td></tr><tr><td>B1</td><td>2</td><td>2022-09-20 19:03:58</td></tr><tr><td>B1</td><td>3</td><td>2022-09-20 19:04:07</td></tr><tr><td>A2</td><td>1</td><td>2022-09-20 19:04:19</td></tr><tr><td>B3</td><td>2</td><td>2022-09-20 19:04:31</td></tr><tr><td>A1</td><td>2</td><td>2022-09-20 19:04:51</td></tr><tr><td>A1</td><td>2</td><td>2022-09-20 19:05:01</td></tr><tr><td>B4</td><td>2</td><td>2022-09-20 19:05:06</td></tr><tr><td>A1</td><td>2</td><td>2022-09-20 19:05:26</td></tr><tr><td>A1</td><td>2</td><td>2022-09-20 19:05:48</td></tr><tr><td>B4</td><td>2</td><td>2022-09-20 19:05:58</td></tr></tbody></table><h4 id="脚本-1" tabindex="-1"><a class="header-anchor" href="#脚本-1"><span>脚本</span></a></h4><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> TABLE</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> SQL_9</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">     player_id 	</span><span style="color:#C678DD;--shiki-dark:#C678DD;">varchar</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">     score      </span><span style="color:#C678DD;--shiki-dark:#C678DD;">int</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">     score_time </span><span style="color:#C678DD;--shiki-dark:#C678DD;">datetime</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">INSERT INTO</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> SQL_9 (player_id, score, score_time)</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">VALUES</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;B3&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2022-09-20 19:00:14&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">), (</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;A2&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2022-09-20 19:01:04&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">       (</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;A2&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2022-09-20 19:01:16&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">), (</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;A2&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2022-09-20 19:02:05&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">       (</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;A2&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2022-09-20 19:02:25&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">), (</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;B3&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2022-09-20 19:02:54&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">       (</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;A4&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2022-09-20 19:03:10&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">), (</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;B1&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2022-09-20 19:03:34&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">       (</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;B1&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2022-09-20 19:03:58&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">), (</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;B1&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2022-09-20 19:04:07&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">       (</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;A2&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2022-09-20 19:04:19&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">), (</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;B3&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2022-09-20 19:04:31&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">       (</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;A1&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2022-09-20 19:04:51&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">), (</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;A1&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2022-09-20 19:05:01&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">       (</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;B4&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2022-09-20 19:05:06&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">), (</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;A1&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2022-09-20 19:05:26&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">       (</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;A1&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2022-09-20 19:05:48&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">), (</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;B4&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2022-09-20 19:05:58&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="问题-1" tabindex="-1"><a class="header-anchor" href="#问题-1"><span>问题</span></a></h4><p>统计出连续三次（及以上）为球队得分的球员名单</p><h4 id="分析-1" tabindex="-1"><a class="header-anchor" href="#分析-1"><span>分析</span></a></h4><p>连续N次以上为球队得分， 要求数据行满足以下条件：</p><ol><li><p>player_id 要相同表示同一球员</p></li><li><p>每行记录以得分时间从小到大排序</p></li><li><p>数据行数大于等于N</p></li></ol><h4 id="解答-1" tabindex="-1"><a class="header-anchor" href="#解答-1"><span>解答</span></a></h4><div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">with</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> t1 </span><span style="color:#C678DD;--shiki-dark:#C678DD;">as</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    select</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> *, </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">lag</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(player_id, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#C678DD;--shiki-dark:#C678DD;">over</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="color:#C678DD;--shiki-dark:#C678DD;">order by</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> score_time) </span><span style="color:#C678DD;--shiki-dark:#C678DD;">as</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> last_play_id,</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">           lag</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(player_id, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#C678DD;--shiki-dark:#C678DD;">over</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="color:#C678DD;--shiki-dark:#C678DD;">order by</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> score_time) </span><span style="color:#C678DD;--shiki-dark:#C678DD;">as</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> last_two_play_id </span><span style="color:#C678DD;--shiki-dark:#C678DD;">from</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> SQL_9</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">select distinct</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> player_id </span><span style="color:#C678DD;--shiki-dark:#C678DD;">from</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> t1 </span><span style="color:#C678DD;--shiki-dark:#C678DD;">where</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> player_id </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> last_play_id </span><span style="color:#C678DD;--shiki-dark:#C678DD;">and</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> last_play_id </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> last_two_play_id </span><span style="color:#C678DD;--shiki-dark:#C678DD;">group by</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> player_id;</span></span></code></pre></div><h3 id="题目三" tabindex="-1"><a class="header-anchor" href="#题目三"><span>题目三</span></a></h3><h4 id="表格-2" tabindex="-1"><a class="header-anchor" href="#表格-2"><span>表格</span></a></h4><table><thead><tr><th style="text-align:center;">log_id</th></tr></thead><tbody><tr><td style="text-align:center;">1</td></tr><tr><td style="text-align:center;">2</td></tr><tr><td style="text-align:center;">3</td></tr><tr><td style="text-align:center;">7</td></tr><tr><td style="text-align:center;">8</td></tr><tr><td style="text-align:center;">10</td></tr></tbody></table><h4 id="脚本-2" tabindex="-1"><a class="header-anchor" href="#脚本-2"><span>脚本</span></a></h4><div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> TABLE</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> SQL_10</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">     log_id  </span><span style="color:#C678DD;--shiki-dark:#C678DD;">int</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">INSERT INTO</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> SQL_10 (log_id) </span><span style="color:#C678DD;--shiki-dark:#C678DD;">VALUES</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">), (</span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">), (</span><span style="color:#D19A66;--shiki-dark:#D19A66;">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">), (</span><span style="color:#D19A66;--shiki-dark:#D19A66;">7</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">), (</span><span style="color:#D19A66;--shiki-dark:#D19A66;">8</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">), (</span><span style="color:#D19A66;--shiki-dark:#D19A66;">10</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);</span></span></code></pre></div><h4 id="问题-2" tabindex="-1"><a class="header-anchor" href="#问题-2"><span>问题</span></a></h4><p>编写SQL 查询得到 Logs 表中的连续区间的开始数字和结束数字。按照 start_id 排序。查询结果格式如下:</p><table><thead><tr><th>start_id</th><th>end_id</th></tr></thead><tbody><tr><td>1</td><td>3</td></tr><tr><td>7</td><td>8</td></tr><tr><td>10</td><td>10</td></tr></tbody></table><h4 id="解答-2" tabindex="-1"><a class="header-anchor" href="#解答-2"><span>解答</span></a></h4><div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">with</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> t1 </span><span style="color:#C678DD;--shiki-dark:#C678DD;">as</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    select</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> *, log_id - </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">row_number</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">() </span><span style="color:#C678DD;--shiki-dark:#C678DD;">over</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="color:#C678DD;--shiki-dark:#C678DD;">order by</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> log_id) </span><span style="color:#C678DD;--shiki-dark:#C678DD;">as</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> gr </span><span style="color:#C678DD;--shiki-dark:#C678DD;">from</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> SQL_10</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">select</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> min</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(log_id) </span><span style="color:#C678DD;--shiki-dark:#C678DD;">as</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> start_id, </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">max</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(log_id) </span><span style="color:#C678DD;--shiki-dark:#C678DD;">as</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> end_id </span><span style="color:#C678DD;--shiki-dark:#C678DD;">from</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> t1 </span><span style="color:#C678DD;--shiki-dark:#C678DD;">group by</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> gr</span></span></code></pre></div><h3 id="技巧" tabindex="-1"><a class="header-anchor" href="#技巧"><span>技巧</span></a></h3><p>如何求连续区间？</p><p>1）行号过滤法</p><p>​ 通过row_number() 生成连续行号，与区间列进行差值运算，得到的临时结果如果相同表示为同一连续区间</p><p>2） 错位比较法</p><p>​ 通过row_number() / row_number() + 1 分别生成原生的和错位的连续行号列，进行连表操作</p><p>​ 也可以通过lag/lead函数直接生成错位列</p>`,42)]))}const o=a(i,[["render",l],["__file","SQL窗口函数（二）.html.vue"]]),d=JSON.parse('{"path":"/posts/Database/MySQL/SQL%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0%EF%BC%88%E4%BA%8C%EF%BC%89.html","title":"13、SQL窗口函数（二）","lang":"zh-CN","frontmatter":{"title":"13、SQL窗口函数（二）","date":"2024-03-10 18:59","category":["数据库"],"tag":["MySQL"],"description":"SQL窗口函数（二）—— 连续问题 题目一 表格 脚本 问题 找出这张表中所有的连续3天登录用户 分析 连续N天登录用户，要求数据行满足以下条件： userid 要相同，表示同一用户 同一用户每行记录以登录时间从小到大排序 后一行记录比前一行记录的登录时间多一天 数据行数大于等于N 解答 题目二 表格 脚本 问题 统计出连续三次（及以上）为球队得分的球...","head":[["meta",{"property":"og:url","content":"https://springg.us.kg/posts/Database/MySQL/SQL%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0%EF%BC%88%E4%BA%8C%EF%BC%89.html"}],["meta",{"property":"og:site_name","content":"mrjason’s Blog"}],["meta",{"property":"og:title","content":"13、SQL窗口函数（二）"}],["meta",{"property":"og:description","content":"SQL窗口函数（二）—— 连续问题 题目一 表格 脚本 问题 找出这张表中所有的连续3天登录用户 分析 连续N天登录用户，要求数据行满足以下条件： userid 要相同，表示同一用户 同一用户每行记录以登录时间从小到大排序 后一行记录比前一行记录的登录时间多一天 数据行数大于等于N 解答 题目二 表格 脚本 问题 统计出连续三次（及以上）为球队得分的球..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-10-21T07:03:09.000Z"}],["meta",{"property":"article:author","content":"MrJason"}],["meta",{"property":"article:tag","content":"MySQL"}],["meta",{"property":"article:published_time","content":"2024-03-10T18:59:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-10-21T07:03:09.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"13、SQL窗口函数（二）\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2024-03-10T18:59:00.000Z\\",\\"dateModified\\":\\"2024-10-21T07:03:09.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"MrJason\\",\\"url\\":\\"https://springg.us.kg\\"}]}"]]},"headers":[{"level":3,"title":"题目一","slug":"题目一","link":"#题目一","children":[]},{"level":3,"title":"题目二","slug":"题目二","link":"#题目二","children":[]},{"level":3,"title":"题目三","slug":"题目三","link":"#题目三","children":[]},{"level":3,"title":"技巧","slug":"技巧","link":"#技巧","children":[]}],"git":{"createdTime":1729494189000,"updatedTime":1729494189000,"contributors":[{"name":"MrJason","email":"845886914@qq.com","commits":1}]},"readingTime":{"minutes":3.61,"words":1082},"filePathRelative":"posts/Database/MySQL/SQL窗口函数（二）.md","localizedDate":"2024年3月10日","excerpt":"\\n<h3>题目一</h3>\\n<h4>表格</h4>\\n<table>\\n<thead>\\n<tr>\\n<th>user_id</th>\\n<th>login_date</th>\\n</tr>\\n</thead>\\n<tbody>\\n<tr>\\n<td>A</td>\\n<td>2022-09-02</td>\\n</tr>\\n<tr>\\n<td>A</td>\\n<td>2022-09-03</td>\\n</tr>\\n<tr>\\n<td>A</td>\\n<td>2022-09-04</td>\\n</tr>\\n<tr>\\n<td>B</td>\\n<td>2021-11-25</td>\\n</tr>\\n<tr>\\n<td>B</td>\\n<td>2021-12-31</td>\\n</tr>\\n<tr>\\n<td>C</td>\\n<td>2022-01-01</td>\\n</tr>\\n<tr>\\n<td>C</td>\\n<td>2022-04-04</td>\\n</tr>\\n<tr>\\n<td>C</td>\\n<td>2022-09-03</td>\\n</tr>\\n<tr>\\n<td>C</td>\\n<td>2022-09-04</td>\\n</tr>\\n<tr>\\n<td>C</td>\\n<td>2022-09-05</td>\\n</tr>\\n<tr>\\n<td>A</td>\\n<td>2022-09-03</td>\\n</tr>\\n<tr>\\n<td>D</td>\\n<td>2022-10-20</td>\\n</tr>\\n<tr>\\n<td>D</td>\\n<td>2022-10-21</td>\\n</tr>\\n<tr>\\n<td>A</td>\\n<td>2022-10-03</td>\\n</tr>\\n<tr>\\n<td>D</td>\\n<td>2022-10-22</td>\\n</tr>\\n<tr>\\n<td>D</td>\\n<td>2022-10-23</td>\\n</tr>\\n<tr>\\n<td>B</td>\\n<td>2022-01-04</td>\\n</tr>\\n<tr>\\n<td>B</td>\\n<td>2022-01-05</td>\\n</tr>\\n<tr>\\n<td>B</td>\\n<td>2022-11-16</td>\\n</tr>\\n<tr>\\n<td>B</td>\\n<td>2022-11-17</td>\\n</tr>\\n</tbody>\\n</table>","autoDesc":true}');export{o as comp,d as data};
