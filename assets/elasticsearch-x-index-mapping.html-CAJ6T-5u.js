import{_ as a,c as n,a as i,o as e}from"./app-tJW29Kmg.js";const l={};function o(r,s){return e(),n("div",null,s[0]||(s[0]=[i(`<h1 id="es详解-索引-索引管理详解" tabindex="-1"><a class="header-anchor" href="#es详解-索引-索引管理详解"><span>ES详解 - 索引：索引管理详解</span></a></h1><blockquote><p>了解基本使用后，我们从索引操作的角度看看如何对索引进行管理。</p></blockquote><h2 id="_1-索引管理的引入" tabindex="-1"><a class="header-anchor" href="#_1-索引管理的引入"><span>1. 索引管理的引入</span></a></h2><p>我们在前文中增加文档时，如下的语句会动态创建一个customer的index：</p><div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">PUT</span><span style="color:#98C379;--shiki-dark:#98C379;"> /customer/_doc/1</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">  &quot;name&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;John Doe&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre></div><p>而这个index实际上已经自动创建了它里面的字段（name）的类型。我们不妨看下它自动创建的mapping：</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  &quot;mappings&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    &quot;_doc&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">      &quot;properties&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        &quot;name&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">          &quot;type&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;text&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">          &quot;fields&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">            &quot;keyword&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">              &quot;type&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;keyword&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">              &quot;ignore_above&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: </span><span style="color:#D19A66;--shiki-dark:#D19A66;">256</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">            }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">          }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">      }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>那么如果我们需要对这个建立索引的过程做更多的控制：比如想要确保这个索引有数量适中的主分片，并且在我们索引任何数据之前，分析器和映射已经被建立好。那么就会引入两点：第一个<strong>禁止自动创建索引</strong>，第二个是<strong>手动创建索引</strong>。</p><ul><li>禁止自动创建索引</li></ul><p>可以通过在 config/elasticsearch.yml 的每个节点下添加下面的配置：</p><div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">action.auto_create_index:</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> false</span></span></code></pre></div><p>手动创建索引就是接下来文章的内容。</p><h2 id="_2-索引的格式" tabindex="-1"><a class="header-anchor" href="#_2-索引的格式"><span>2. 索引的格式</span></a></h2><p>在请求体里面传入设置或类型映射，如下所示：</p><div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">PUT</span><span style="color:#98C379;--shiki-dark:#98C379;"> /my_index</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    &quot;settings&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#98C379;--shiki-dark:#98C379;"> {</span><span style="color:#98C379;--shiki-dark:#98C379;"> ...</span><span style="color:#98C379;--shiki-dark:#98C379;"> any</span><span style="color:#98C379;--shiki-dark:#98C379;"> settings</span><span style="color:#98C379;--shiki-dark:#98C379;"> ...</span><span style="color:#98C379;--shiki-dark:#98C379;"> },</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    &quot;mappings&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#98C379;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">        &quot;properties&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#98C379;--shiki-dark:#98C379;"> {</span><span style="color:#98C379;--shiki-dark:#98C379;"> ...</span><span style="color:#98C379;--shiki-dark:#98C379;"> any</span><span style="color:#98C379;--shiki-dark:#98C379;"> properties</span><span style="color:#98C379;--shiki-dark:#98C379;"> ...</span><span style="color:#98C379;--shiki-dark:#98C379;"> }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre></div><ul><li><strong>settings</strong>: 用来设置分片,副本等配置信息</li><li><strong>mappings</strong>: 字段映射，类型等 <ul><li><strong>properties</strong>: 由于type在后续版本中会被Deprecated, 所以无需被type嵌套</li></ul></li></ul><h2 id="_3-索引管理操作" tabindex="-1"><a class="header-anchor" href="#_3-索引管理操作"><span>3. 索引管理操作</span></a></h2><blockquote><p>我们通过kibana的devtool来学习索引的管理操作。</p></blockquote><h3 id="_3-1-创建索引" tabindex="-1"><a class="header-anchor" href="#_3-1-创建索引"><span>3.1 创建索引</span></a></h3><p>我们创建一个user 索引<code>test-index-users</code>，其中包含三个属性：name，age, remarks; 存储在一个分片一个副本上。</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">PUT</span><span style="color:#98C379;--shiki-dark:#98C379;"> /test-index-users</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">  &quot;settings&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#98C379;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">		&quot;number_of_shards&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#98C379;--shiki-dark:#98C379;"> 1,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">		&quot;number_of_replicas&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">	},</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">  &quot;mappings&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#98C379;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    &quot;properties&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#98C379;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">      &quot;name&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#98C379;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">        &quot;type&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;text&quot;,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">        &quot;fields&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#98C379;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">          &quot;keyword&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#98C379;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">            &quot;type&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;keyword&quot;,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">            &quot;ignore_above&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 256</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">          }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">      },</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">      &quot;age&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#98C379;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">        &quot;type&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;long&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">      },</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">      &quot;remarks&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#98C379;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">        &quot;type&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;text&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">      }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>执行结果</p><figure><img src="https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202403121430469.png" alt="image-20220804220348876" tabindex="0" loading="lazy"><figcaption>image-20220804220348876</figcaption></figure><ul><li><strong>插入测试数据</strong></li></ul><div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">post</span><span style="color:#98C379;--shiki-dark:#98C379;"> /test-index-users/_doc</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">  &quot;name&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;zhangsan&quot;</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">  &quot;age&quot;</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">:18,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">  &quot;remarks&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;hello world&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre></div><figure><img src="https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202403121430505.png" alt="image-20220804220620567" tabindex="0" loading="lazy"><figcaption>image-20220804220620567</figcaption></figure><ul><li>查看数据</li></ul><div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">GET</span><span style="color:#98C379;--shiki-dark:#98C379;"> /test-index-users/_search</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">  &quot;query&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#98C379;--shiki-dark:#98C379;"> {&quot;match_all&quot;:</span><span style="color:#98C379;--shiki-dark:#98C379;"> {}}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre></div><figure><img src="https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202403121430541.png" alt="image-20220804220806547" tabindex="0" loading="lazy"><figcaption>image-20220804220806547</figcaption></figure><ul><li>我们再<strong>测试下不匹配的数据类型</strong>(age)：</li></ul><div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">POST</span><span style="color:#98C379;--shiki-dark:#98C379;"> /test-index-users/_doc</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">  &quot;name&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;test user&quot;,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">  &quot;age&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;error_age&quot;,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">  &quot;remarks&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;hello eeee&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre></div><p>你可以看到无法类型不匹配的错误：</p><figure><img src="https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202403121430577.png" alt="image-20220804220942671" tabindex="0" loading="lazy"><figcaption>image-20220804220942671</figcaption></figure><h3 id="_3-2-修改索引" tabindex="-1"><a class="header-anchor" href="#_3-2-修改索引"><span>3.2 修改索引</span></a></h3><p>查看刚才的索引,<code>curl &#39;localhost:9200/_cat/indices?v&#39; | grep users</code></p><div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">yellow</span><span style="color:#98C379;--shiki-dark:#98C379;"> open</span><span style="color:#98C379;--shiki-dark:#98C379;"> test-index-users</span><span style="color:#98C379;--shiki-dark:#98C379;">                          LSaIB57XSC6uVtGQHoPYxQ</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#D19A66;--shiki-dark:#D19A66;">     1</span><span style="color:#D19A66;--shiki-dark:#D19A66;">    0</span><span style="color:#98C379;--shiki-dark:#98C379;">   4.4kb</span><span style="color:#98C379;--shiki-dark:#98C379;">   4.4kb</span></span></code></pre></div><p>我们注意到刚创建的索引的状态是yellow的，因为我测试的环境是单点环境，无法创建副本，但是在上述<code>number_of_replicas</code>配置中设置了副本数是1； 所以在这个时候我们需要修改索引的配置。</p><p>修改副本数量为0</p><div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">PUT</span><span style="color:#98C379;--shiki-dark:#98C379;"> /test-index-users/_settings</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">  &quot;settings&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#98C379;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    &quot;number_of_replicas&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre></div><figure><img src="https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202403121430605.png" alt="image-20220804221203156" tabindex="0" loading="lazy"><figcaption>image-20220804221203156</figcaption></figure><p>再次查看状态：</p><div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">green</span><span style="color:#98C379;--shiki-dark:#98C379;"> open</span><span style="color:#98C379;--shiki-dark:#98C379;"> test-index-users</span><span style="color:#98C379;--shiki-dark:#98C379;">                          LSaIB57XSC6uVtGQHoPYxQ</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#D19A66;--shiki-dark:#D19A66;">     1</span><span style="color:#D19A66;--shiki-dark:#D19A66;">    0</span><span style="color:#98C379;--shiki-dark:#98C379;">   4.4kb</span><span style="color:#98C379;--shiki-dark:#98C379;">   4.4kb</span></span></code></pre></div><h3 id="_3-3-打开-关闭索引" tabindex="-1"><a class="header-anchor" href="#_3-3-打开-关闭索引"><span>3.3 打开/关闭索引</span></a></h3><ul><li><p><strong>关闭索引</strong></p><div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">POST</span><span style="color:#98C379;--shiki-dark:#98C379;"> /test-index-users/_close</span></span></code></pre></div></li></ul><p>一旦索引被关闭，那么这个索引只能显示元数据信息，<strong>不能够进行读写操作</strong>。</p><figure><img src="https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202403121430628.png" alt="image-20220804221359572" tabindex="0" loading="lazy"><figcaption>image-20220804221359572</figcaption></figure><p>当关闭以后，再插入数据时：</p><figure><img src="https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202403121430661.png" alt="image-20220804221616801" tabindex="0" loading="lazy"><figcaption>image-20220804221616801</figcaption></figure><ul><li><strong>打开索引</strong></li></ul><figure><img src="https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202403121430691.png" alt="image-20220804221707621" tabindex="0" loading="lazy"><figcaption>image-20220804221707621</figcaption></figure><p>打开后又可以重新写数据了</p><figure><img src="https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202403121430719.png" alt="image-20220804221723173" tabindex="0" loading="lazy"><figcaption>image-20220804221723173</figcaption></figure><h3 id="_3-4-删除索引" tabindex="-1"><a class="header-anchor" href="#_3-4-删除索引"><span>3.4 删除索引</span></a></h3><p>最后我们将创建的test-index-users删除。</p><div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">DELETE</span><span style="color:#98C379;--shiki-dark:#98C379;"> /test-index-users</span></span></code></pre></div><figure><img src="https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202403121430747.png" alt="image-20220804221813596" tabindex="0" loading="lazy"><figcaption>image-20220804221813596</figcaption></figure><h3 id="_3-5-查看索引" tabindex="-1"><a class="header-anchor" href="#_3-5-查看索引"><span>3.5 查看索引</span></a></h3><p>由于test-index-users被删除，所以我们看下之前bank的索引的信息</p><ul><li><strong>mapping</strong></li></ul><div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">GET</span><span style="color:#98C379;--shiki-dark:#98C379;"> /bank/_mapping</span></span></code></pre></div><figure><img src="https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202403121430776.png" alt="image-20220804222117904" tabindex="0" loading="lazy"><figcaption>image-20220804222117904</figcaption></figure><ul><li><strong>settings</strong></li></ul><div class="language-bash" data-ext="bash" data-title="bash"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">GET</span><span style="color:#98C379;--shiki-dark:#98C379;"> /bank/_settings</span></span></code></pre></div><figure><img src="https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202403121430798.png" alt="image-20220804222140597" tabindex="0" loading="lazy"><figcaption>image-20220804222140597</figcaption></figure><h2 id="_4-kibana管理索引" tabindex="-1"><a class="header-anchor" href="#_4-kibana管理索引"><span>4. Kibana管理索引</span></a></h2><p>在Kibana如下路径，我们可以查看和管理索引</p><figure><img src="https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202403121430826.png" alt="image-20220804222249667" tabindex="0" loading="lazy"><figcaption>image-20220804222249667</figcaption></figure><h2 id="参考文章" tabindex="-1"><a class="header-anchor" href="#参考文章"><span>参考文章</span></a></h2><p><a href="https://pdai.tech/md/db/nosql-es/elasticsearch-x-index-mapping.html" target="_blank" rel="noopener noreferrer"><strong>ES详解 - 索引：索引管理详解</strong></a></p>`,69)]))}const t=a(l,[["render",o],["__file","elasticsearch-x-index-mapping.html.vue"]]),c=JSON.parse('{"path":"/posts/Database/ES/elasticsearch-x-index-mapping.html","title":"ES详解 - 索引：索引管理详解","lang":"zh-CN","frontmatter":{"aliases":"ES详解 - 索引：索引管理详解","tags":null,"cssclass":null,"source":null,"order":60,"category":["ElasticSearch"],"created":"2024-02-22 10:49","updated":"2024-03-12 14:31","description":"ES详解 - 索引：索引管理详解 了解基本使用后，我们从索引操作的角度看看如何对索引进行管理。 1. 索引管理的引入 我们在前文中增加文档时，如下的语句会动态创建一个customer的index： 而这个index实际上已经自动创建了它里面的字段（name）的类型。我们不妨看下它自动创建的mapping： 那么如果我们需要对这个建立索引的过程做更多的控...","head":[["meta",{"property":"og:url","content":"https://springg.us.kg/posts/Database/ES/elasticsearch-x-index-mapping.html"}],["meta",{"property":"og:site_name","content":"mrjason’s Blog"}],["meta",{"property":"og:title","content":"ES详解 - 索引：索引管理详解"}],["meta",{"property":"og:description","content":"ES详解 - 索引：索引管理详解 了解基本使用后，我们从索引操作的角度看看如何对索引进行管理。 1. 索引管理的引入 我们在前文中增加文档时，如下的语句会动态创建一个customer的index： 而这个index实际上已经自动创建了它里面的字段（name）的类型。我们不妨看下它自动创建的mapping： 那么如果我们需要对这个建立索引的过程做更多的控..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202403121430469.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-10-21T07:03:09.000Z"}],["meta",{"property":"article:author","content":"MrJason"}],["meta",{"property":"article:modified_time","content":"2024-10-21T07:03:09.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"ES详解 - 索引：索引管理详解\\",\\"image\\":[\\"https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202403121430469.png\\",\\"https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202403121430505.png\\",\\"https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202403121430541.png\\",\\"https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202403121430577.png\\",\\"https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202403121430605.png\\",\\"https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202403121430628.png\\",\\"https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202403121430661.png\\",\\"https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202403121430691.png\\",\\"https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202403121430719.png\\",\\"https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202403121430747.png\\",\\"https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202403121430776.png\\",\\"https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202403121430798.png\\",\\"https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202403121430826.png\\"],\\"dateModified\\":\\"2024-10-21T07:03:09.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"MrJason\\",\\"url\\":\\"https://springg.us.kg\\"}]}"]]},"headers":[{"level":2,"title":"1. 索引管理的引入","slug":"_1-索引管理的引入","link":"#_1-索引管理的引入","children":[]},{"level":2,"title":"2. 索引的格式","slug":"_2-索引的格式","link":"#_2-索引的格式","children":[]},{"level":2,"title":"3. 索引管理操作","slug":"_3-索引管理操作","link":"#_3-索引管理操作","children":[{"level":3,"title":"3.1 创建索引","slug":"_3-1-创建索引","link":"#_3-1-创建索引","children":[]},{"level":3,"title":"3.2 修改索引","slug":"_3-2-修改索引","link":"#_3-2-修改索引","children":[]},{"level":3,"title":"3.3 打开/关闭索引","slug":"_3-3-打开-关闭索引","link":"#_3-3-打开-关闭索引","children":[]},{"level":3,"title":"3.4 删除索引","slug":"_3-4-删除索引","link":"#_3-4-删除索引","children":[]},{"level":3,"title":"3.5 查看索引","slug":"_3-5-查看索引","link":"#_3-5-查看索引","children":[]}]},{"level":2,"title":"4. Kibana管理索引","slug":"_4-kibana管理索引","link":"#_4-kibana管理索引","children":[]},{"level":2,"title":"参考文章","slug":"参考文章","link":"#参考文章","children":[]}],"git":{"createdTime":1729494189000,"updatedTime":1729494189000,"contributors":[{"name":"MrJason","email":"845886914@qq.com","commits":1}]},"readingTime":{"minutes":3.06,"words":919},"filePathRelative":"posts/Database/ES/elasticsearch-x-index-mapping.md","localizedDate":"2024年10月21日","excerpt":"\\n<blockquote>\\n<p>了解基本使用后，我们从索引操作的角度看看如何对索引进行管理。</p>\\n</blockquote>\\n<h2>1. 索引管理的引入</h2>\\n<p>我们在前文中增加文档时，如下的语句会动态创建一个customer的index：</p>\\n<div class=\\"language-bash\\" data-ext=\\"bash\\" data-title=\\"bash\\"><pre class=\\"shiki shiki-themes one-dark-pro one-dark-pro vp-code\\" style=\\"background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf\\" tabindex=\\"0\\"><code><span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">PUT</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> /customer/_doc/1</span></span>\\n<span class=\\"line\\"><span style=\\"color:#ABB2BF;--shiki-dark:#ABB2BF\\">{</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">  \\"name\\"</span><span style=\\"color:#56B6C2;--shiki-dark:#56B6C2\\">:</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> \\"John Doe\\"</span></span>\\n<span class=\\"line\\"><span style=\\"color:#ABB2BF;--shiki-dark:#ABB2BF\\">}</span></span></code></pre>\\n</div>","autoDesc":true}');export{t as comp,c as data};
