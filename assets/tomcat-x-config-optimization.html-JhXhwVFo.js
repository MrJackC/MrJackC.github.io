import{_ as s,c as t,a as o,o as n}from"./app-BfIe-EZg.js";const i={};function e(r,a){return n(),t("div",null,a[0]||(a[0]=[o(`<h1 id="tomcat优化一-优化自身的配置" tabindex="-1"><a class="header-anchor" href="#tomcat优化一-优化自身的配置"><span>Tomcat优化一：优化自身的配置</span></a></h1><h2 id="_1-简介" tabindex="-1"><a class="header-anchor" href="#_1-简介"><span>1. 简介</span></a></h2><p>Tomcat服务器在JavaEE项目中使用率非常高，所以在生产环境对Tomcat的优化也变得非常重要了。</p><p>对于Tomcat的优化，主要是从2个方面入手，一是<strong>Tomcat自身的配置</strong>，另一个是<strong>Tomcat所运行的jvm虚拟机的调优</strong>。</p><h2 id="_2-前置配置-登录系统-配置tomcat用户" tabindex="-1"><a class="header-anchor" href="#_2-前置配置-登录系统-配置tomcat用户"><span>2. 前置配置：登录系统，配置tomcat用户</span></a></h2><p>如果不配置tomcat用户，那么查看tomcat状态时，将会出现403错误</p><figure><img src="https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202404231152779.png" alt="image-20210728220240999" tabindex="0" loading="lazy"><figcaption>image-20210728220240999</figcaption></figure><figure><img src="https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202404231152827.png" alt="image-20210728220259132" tabindex="0" loading="lazy"><figcaption>image-20210728220259132</figcaption></figure><p>如果需要登录系统，必须配置tomcat用户，在安装完Tomcat后，进行如下操作</p><p>在<code>/conf/tomcat-users.xml</code>文件中的<code>&lt;tomcat-users&gt;</code>标签里面添加如下内容</p><div class="language-sh" data-ext="sh" data-title="sh"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;!</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">--</span><span style="color:#98C379;--shiki-dark:#98C379;"> 修改配置文件，配置tomcat的管理用户</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;role </span><span style="color:#E06C75;--shiki-dark:#E06C75;">rolename</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;manager&quot;/</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;role </span><span style="color:#E06C75;--shiki-dark:#E06C75;">rolename</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;manager-gui&quot;/</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;role </span><span style="color:#E06C75;--shiki-dark:#E06C75;">rolename</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;admin&quot;/</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;role </span><span style="color:#E06C75;--shiki-dark:#E06C75;">rolename</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;admin-gui&quot;/</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;user </span><span style="color:#E06C75;--shiki-dark:#E06C75;">username</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;tomcat&quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> password</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;tomcat&quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> roles</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;admin-gui,admin,manager-gui,manager&quot;/</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre></div><p>如果是tomcat7，配置了tomcat用户就可以登录系统了，但是tomcat8中不行，还需要修改另一个配置文件，否则访问不了，提示403，打开<code>webapps/manager/META-INF/context.xml</code>文件</p><div class="language-sh" data-ext="sh" data-title="sh"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;!</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">--</span><span style="color:#98C379;--shiki-dark:#98C379;"> 将Valve标签的内容注释掉，保存退出即可</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;?xml </span><span style="color:#E06C75;--shiki-dark:#E06C75;">version</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;1.0&quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> encoding</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;UTF-8&quot;?</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;Context </span><span style="color:#E06C75;--shiki-dark:#E06C75;">antiResourceLocking</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;false&quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> privileged</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;true&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &gt;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  &lt;!</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">--</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;Valve </span><span style="color:#98C379;--shiki-dark:#98C379;">className=&quot;org.apache.catalina.valves.RemoteAddrValve&quot;</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">         allow</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;127\\.\\d+\\.\\d+\\.\\d+|::1|0:0:0:0:0:0:0:1&quot;</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> /</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span><span style="color:#98C379;--shiki-dark:#98C379;">--</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  &lt;</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Manager</span><span style="color:#98C379;--shiki-dark:#98C379;"> sessionAttributeValueClassNameFilter=&quot;java\\.lang\\.(?:Boolean|Integer|Long|Number|String)|org\\.apache\\.catalina\\.filters\\.CsrfPreventionFilter</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\$</span><span style="color:#98C379;--shiki-dark:#98C379;">LruCache(?:</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\$</span><span style="color:#98C379;--shiki-dark:#98C379;">1)?|java\\.util\\.(?:Linked)?HashMap&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">/&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;/Context&gt;</span></span></code></pre></div><p>再次点击的时候，就需要输入账户密码了：tomcat/tomcat</p><figure><img src="https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202404231152851.png" alt="image-20210728220849612" tabindex="0" loading="lazy"><figcaption>image-20210728220849612</figcaption></figure><p>登录之后可以看到服务器状态等信息，主要包括服务器信息，JVM，ajp和http信息</p><figure><img src="https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202404231152874.png" alt="image-20210728220924142" tabindex="0" loading="lazy"><figcaption>image-20210728220924142</figcaption></figure><h2 id="_3-优化1-ajp连接" tabindex="-1"><a class="header-anchor" href="#_3-优化1-ajp连接"><span>3. 优化1：AJP连接</span></a></h2><blockquote><p>新版tomcat8，已自动禁止</p></blockquote><p>在服务状态页面中可以看到，默认状态下会启用AJP服务，并且占用8009端口。</p><figure><img src="https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202404231152897.png" alt="image-20210728221223607" tabindex="0" loading="lazy"><figcaption>image-20210728221223607</figcaption></figure><h3 id="_3-1-什么是ajp" tabindex="-1"><a class="header-anchor" href="#_3-1-什么是ajp"><span>3.1 什么是AJP</span></a></h3><p>AJP（Apache JServer Protocol）<br> AJPv13协议是面向包的。WEB服务器和Servlet容器通过TCP连接来交互；为了节省SOCKET创建的昂贵代价，WEB服务器会尝试维护一个永久TCP连接到servlet容器，并且在多个请求和响应周期过程会重用连接。<br><img src="https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202404231152920.png" alt="image-20210728221317207" loading="lazy"></p><p>我们一般是使用Nginx+Tomcat的架构，所以用不着AJP协议，把AJP连接器禁用。</p><p>修改conf下的server.xml文件，将AJP服务禁用掉即可。</p><div class="language-sh" data-ext="sh" data-title="sh"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;!</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">--</span><span style="color:#98C379;--shiki-dark:#98C379;"> 禁用AJP连接</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;!</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">--</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &lt;</span><span style="color:#98C379;--shiki-dark:#98C379;">Connector</span><span style="color:#98C379;--shiki-dark:#98C379;"> port=&quot;8009&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> protocol=&quot;AJP/1.3&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> redirectPort=&quot;8443&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> /&gt; </span><span style="color:#D19A66;--shiki-dark:#D19A66;">--</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre></div><p>重启tomcat，查看效果。可以看到AJP服务已经不存在了。</p><figure><img src="https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202404231152948.png" alt="image-20210728221415136" tabindex="0" loading="lazy"><figcaption>image-20210728221415136</figcaption></figure><h2 id="_4-优化2-执行器-线程池" tabindex="-1"><a class="header-anchor" href="#_4-优化2-执行器-线程池"><span>4. 优化2：执行器（线程池）</span></a></h2><p>在tomcat中每一个用户请求都是一个线程，所以可以使用线程池提高性能。</p><p>修改server.xml文件：</p><div class="language-sh line-numbers-mode" data-ext="sh" data-title="sh"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;!</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">--将注释打开--</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;Executor </span><span style="color:#E06C75;--shiki-dark:#E06C75;">name</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;tomcatThreadPool&quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> namePrefix</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;catalina-exec-&quot;</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        maxThreads</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;500&quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> minSpareThreads</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;50&quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> prestartminSpareThreads</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;true&quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> maxQueueSize</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;100&quot;/</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;!</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">--</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">参数说明：</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">maxThreads：最大并发数，默认设置</span><span style="color:#98C379;--shiki-dark:#98C379;"> 200，一般建议在</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 500</span><span style="color:#98C379;--shiki-dark:#98C379;"> ~</span><span style="color:#98C379;--shiki-dark:#98C379;"> 1000，根据硬件设施和业务来判断</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">minSpareThreads：Tomcat</span><span style="color:#98C379;--shiki-dark:#98C379;"> 初始化时创建的线程数，默认设置</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 25</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">prestartminSpareThreads：</span><span style="color:#98C379;--shiki-dark:#98C379;"> 在</span><span style="color:#98C379;--shiki-dark:#98C379;"> Tomcat</span><span style="color:#98C379;--shiki-dark:#98C379;"> 初始化的时候就初始化</span><span style="color:#98C379;--shiki-dark:#98C379;"> minSpareThreads</span><span style="color:#98C379;--shiki-dark:#98C379;"> 的参数值，如果不等于</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> true</span><span style="color:#98C379;--shiki-dark:#98C379;">，minSpareThreads</span><span style="color:#98C379;--shiki-dark:#98C379;"> 的值就没啥效果了</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">maxQueueSize，最大的等待队列数，超过则拒绝请求</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">--</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;!</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">--在Connector中设置executor属性指向上面的执行器--</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;Connector </span><span style="color:#E06C75;--shiki-dark:#E06C75;">executor</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;tomcatThreadPool&quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> port</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;8080&quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> protocol</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;HTTP/1.1&quot;</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">               connectionTimeout</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;20000&quot;</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">               redirectPort</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;8443&quot;</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> /</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>保存退出，重启tomcat，查看效果。</p><figure><img src="https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202404231152973.png" alt="image-20210728222804439" tabindex="0" loading="lazy"><figcaption>image-20210728222804439</figcaption></figure><p>在页面中显示最大线程数为-1，这个是正常的，仅仅是显示的问题，实际使用的是指定的值。如果配置了一个Executor，则该属性的任何值将被正确记录，但是它将被显示为-1</p><h2 id="_5-优化3-3种运行模式" tabindex="-1"><a class="header-anchor" href="#_5-优化3-3种运行模式"><span>5. 优化3：3种运行模式</span></a></h2><p>tomcat的运行模式有3种：</p><ul><li><p>bio<br> 性能非常低下，没有经过任何优化处理和支持</p></li><li><p>nio<br> nio(new I/O)，是Java SE 1.4及后续版本提供的一种新的I/O操作方式(即java.nio包及其子包)。Java nio是一个基于缓冲区、并能提供非阻塞I/O操作的Java API，因此nio也被看成是non-blocking I/O的缩写。它拥有比传统I/O操作(bio)更好的并发运行性能。Tomcat8默认使用nio运行模式。</p></li><li><p>apr<br> 安装起来最困难，但是从操作系统级别来解决异步的IO问题，大幅度的提高性能</p></li></ul><p>对于每种协议，Tomcat都提供了对应的I/O方式的实现，而且Tomcat官方还提供了在每种协议下每种I/O实现方案的差异， HTTP协议下的处理方式如下表，详情可查看Tomcat官网说明</p><table><thead><tr><th></th><th>BIO</th><th>NIO</th><th>NIO2</th><th>APR</th></tr></thead><tbody><tr><td>类名</td><td><code>Http11Protocol</code></td><td><code>Http11NioProtocol</code></td><td><code>Http11Nio2Protocol</code></td><td><code>Http11AprProtocol</code></td></tr><tr><td>引用版本</td><td>≥3.0</td><td>≥6.0</td><td>≥8.0</td><td>≥5.5</td></tr><tr><td>轮询支持</td><td>否</td><td>是</td><td>是</td><td>是</td></tr><tr><td>轮询队列大小</td><td>N/A</td><td><code>maxConnections</code></td><td><code>maxConnections</code></td><td><code>maxConnections</code></td></tr><tr><td>读请求头</td><td>阻塞</td><td>非阻塞</td><td>非阻塞</td><td>阻塞</td></tr><tr><td>读请求体</td><td>阻塞</td><td>阻塞</td><td>阻塞</td><td>阻塞</td></tr><tr><td>写响应</td><td>阻塞</td><td>阻塞</td><td>阻塞</td><td></td></tr><tr><td>等待新请求</td><td>阻塞</td><td>非阻塞</td><td>非阻塞</td><td>非阻塞</td></tr><tr><td>SSL支持</td><td>Java SSL</td><td>Java SSL</td><td>Java SSL</td><td>Open SSL</td></tr><tr><td>SSL握手</td><td>阻塞</td><td>非阻塞</td><td>非阻塞</td><td>阻塞</td></tr><tr><td>最大链接数</td><td><code>maxConnections</code></td><td><code>maxConnections</code></td><td><code>maxConnections</code></td><td><code>maxConnections</code></td></tr></tbody></table><p>推荐使用nio，在tomcat8中有最新的nio2，速度更快，建议使用nio2</p><p>设置nio2：</p><div class="language-sh" data-ext="sh" data-title="sh"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;Connector </span><span style="color:#E06C75;--shiki-dark:#E06C75;">executor</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;tomcatThreadPool&quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">  port</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;8080&quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> protocol</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;org.apache.coyote.http11.Http11Nio2Protocol&quot;</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">               connectionTimeout</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;20000&quot;</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">               redirectPort</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;8443&quot;</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> /</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre></div><figure><img src="https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202404231152993.png" alt="image-20210728223416722" tabindex="0" loading="lazy"><figcaption>image-20210728223416722</figcaption></figure><p>可以看到已经设置为nio2了。</p><h2 id="参考文章" tabindex="-1"><a class="header-anchor" href="#参考文章"><span>参考文章</span></a></h2><p><a href="https://blog.csdn.net/ThinkWon/article/details/102744033" target="_blank" rel="noopener noreferrer">史上最强Tomcat8性能优化</a></p>`,47)]))}const p=s(i,[["render",e],["__file","tomcat-x-config-optimization.html.vue"]]),c=JSON.parse('{"path":"/posts/MiddleWare/Tomcat/tomcat-x-config-optimization.html","title":"Tomcat优化一：优化自身的配置","lang":"zh-CN","frontmatter":{"aliases":"Tomcat优化一：优化自身的配置","tags":null,"cssclass":null,"source":null,"created":"2024-02-22 10:51","updated":"2024-04-23 11:55","description":"Tomcat优化一：优化自身的配置 1. 简介 Tomcat服务器在JavaEE项目中使用率非常高，所以在生产环境对Tomcat的优化也变得非常重要了。 对于Tomcat的优化，主要是从2个方面入手，一是Tomcat自身的配置，另一个是Tomcat所运行的jvm虚拟机的调优。 2. 前置配置：登录系统，配置tomcat用户 如果不配置tomcat用户，...","watermark":true,"head":[["meta",{"property":"og:url","content":"https://springg.us.kg/posts/MiddleWare/Tomcat/tomcat-x-config-optimization.html"}],["meta",{"property":"og:site_name","content":"mrjason’s Blog"}],["meta",{"property":"og:title","content":"Tomcat优化一：优化自身的配置"}],["meta",{"property":"og:description","content":"Tomcat优化一：优化自身的配置 1. 简介 Tomcat服务器在JavaEE项目中使用率非常高，所以在生产环境对Tomcat的优化也变得非常重要了。 对于Tomcat的优化，主要是从2个方面入手，一是Tomcat自身的配置，另一个是Tomcat所运行的jvm虚拟机的调优。 2. 前置配置：登录系统，配置tomcat用户 如果不配置tomcat用户，..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202404231152779.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-10-28T01:58:08.000Z"}],["meta",{"property":"article:author","content":"MrJason"}],["meta",{"property":"article:modified_time","content":"2024-10-28T01:58:08.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Tomcat优化一：优化自身的配置\\",\\"image\\":[\\"https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202404231152779.png\\",\\"https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202404231152827.png\\",\\"https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202404231152851.png\\",\\"https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202404231152874.png\\",\\"https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202404231152897.png\\",\\"https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202404231152920.png\\",\\"https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202404231152948.png\\",\\"https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202404231152973.png\\",\\"https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202404231152993.png\\"],\\"dateModified\\":\\"2024-10-28T01:58:08.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"MrJason\\",\\"url\\":\\"https://springg.us.kg\\"}]}"]]},"headers":[{"level":2,"title":"1. 简介","slug":"_1-简介","link":"#_1-简介","children":[]},{"level":2,"title":"2. 前置配置：登录系统，配置tomcat用户","slug":"_2-前置配置-登录系统-配置tomcat用户","link":"#_2-前置配置-登录系统-配置tomcat用户","children":[]},{"level":2,"title":"3. 优化1：AJP连接","slug":"_3-优化1-ajp连接","link":"#_3-优化1-ajp连接","children":[{"level":3,"title":"3.1 什么是AJP","slug":"_3-1-什么是ajp","link":"#_3-1-什么是ajp","children":[]}]},{"level":2,"title":"4. 优化2：执行器（线程池）","slug":"_4-优化2-执行器-线程池","link":"#_4-优化2-执行器-线程池","children":[]},{"level":2,"title":"5. 优化3：3种运行模式","slug":"_5-优化3-3种运行模式","link":"#_5-优化3-3种运行模式","children":[]},{"level":2,"title":"参考文章","slug":"参考文章","link":"#参考文章","children":[]}],"git":{"createdTime":1730080688000,"updatedTime":1730080688000,"contributors":[{"name":"MrJason","email":"845886914@qq.com","commits":1}]},"readingTime":{"minutes":4.52,"words":1355},"filePathRelative":"posts/MiddleWare/Tomcat/tomcat-x-config-optimization.md","localizedDate":"2024年10月28日","excerpt":"\\n<h2>1. 简介</h2>\\n<p>Tomcat服务器在JavaEE项目中使用率非常高，所以在生产环境对Tomcat的优化也变得非常重要了。</p>\\n<p>对于Tomcat的优化，主要是从2个方面入手，一是<strong>Tomcat自身的配置</strong>，另一个是<strong>Tomcat所运行的jvm虚拟机的调优</strong>。</p>\\n<h2>2. 前置配置：登录系统，配置tomcat用户</h2>\\n<p>如果不配置tomcat用户，那么查看tomcat状态时，将会出现403错误</p>\\n<figure><img src=\\"https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202404231152779.png\\" alt=\\"image-20210728220240999\\" tabindex=\\"0\\" loading=\\"lazy\\"><figcaption>image-20210728220240999</figcaption></figure>","autoDesc":true}');export{p as comp,c as data};
