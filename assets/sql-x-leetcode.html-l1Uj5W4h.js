import{_ as a,c as n,a as l,o as i}from"./app-BhoNqsD-.js";const p={};function B(r,s){return i(),n("div",null,s[0]||(s[0]=[l(`<h1 id="leetcode中sql题目" tabindex="-1"><a class="header-anchor" href="#leetcode中sql题目"><span>Leetcode中SQL题目</span></a></h1><h3 id="_595-big-countries" tabindex="-1"><a class="header-anchor" href="#_595-big-countries"><span>595. Big Countries</span></a></h3><p><a href="https://leetcode.com/problems/big-countries/description/" target="_blank" rel="noopener noreferrer">https://leetcode.com/problems/big-countries/description/</a></p><h4 id="description" tabindex="-1"><a class="header-anchor" href="#description"><span>Description</span></a></h4><div class="language-html" data-ext="html" data-title="html"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+-----------------+------------+------------+--------------+---------------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| name            | continent  | area       | population   | gdp           |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+-----------------+------------+------------+--------------+---------------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| Afghanistan     | Asia       | 652230     | 25500100     | 20343000      |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| Albania         | Europe     | 28748      | 2831741      | 12960000      |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| Algeria         | Africa     | 2381741    | 37100000     | 188681000     |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| Andorra         | Europe     | 468        | 78115        | 3712000       |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| Angola          | Africa     | 1246700    | 20609294     | 100990000     |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+-----------------+------------+------------+--------------+---------------+</span></span></code></pre></div><p>查找面积超过 3,000,000 或者人口数超过 25,000,000 的国家。</p><div class="language-html" data-ext="html" data-title="html"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+--------------+-------------+--------------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| name         | population  | area         |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+--------------+-------------+--------------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| Afghanistan  | 25500100    | 652230       |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| Algeria      | 37100000    | 2381741      |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+--------------+-------------+--------------+</span></span></code></pre></div><h4 id="sql-schema" tabindex="-1"><a class="header-anchor" href="#sql-schema"><span>SQL Schema</span></a></h4><div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">DROP</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> TABLE</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">IF</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    EXISTS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> World;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> TABLE</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> World</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( </span><span style="color:#C678DD;--shiki-dark:#C678DD;">NAME</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> VARCHAR</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">255</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ), continent </span><span style="color:#C678DD;--shiki-dark:#C678DD;">VARCHAR</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">255</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ), area </span><span style="color:#C678DD;--shiki-dark:#C678DD;">INT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#C678DD;--shiki-dark:#C678DD;">population</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> INT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, gdp </span><span style="color:#C678DD;--shiki-dark:#C678DD;">INT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> );</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">INSERT INTO</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> World ( </span><span style="color:#C678DD;--shiki-dark:#C678DD;">NAME</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, continent, area, </span><span style="color:#C678DD;--shiki-dark:#C678DD;">population</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, gdp )</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">VALUES</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;Afghanistan&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;Asia&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;652230&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;25500100&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;203430000&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;Albania&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;Europe&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;28748&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2831741&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;129600000&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;Algeria&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;Africa&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2381741&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;37100000&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;1886810000&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;Andorra&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;Europe&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;468&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;78115&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;37120000&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;Angola&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;Africa&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;1246700&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;20609294&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;1009900000&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> );</span></span></code></pre></div><h4 id="solution" tabindex="-1"><a class="header-anchor" href="#solution"><span>Solution</span></a></h4><div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">SELECT</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> name</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    population</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    area</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">FROM</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    World</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">WHERE</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    area </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">&gt;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 3000000</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    OR</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> population</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> &gt;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 25000000</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span></code></pre></div><h3 id="_627-swap-salary" tabindex="-1"><a class="header-anchor" href="#_627-swap-salary"><span>627. *Swap Salary</span></a></h3><p><a href="https://leetcode.com/problems/swap-salary/description/" target="_blank" rel="noopener noreferrer">https://leetcode.com/problems/swap-salary/description/</a></p><h4 id="description-1" tabindex="-1"><a class="header-anchor" href="#description-1"><span>Description</span></a></h4><div class="language-html" data-ext="html" data-title="html"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| id | name | sex | salary |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|----|------|-----|--------|</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 1  | A    | m   | 2500   |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 2  | B    | f   | 1500   |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 3  | C    | m   | 5500   |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 4  | D    | f   | 500    |</span></span></code></pre></div><p>只用一个 SQL 查询，将 sex 字段反转。</p><div class="language-html" data-ext="html" data-title="html"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| id | name | sex | salary |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|----|------|-----|--------|</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 1  | A    | f   | 2500   |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 2  | B    | m   | 1500   |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 3  | C    | f   | 5500   |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 4  | D    | m   | 500    |</span></span></code></pre></div><h4 id="sql-schema-1" tabindex="-1"><a class="header-anchor" href="#sql-schema-1"><span>SQL Schema</span></a></h4><div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">DROP</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> TABLE</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">IF</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    EXISTS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> salary;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> TABLE</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> salary</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( id </span><span style="color:#C678DD;--shiki-dark:#C678DD;">INT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#C678DD;--shiki-dark:#C678DD;">NAME</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> VARCHAR</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">100</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ), sex </span><span style="color:#C678DD;--shiki-dark:#C678DD;">CHAR</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ), salary </span><span style="color:#C678DD;--shiki-dark:#C678DD;">INT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> );</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">INSERT INTO</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> salary ( id, </span><span style="color:#C678DD;--shiki-dark:#C678DD;">NAME</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, sex, salary )</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">VALUES</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;1&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;A&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;m&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2500&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;B&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;f&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;1500&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;3&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;C&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;m&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;5500&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;4&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;D&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;f&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;500&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> );</span></span></code></pre></div><h4 id="solution-1" tabindex="-1"><a class="header-anchor" href="#solution-1"><span>Solution</span></a></h4><blockquote><p>第一遍没做出来，异或方案应该想不到，但case when 要想到才对</p></blockquote><h5 id="方案一-异或" tabindex="-1"><a class="header-anchor" href="#方案一-异或"><span>方案一：异或</span></a></h5><div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">UPDATE</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> salary</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">SET</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> sex </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> CHAR</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">ASCII</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(sex) ^ </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">ASCII</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">( </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;m&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ) ^ </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">ASCII</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">( </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;f&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ) );</span></span></code></pre></div><h5 id="方案二-使用条件语句" tabindex="-1"><a class="header-anchor" href="#方案二-使用条件语句"><span>方案二：使用条件语句：</span></a></h5><div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">UPDATE</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> salary</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    SET</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> sex  </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="color:#C678DD;--shiki-dark:#C678DD;">CASE</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> WHEN</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> sex </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;m&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">                THEN</span><span style="color:#98C379;--shiki-dark:#98C379;">  &#39;f&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">                ELSE</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;m&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">                END</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span></code></pre></div><p>或者</p><div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">UPDATE</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> salary </span><span style="color:#C678DD;--shiki-dark:#C678DD;">SET</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> sex </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> IF</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(sex </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;m&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;f&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;m&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span></code></pre></div><h3 id="_620-not-boring-movies" tabindex="-1"><a class="header-anchor" href="#_620-not-boring-movies"><span>620. Not Boring Movies</span></a></h3><p><a href="https://leetcode.com/problems/not-boring-movies/description/" target="_blank" rel="noopener noreferrer">https://leetcode.com/problems/not-boring-movies/description/</a></p><h4 id="description-2" tabindex="-1"><a class="header-anchor" href="#description-2"><span>Description</span></a></h4><div class="language-html" data-ext="html" data-title="html"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+---------+-----------+--------------+-----------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|   id    | movie     |  description |  rating   |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+---------+-----------+--------------+-----------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|   1     | War       |   great 3D   |   8.9     |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|   2     | Science   |   fiction    |   8.5     |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|   3     | irish     |   boring     |   6.2     |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|   4     | Ice song  |   Fantacy    |   8.6     |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|   5     | House card|   Interesting|   9.1     |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+---------+-----------+--------------+-----------+</span></span></code></pre></div><p>查找 id 为奇数，并且 description 不是 boring 的电影，按 rating 降序。</p><div class="language-html" data-ext="html" data-title="html"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+---------+-----------+--------------+-----------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|   id    | movie     |  description |  rating   |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+---------+-----------+--------------+-----------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|   5     | House card|   Interesting|   9.1     |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|   1     | War       |   great 3D   |   8.9     |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+---------+-----------+--------------+-----------+</span></span></code></pre></div><h4 id="sql-schema-2" tabindex="-1"><a class="header-anchor" href="#sql-schema-2"><span>SQL Schema</span></a></h4><div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">DROP</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> TABLE</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">IF</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    EXISTS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> cinema;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> TABLE</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> cinema</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( id </span><span style="color:#C678DD;--shiki-dark:#C678DD;">INT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, movie </span><span style="color:#C678DD;--shiki-dark:#C678DD;">VARCHAR</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">255</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ), </span><span style="color:#C678DD;--shiki-dark:#C678DD;">description</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> VARCHAR</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">255</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ), rating </span><span style="color:#C678DD;--shiki-dark:#C678DD;">FLOAT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ) );</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">INSERT INTO</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> cinema ( id, movie, </span><span style="color:#C678DD;--shiki-dark:#C678DD;">description</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, rating )</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">VALUES</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;War&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;great 3D&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">8</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">9</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;Science&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;fiction&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">8</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">5</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;irish&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;boring&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">6</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">4</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;Ice song&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;Fantacy&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">8</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">6</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">5</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;House card&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;Interesting&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">9</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> );</span></span></code></pre></div><h4 id="solution-2" tabindex="-1"><a class="header-anchor" href="#solution-2"><span>Solution</span></a></h4><div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">SELECT</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    *</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">FROM</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    cinema</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">WHERE</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    id % </span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    AND</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> description</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> !=</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;boring&#39;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">ORDER BY</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    rating </span><span style="color:#C678DD;--shiki-dark:#C678DD;">DESC</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span></code></pre></div><h3 id="_596-classes-more-than-5-students" tabindex="-1"><a class="header-anchor" href="#_596-classes-more-than-5-students"><span>596. Classes More Than 5 Students</span></a></h3><p><a href="https://leetcode.com/problems/classes-more-than-5-students/description/" target="_blank" rel="noopener noreferrer">https://leetcode.com/problems/classes-more-than-5-students/description/</a></p><h4 id="description-3" tabindex="-1"><a class="header-anchor" href="#description-3"><span>Description</span></a></h4><div class="language-html" data-ext="html" data-title="html"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+---------+------------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| student | class      |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+---------+------------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| A       | Math       |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| B       | English    |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| C       | Math       |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| D       | Biology    |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| E       | Math       |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| F       | Computer   |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| G       | Math       |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| H       | Math       |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| I       | Math       |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+---------+------------+</span></span></code></pre></div><p>查找有五名及以上 student 的 class。</p><div class="language-html" data-ext="html" data-title="html"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+---------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| class   |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+---------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| Math    |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+---------+</span></span></code></pre></div><h4 id="sql-schema-3" tabindex="-1"><a class="header-anchor" href="#sql-schema-3"><span>SQL Schema</span></a></h4><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">DROP</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> TABLE</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">IF</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    EXISTS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> courses;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> TABLE</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> courses</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( student </span><span style="color:#C678DD;--shiki-dark:#C678DD;">VARCHAR</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">255</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ), class </span><span style="color:#C678DD;--shiki-dark:#C678DD;">VARCHAR</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">255</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ) );</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">INSERT INTO</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> courses ( student, class )</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">VALUES</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;A&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;Math&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;B&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;English&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;C&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;Math&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;D&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;Biology&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;E&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;Math&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;F&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;Computer&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;G&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;Math&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;H&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;Math&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;I&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;Math&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> );</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="solution-3" tabindex="-1"><a class="header-anchor" href="#solution-3"><span>Solution</span></a></h4><div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">SELECT</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    class</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">FROM</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    courses</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">GROUP BY</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    class</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">HAVING</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    count</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">( </span><span style="color:#C678DD;--shiki-dark:#C678DD;">DISTINCT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> student ) </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">&gt;=</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 5</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span></code></pre></div><h3 id="_182-duplicate-emails" tabindex="-1"><a class="header-anchor" href="#_182-duplicate-emails"><span>182. Duplicate Emails</span></a></h3><p><a href="https://leetcode.com/problems/duplicate-emails/description/" target="_blank" rel="noopener noreferrer">https://leetcode.com/problems/duplicate-emails/description/</a></p><h4 id="description-4" tabindex="-1"><a class="header-anchor" href="#description-4"><span>Description</span></a></h4><p>邮件地址表:</p><div class="language-html" data-ext="html" data-title="html"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+----+---------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| Id | Email   |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+----+---------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 1  | a@b.com |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 2  | c@d.com |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 3  | a@b.com |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+----+---------+</span></span></code></pre></div><p>查找重复的邮件地址:</p><div class="language-html" data-ext="html" data-title="html"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+---------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| Email   |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+---------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| a@b.com |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+---------+</span></span></code></pre></div><h4 id="sql-schema-4" tabindex="-1"><a class="header-anchor" href="#sql-schema-4"><span>SQL Schema</span></a></h4><div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">DROP</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> TABLE</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">IF</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    EXISTS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> Person;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> TABLE</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> Person</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( Id </span><span style="color:#C678DD;--shiki-dark:#C678DD;">INT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, Email </span><span style="color:#C678DD;--shiki-dark:#C678DD;">VARCHAR</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">255</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ) );</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">INSERT INTO</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> Person ( Id, Email )</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">VALUES</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;a@b.com&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;c@d.com&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;a@b.com&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> );</span></span></code></pre></div><h4 id="solution-4" tabindex="-1"><a class="header-anchor" href="#solution-4"><span>Solution</span></a></h4><div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">SELECT</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    Email</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">FROM</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    Person</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">GROUP BY</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    Email</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">HAVING</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    COUNT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">( * ) </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">&gt;=</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span></code></pre></div><h3 id="_196-delete-duplicate-emails" tabindex="-1"><a class="header-anchor" href="#_196-delete-duplicate-emails"><span>196. *Delete Duplicate Emails</span></a></h3><p><a href="https://leetcode.com/problems/delete-duplicate-emails/description/" target="_blank" rel="noopener noreferrer">https://leetcode.com/problems/delete-duplicate-emails/description/</a></p><h4 id="description-5" tabindex="-1"><a class="header-anchor" href="#description-5"><span>Description</span></a></h4><p>邮件地址表:</p><div class="language-html" data-ext="html" data-title="html"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+----+---------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| Id | Email   |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+----+---------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 1  | a@b.com |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 2  | c@d.com |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 3  | a@b.com |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+----+---------+</span></span></code></pre></div><p>删除重复的邮件地址:</p><div class="language-html" data-ext="html" data-title="html"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+----+------------------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| Id | Email            |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+----+------------------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 1  | john@example.com |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 2  | bob@example.com  |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+----+------------------+</span></span></code></pre></div><h4 id="sql-schema-5" tabindex="-1"><a class="header-anchor" href="#sql-schema-5"><span>SQL Schema</span></a></h4><p>与 182 相同。</p><h4 id="solution-5" tabindex="-1"><a class="header-anchor" href="#solution-5"><span>Solution</span></a></h4><blockquote><p>接替思路被局限了，可以自关联</p></blockquote><p>连接:</p><div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">DELETE</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> p1</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">FROM</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    Person p1,</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    Person p2</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">WHERE</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;">    p1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">Email</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> p2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">Email</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    AND</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> p1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">Id</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> &gt;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> p2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">Id</span></span></code></pre></div><p>子查询:</p><div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">DELETE</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">FROM</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    Person</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">WHERE</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    id </span><span style="color:#C678DD;--shiki-dark:#C678DD;">NOT</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> IN</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( </span><span style="color:#C678DD;--shiki-dark:#C678DD;">SELECT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> id </span><span style="color:#C678DD;--shiki-dark:#C678DD;">FROM</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( </span><span style="color:#C678DD;--shiki-dark:#C678DD;">SELECT</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> min</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">( id ) </span><span style="color:#C678DD;--shiki-dark:#C678DD;">AS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> id </span><span style="color:#C678DD;--shiki-dark:#C678DD;">FROM</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> Person </span><span style="color:#C678DD;--shiki-dark:#C678DD;">GROUP BY</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> email ) </span><span style="color:#C678DD;--shiki-dark:#C678DD;">AS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> m );</span></span></code></pre></div><p>应该注意的是上述解法额外嵌套了一个 SELECT 语句，如果不这么做，会出现错误: You can&#39;t specify target table &#39;Person&#39; for update in FROM clause。以下演示了这种错误解法。</p><div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">DELETE</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">FROM</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    Person</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">WHERE</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    id </span><span style="color:#C678DD;--shiki-dark:#C678DD;">NOT</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> IN</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( </span><span style="color:#C678DD;--shiki-dark:#C678DD;">SELECT</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> min</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">( id ) </span><span style="color:#C678DD;--shiki-dark:#C678DD;">AS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> id </span><span style="color:#C678DD;--shiki-dark:#C678DD;">FROM</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> Person </span><span style="color:#C678DD;--shiki-dark:#C678DD;">GROUP BY</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> email );</span></span></code></pre></div><p>参考: <a href="https://stackoverflow.com/questions/45494/mysql-error-1093-cant-specify-target-table-for-update-in-from-clause" target="_blank" rel="noopener noreferrer">pMySQL Error 1093 - Can&#39;t specify target table for update in FROM clause (opens new window)</a></p><h3 id="_175-combine-two-tables" tabindex="-1"><a class="header-anchor" href="#_175-combine-two-tables"><span>175. Combine Two Tables</span></a></h3><p><a href="https://leetcode.com/problems/combine-two-tables/description/" target="_blank" rel="noopener noreferrer">https://leetcode.com/problems/combine-two-tables/description/</a></p><h4 id="description-6" tabindex="-1"><a class="header-anchor" href="#description-6"><span>Description</span></a></h4><p>Person 表:</p><div class="language-html" data-ext="html" data-title="html"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+-------------+---------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| Column Name | Type    |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+-------------+---------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| PersonId    | int     |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| FirstName   | varchar |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| LastName    | varchar |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+-------------+---------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">PersonId is the primary key column for this table.</span></span></code></pre></div><p>Address 表:</p><div class="language-html" data-ext="html" data-title="html"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+-------------+---------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| Column Name | Type    |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+-------------+---------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| AddressId   | int     |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| PersonId    | int     |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| City        | varchar |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| State       | varchar |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+-------------+---------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">AddressId is the primary key column for this table.</span></span></code></pre></div><p>查找 FirstName, LastName, City, State 数据，而不管一个用户有没有填地址信息。</p><h4 id="sql-schema-6" tabindex="-1"><a class="header-anchor" href="#sql-schema-6"><span>SQL Schema</span></a></h4><div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">DROP</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> TABLE</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">IF</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    EXISTS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> Person;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> TABLE</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> Person</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( PersonId </span><span style="color:#C678DD;--shiki-dark:#C678DD;">INT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, FirstName </span><span style="color:#C678DD;--shiki-dark:#C678DD;">VARCHAR</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">255</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ), LastName </span><span style="color:#C678DD;--shiki-dark:#C678DD;">VARCHAR</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">255</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ) );</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">DROP</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> TABLE</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">IF</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    EXISTS</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> Address</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> TABLE</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> Address</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( AddressId </span><span style="color:#C678DD;--shiki-dark:#C678DD;">INT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, PersonId </span><span style="color:#C678DD;--shiki-dark:#C678DD;">INT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, City </span><span style="color:#C678DD;--shiki-dark:#C678DD;">VARCHAR</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">255</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ), </span><span style="color:#C678DD;--shiki-dark:#C678DD;">State</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> VARCHAR</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">255</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ) );</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">INSERT INTO</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> Person ( PersonId, LastName, FirstName )</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">VALUES</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;Wang&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;Allen&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> );</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">INSERT INTO</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> Address</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( AddressId, PersonId, City, </span><span style="color:#C678DD;--shiki-dark:#C678DD;">State</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> )</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">VALUES</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;New York City&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;New York&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> );</span></span></code></pre></div><h4 id="solution-6" tabindex="-1"><a class="header-anchor" href="#solution-6"><span>Solution</span></a></h4><p>使用左外连接。</p><div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">SELECT</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    FirstName,</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    LastName,</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    City,</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    State</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">FROM</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    Person P</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    LEFT JOIN</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> Address</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> A</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    ON</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> P</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">PersonId</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> A</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">PersonId</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span></code></pre></div><h3 id="_181-employees-earning-more-than-their-managers" tabindex="-1"><a class="header-anchor" href="#_181-employees-earning-more-than-their-managers"><span>181. * Employees Earning More Than Their Managers</span></a></h3><p><a href="https://leetcode.com/problems/employees-earning-more-than-their-managers/description/" target="_blank" rel="noopener noreferrer">https://leetcode.com/problems/employees-earning-more-than-their-managers/description/</a></p><h4 id="description-7" tabindex="-1"><a class="header-anchor" href="#description-7"><span>Description</span></a></h4><p>Employee 表:</p><div class="language-html" data-ext="html" data-title="html"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+----+-------+--------+-----------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| Id | Name  | Salary | ManagerId |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+----+-------+--------+-----------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 1  | Joe   | 70000  | 3         |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 2  | Henry | 80000  | 4         |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 3  | Sam   | 60000  | NULL      |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 4  | Max   | 90000  | NULL      |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+----+-------+--------+-----------+</span></span></code></pre></div><p>查找薪资大于其经理薪资的员工信息。</p><h4 id="sql-schema-7" tabindex="-1"><a class="header-anchor" href="#sql-schema-7"><span>SQL Schema</span></a></h4><div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">DROP</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> TABLE</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">IF</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    EXISTS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> Employee;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> TABLE</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> Employee</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( Id </span><span style="color:#C678DD;--shiki-dark:#C678DD;">INT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#C678DD;--shiki-dark:#C678DD;">NAME</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> VARCHAR</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">255</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ), Salary </span><span style="color:#C678DD;--shiki-dark:#C678DD;">INT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, ManagerId </span><span style="color:#C678DD;--shiki-dark:#C678DD;">INT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> );</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">INSERT INTO</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> Employee ( Id, </span><span style="color:#C678DD;--shiki-dark:#C678DD;">NAME</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, Salary, ManagerId )</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">VALUES</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;Joe&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">70000</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;Henry&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">80000</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">4</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;Sam&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">60000</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#C678DD;--shiki-dark:#C678DD;">NULL</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">4</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;Max&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">90000</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#C678DD;--shiki-dark:#C678DD;">NULL</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> );</span></span></code></pre></div><h4 id="solution-7" tabindex="-1"><a class="header-anchor" href="#solution-7"><span>Solution</span></a></h4><blockquote><p>怎么过滤掉自己</p></blockquote><div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">SELECT</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;">    E1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">NAME</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> AS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> Employee</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">FROM</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    Employee E1</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    INNER JOIN</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> Employee E2</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    ON</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> E1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">ManagerId</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> E2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">Id</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    AND</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> E1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">Salary</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> &gt;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> E2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">Salary</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span></code></pre></div><h3 id="_183-customers-who-never-order" tabindex="-1"><a class="header-anchor" href="#_183-customers-who-never-order"><span>183. Customers Who Never Order</span></a></h3><p><a href="https://leetcode.com/problems/customers-who-never-order/description/" target="_blank" rel="noopener noreferrer">https://leetcode.com/problems/customers-who-never-order/description/</a></p><h4 id="description-8" tabindex="-1"><a class="header-anchor" href="#description-8"><span>Description</span></a></h4><p>Curstomers 表:</p><div class="language-html" data-ext="html" data-title="html"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+----+-------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| Id | Name  |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+----+-------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 1  | Joe   |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 2  | Henry |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 3  | Sam   |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 4  | Max   |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+----+-------+</span></span></code></pre></div><p>Orders 表:</p><div class="language-html" data-ext="html" data-title="html"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+----+------------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| Id | CustomerId |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+----+------------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 1  | 3          |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 2  | 1          |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+----+------------+</span></span></code></pre></div><p>查找没有订单的顾客信息:</p><div class="language-html" data-ext="html" data-title="html"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+-----------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| Customers |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+-----------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| Henry     |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| Max       |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+-----------+</span></span></code></pre></div><h4 id="sql-schema-8" tabindex="-1"><a class="header-anchor" href="#sql-schema-8"><span>SQL Schema</span></a></h4><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">DROP</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> TABLE</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">IF</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    EXISTS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> Customers;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> TABLE</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> Customers</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( Id </span><span style="color:#C678DD;--shiki-dark:#C678DD;">INT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#C678DD;--shiki-dark:#C678DD;">NAME</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> VARCHAR</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">255</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ) );</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">DROP</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> TABLE</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">IF</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    EXISTS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> Orders;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> TABLE</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> Orders</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( Id </span><span style="color:#C678DD;--shiki-dark:#C678DD;">INT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, CustomerId </span><span style="color:#C678DD;--shiki-dark:#C678DD;">INT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> );</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">INSERT INTO</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> Customers ( Id, </span><span style="color:#C678DD;--shiki-dark:#C678DD;">NAME</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> )</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">VALUES</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;Joe&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;Henry&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;Sam&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">4</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;Max&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> );</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">INSERT INTO</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> Orders ( Id, CustomerId )</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">VALUES</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> );</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="solution-8" tabindex="-1"><a class="header-anchor" href="#solution-8"><span>Solution</span></a></h4><p>左外链接</p><div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">SELECT</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;">    C</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">Name</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> AS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> Customers</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">FROM</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    Customers C</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    LEFT JOIN</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> Orders O</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    ON</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> C</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">Id</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> O</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">CustomerId</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">WHERE</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;">    O</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">CustomerId</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> IS</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> NULL</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span></code></pre></div><p>子查询</p><div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">SELECT</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    Name</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> AS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> Customers</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">FROM</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    Customers</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">WHERE</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    Id </span><span style="color:#C678DD;--shiki-dark:#C678DD;">NOT</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> IN</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( </span><span style="color:#C678DD;--shiki-dark:#C678DD;">SELECT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> CustomerId </span><span style="color:#C678DD;--shiki-dark:#C678DD;">FROM</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> Orders );</span></span></code></pre></div><h3 id="_184-department-highest-salary" tabindex="-1"><a class="header-anchor" href="#_184-department-highest-salary"><span>184. * Department Highest Salary</span></a></h3><p><a href="https://leetcode.com/problems/department-highest-salary/description/" target="_blank" rel="noopener noreferrer">https://leetcode.com/problems/department-highest-salary/description/</a></p><h4 id="description-9" tabindex="-1"><a class="header-anchor" href="#description-9"><span>Description</span></a></h4><p>Employee 表:</p><div class="language-html" data-ext="html" data-title="html"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+----+-------+--------+--------------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| Id | Name  | Salary | DepartmentId |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+----+-------+--------+--------------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 1  | Joe   | 70000  | 1            |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 2  | Henry | 80000  | 2            |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 3  | Sam   | 60000  | 2            |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 4  | Max   | 90000  | 1            |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+----+-------+--------+--------------+</span></span></code></pre></div><p>Department 表:</p><div class="language-html" data-ext="html" data-title="html"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+----+----------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| Id | Name     |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+----+----------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 1  | IT       |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 2  | Sales    |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+----+----------+</span></span></code></pre></div><p>查找一个 Department 中收入最高者的信息:</p><div class="language-html" data-ext="html" data-title="html"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+------------+----------+--------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| Department | Employee | Salary |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+------------+----------+--------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| IT         | Max      | 90000  |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| Sales      | Henry    | 80000  |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+------------+----------+--------+</span></span></code></pre></div><h4 id="sql-schema-9" tabindex="-1"><a class="header-anchor" href="#sql-schema-9"><span>SQL Schema</span></a></h4><div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">DROP</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> TABLE</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> IF</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> EXISTS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> Employee;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> TABLE</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> Employee</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( Id </span><span style="color:#C678DD;--shiki-dark:#C678DD;">INT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#C678DD;--shiki-dark:#C678DD;">NAME</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> VARCHAR</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">255</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ), Salary </span><span style="color:#C678DD;--shiki-dark:#C678DD;">INT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, DepartmentId </span><span style="color:#C678DD;--shiki-dark:#C678DD;">INT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> );</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">DROP</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> TABLE</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> IF</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> EXISTS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> Department;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> TABLE</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> Department</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( Id </span><span style="color:#C678DD;--shiki-dark:#C678DD;">INT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#C678DD;--shiki-dark:#C678DD;">NAME</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> VARCHAR</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">255</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ) );</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">INSERT INTO</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> Employee ( Id, </span><span style="color:#C678DD;--shiki-dark:#C678DD;">NAME</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, Salary, DepartmentId )</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">VALUES</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;Joe&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">70000</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;Henry&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">80000</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;Sam&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">60000</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">4</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;Max&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">90000</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> );</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">INSERT INTO</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> Department ( Id, </span><span style="color:#C678DD;--shiki-dark:#C678DD;">NAME</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> )</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">VALUES</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;IT&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;Sales&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> );</span></span></code></pre></div><h4 id="solution-9" tabindex="-1"><a class="header-anchor" href="#solution-9"><span>Solution</span></a></h4><blockquote><p>我第一遍的方案是查出部门中工资最高的员工，再匹配这个公司对应的人。但这样可能存在多个工资一样的人</p></blockquote><p>创建一个临时表，包含了部门员工的最大薪资。可以对部门进行分组，然后使用 MAX() 汇总函数取得最大薪资。</p><p>之后使用连接找到一个部门中薪资等于临时表中最大薪资的员工。</p><div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">SELECT</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;">    D</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">NAME</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> Department,</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;">    E</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">NAME</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> Employee,</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;">    E</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">Salary</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">FROM</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    Employee E,</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    Department D,</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#C678DD;--shiki-dark:#C678DD;">SELECT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> DepartmentId, </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">MAX</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">( Salary ) Salary </span><span style="color:#C678DD;--shiki-dark:#C678DD;">FROM</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> Employee </span><span style="color:#C678DD;--shiki-dark:#C678DD;">GROUP BY</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> DepartmentId ) M</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">WHERE</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;">    E</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">DepartmentId</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> D</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">Id</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    AND</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> E</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">DepartmentId</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> M</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">DepartmentId</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    AND</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> E</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">Salary</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> M</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">Salary</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span></code></pre></div><h3 id="_176-second-highest-salary" tabindex="-1"><a class="header-anchor" href="#_176-second-highest-salary"><span>176. Second Highest Salary</span></a></h3><p><a href="https://leetcode.com/problems/second-highest-salary/description/" target="_blank" rel="noopener noreferrer">https://leetcode.com/problems/second-highest-salary/description/</a></p><h4 id="description-10" tabindex="-1"><a class="header-anchor" href="#description-10"><span>Description</span></a></h4><div class="language-html" data-ext="html" data-title="html"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+----+--------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| Id | Salary |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+----+--------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 1  | 100    |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 2  | 200    |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 3  | 300    |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+----+--------+</span></span></code></pre></div><p>查找工资第二高的员工。</p><div class="language-html" data-ext="html" data-title="html"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+---------------------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| SecondHighestSalary |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+---------------------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 200                 |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+---------------------+</span></span></code></pre></div><p>没有找到返回 null 而不是不返回数据。</p><h4 id="sql-schema-10" tabindex="-1"><a class="header-anchor" href="#sql-schema-10"><span>SQL Schema</span></a></h4><div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">DROP</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> TABLE</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">IF</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    EXISTS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> Employee;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> TABLE</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> Employee</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( Id </span><span style="color:#C678DD;--shiki-dark:#C678DD;">INT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, Salary </span><span style="color:#C678DD;--shiki-dark:#C678DD;">INT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> );</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">INSERT INTO</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> Employee ( Id, Salary )</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">VALUES</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">100</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">200</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">300</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> );</span></span></code></pre></div><h4 id="solution-10" tabindex="-1"><a class="header-anchor" href="#solution-10"><span>Solution</span></a></h4><p>为了在没有查找到数据时返回 null，需要在查询结果外面再套一层 SELECT。</p><div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">SELECT</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#C678DD;--shiki-dark:#C678DD;">SELECT DISTINCT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> Salary </span><span style="color:#C678DD;--shiki-dark:#C678DD;">FROM</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> Employee </span><span style="color:#C678DD;--shiki-dark:#C678DD;">ORDER BY</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> Salary </span><span style="color:#C678DD;--shiki-dark:#C678DD;">DESC</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> LIMIT</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ) SecondHighestSalary;</span></span></code></pre></div><h3 id="_177-nth-highest-salary" tabindex="-1"><a class="header-anchor" href="#_177-nth-highest-salary"><span>177. * Nth Highest Salary</span></a></h3><h4 id="description-11" tabindex="-1"><a class="header-anchor" href="#description-11"><span>Description</span></a></h4><p>查找工资第 N 高的员工。</p><h4 id="sql-schema-11" tabindex="-1"><a class="header-anchor" href="#sql-schema-11"><span>SQL Schema</span></a></h4><p>同 176。</p><h4 id="solution-11" tabindex="-1"><a class="header-anchor" href="#solution-11"><span>Solution</span></a></h4><blockquote><p>函数不太会写了</p></blockquote><div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> FUNCTION</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> getNthHighestSalary</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( N </span><span style="color:#C678DD;--shiki-dark:#C678DD;">INT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ) </span><span style="color:#C678DD;--shiki-dark:#C678DD;">RETURNS</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> INT</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> BEGIN</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">SET</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> N </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> N - </span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">RETURN</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( </span><span style="color:#C678DD;--shiki-dark:#C678DD;">SELECT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( </span><span style="color:#C678DD;--shiki-dark:#C678DD;">SELECT DISTINCT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> Salary </span><span style="color:#C678DD;--shiki-dark:#C678DD;">FROM</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> Employee </span><span style="color:#C678DD;--shiki-dark:#C678DD;">ORDER BY</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> Salary </span><span style="color:#C678DD;--shiki-dark:#C678DD;">DESC</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> LIMIT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> N, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ) );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">END</span></span></code></pre></div><h3 id="_178-rank-scores" tabindex="-1"><a class="header-anchor" href="#_178-rank-scores"><span>178. Rank Scores</span></a></h3><p><a href="https://leetcode.com/problems/rank-scores/description/" target="_blank" rel="noopener noreferrer">https://leetcode.com/problems/rank-scores/description/</a></p><h4 id="description-12" tabindex="-1"><a class="header-anchor" href="#description-12"><span>Description</span></a></h4><p>得分表:</p><div class="language-html" data-ext="html" data-title="html"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+----+-------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| Id | Score |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+----+-------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 1  | 3.50  |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 2  | 3.65  |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 3  | 4.00  |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 4  | 3.85  |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 5  | 4.00  |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 6  | 3.65  |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+----+-------+</span></span></code></pre></div><p>将得分排序，并统计排名。</p><div class="language-html" data-ext="html" data-title="html"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+-------+------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| Score | Rank |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+-------+------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 4.00  | 1    |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 4.00  | 1    |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 3.85  | 2    |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 3.65  | 3    |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 3.65  | 3    |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 3.50  | 4    |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+-------+------+</span></span></code></pre></div><h4 id="sql-schema-12" tabindex="-1"><a class="header-anchor" href="#sql-schema-12"><span>SQL Schema</span></a></h4><blockquote><ol><li>这题单单给结果返回序号还不够，同名的都需要为第一名</li><li>178 答案有点问题，网上找了好几个也不能直接执行</li></ol></blockquote><div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">DROP</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> TABLE</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">IF</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    EXISTS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> Scores;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> TABLE</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> Scores</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( Id </span><span style="color:#C678DD;--shiki-dark:#C678DD;">INT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, Score </span><span style="color:#C678DD;--shiki-dark:#C678DD;">DECIMAL</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ) );</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">INSERT INTO</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> Scores ( Id, Score )</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">VALUES</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">5</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">65</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">4</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">4</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">85</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">5</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">4</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">6</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">65</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> );</span></span></code></pre></div><h4 id="solution-12" tabindex="-1"><a class="header-anchor" href="#solution-12"><span>Solution</span></a></h4><div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">SELECT</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;">    S1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">score</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    COUNT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">( </span><span style="color:#C678DD;--shiki-dark:#C678DD;">DISTINCT</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> S2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">score</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ) Rank</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">FROM</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    Scores S1</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    INNER JOIN</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> Scores S2</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    ON</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> S1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">score</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> &lt;=</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> S2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">score</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">GROUP BY</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;">    S1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">id</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">ORDER BY</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;">    S1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">score</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> DESC</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span></code></pre></div><h3 id="_180-consecutive-numbers" tabindex="-1"><a class="header-anchor" href="#_180-consecutive-numbers"><span>180. * Consecutive Numbers</span></a></h3><p><a href="https://leetcode.com/problems/consecutive-numbers/description/" target="_blank" rel="noopener noreferrer">https://leetcode.com/problems/consecutive-numbers/description/</a></p><h4 id="description-13" tabindex="-1"><a class="header-anchor" href="#description-13"><span>Description</span></a></h4><p>数字表:</p><div class="language-html" data-ext="html" data-title="html"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+----+-----+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| Id | Num |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+----+-----+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 1  |  1  |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 2  |  1  |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 3  |  1  |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 4  |  2  |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 5  |  1  |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 6  |  2  |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 7  |  2  |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+----+-----+</span></span></code></pre></div><p>查找连续出现三次的数字。</p><div class="language-html" data-ext="html" data-title="html"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+-----------------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| ConsecutiveNums |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+-----------------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| 1               |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+-----------------+</span></span></code></pre></div><h4 id="sql-schema-13" tabindex="-1"><a class="header-anchor" href="#sql-schema-13"><span>SQL Schema</span></a></h4><div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">DROP</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> TABLE</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">IF</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    EXISTS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> LOGS;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> TABLE</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> LOGS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( Id </span><span style="color:#C678DD;--shiki-dark:#C678DD;">INT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, Num </span><span style="color:#C678DD;--shiki-dark:#C678DD;">INT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> );</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">INSERT INTO</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> LOGS ( Id, Num )</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">VALUES</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">4</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">5</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">6</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">7</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> );</span></span></code></pre></div><h4 id="solution-13" tabindex="-1"><a class="header-anchor" href="#solution-13"><span>Solution</span></a></h4><blockquote><p>连续出现三次，就关联自己三次[破涕为笑]</p></blockquote><div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">SELECT</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    DISTINCT</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> L1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">num</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ConsecutiveNums</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">FROM</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    Logs L1,</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    Logs L2,</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    Logs L3</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">WHERE</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> L1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">id</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> l2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">id</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> - </span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    AND</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> L2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">id</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> L3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">id</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> - </span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    AND</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> L1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">num</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> L2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">num</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    AND</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> l2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">num</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> l3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">num</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span></code></pre></div><h3 id="_626-exchange-seats" tabindex="-1"><a class="header-anchor" href="#_626-exchange-seats"><span>626. Exchange Seats</span></a></h3><p><a href="https://leetcode.com/problems/exchange-seats/description/" target="_blank" rel="noopener noreferrer">https://leetcode.com/problems/exchange-seats/description/</a></p><h4 id="description-14" tabindex="-1"><a class="header-anchor" href="#description-14"><span>Description</span></a></h4><p>seat 表存储着座位对应的学生。</p><div class="language-html" data-ext="html" data-title="html"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+---------+---------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|    id   | student |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+---------+---------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|    1    | Abbot   |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|    2    | Doris   |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|    3    | Emerson |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|    4    | Green   |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|    5    | Jeames  |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+---------+---------+</span></span></code></pre></div><p>要求交换相邻座位的两个学生，如果最后一个座位是奇数，那么不交换这个座位上的学生。</p><div class="language-html" data-ext="html" data-title="html"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+---------+---------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|    id   | student |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+---------+---------+</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|    1    | Doris   |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|    2    | Abbot   |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|    3    | Green   |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|    4    | Emerson |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|    5    | Jeames  |</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">+---------+---------+</span></span></code></pre></div><h4 id="sql-schema-14" tabindex="-1"><a class="header-anchor" href="#sql-schema-14"><span>SQL Schema</span></a></h4><div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">DROP</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> TABLE</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">IF</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    EXISTS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> seat;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">CREATE</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> TABLE</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> seat</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( id </span><span style="color:#C678DD;--shiki-dark:#C678DD;">INT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, student </span><span style="color:#C678DD;--shiki-dark:#C678DD;">VARCHAR</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">255</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ) );</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">INSERT INTO</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> seat ( id, student )</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">VALUES</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;1&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;Abbot&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;2&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;Doris&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;3&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;Emerson&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;4&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;Green&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ),</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ( </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;5&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;Jeames&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> );</span></span></code></pre></div><h4 id="solution-14" tabindex="-1"><a class="header-anchor" href="#solution-14"><span>Solution</span></a></h4><blockquote><p>刚开始一直想着用case when 怎么处理，发现很难处理</p></blockquote><p>使用多个 union。</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">SELECT</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;">    s1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">id</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> - </span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> AS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> id,</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;">    s1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">student</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">FROM</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    seat s1</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">WHERE</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;">    s1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">id</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> MOD </span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> UNION</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">SELECT</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;">    s2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">id</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> + </span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> AS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> id,</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;">    s2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">student</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">FROM</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    seat s2</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">WHERE</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;">    s2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">id</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> MOD </span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    AND</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> s2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">id</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> !=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( </span><span style="color:#C678DD;--shiki-dark:#C678DD;">SELECT</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> max</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">s3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">id</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ) </span><span style="color:#C678DD;--shiki-dark:#C678DD;">FROM</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> seat s3 ) </span><span style="color:#C678DD;--shiki-dark:#C678DD;">UNION</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">SELECT</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;">    s4</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">id</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> AS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> id,</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;">    s4</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">student</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">FROM</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    seat s4</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">WHERE</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;">    s4</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">id</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> MOD </span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    AND</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> s4</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">id</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ( </span><span style="color:#C678DD;--shiki-dark:#C678DD;">SELECT</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> max</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">( </span><span style="color:#D19A66;--shiki-dark:#D19A66;">s5</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">id</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ) </span><span style="color:#C678DD;--shiki-dark:#C678DD;">FROM</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> seat s5 )</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">ORDER BY</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    id;</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="参考文章" tabindex="-1"><a class="header-anchor" href="#参考文章"><span>参考文章</span></a></h2><p><a href="https://pdai.tech/md/db/sql-lan/sql-lan-leetcode.html" target="_blank" rel="noopener noreferrer"><strong>SQL语言 - SQL题目进阶</strong></a></p>`,191)]))}const e=a(p,[["render",B],["__file","sql-x-leetcode.html.vue"]]),k=JSON.parse('{"path":"/posts/Database/MySQL/sql-x-leetcode.html","title":"16、Leetcode中SQL题目","lang":"zh-CN","frontmatter":{"title":"16、Leetcode中SQL题目","date":"2024-03-10 11:59","category":["数据库"],"tag":["MySQL"],"description":"Leetcode中SQL题目 595. Big Countries https://leetcode.com/problems/big-countries/description/ Description 查找面积超过 3,000,000 或者人口数超过 25,000,000 的国家。 SQL Schema Solution 627. *Swap Sa...","head":[["meta",{"property":"og:url","content":"https://mrjason.me/posts/Database/MySQL/sql-x-leetcode.html"}],["meta",{"property":"og:site_name","content":"mrjason’s Blog"}],["meta",{"property":"og:title","content":"16、Leetcode中SQL题目"}],["meta",{"property":"og:description","content":"Leetcode中SQL题目 595. Big Countries https://leetcode.com/problems/big-countries/description/ Description 查找面积超过 3,000,000 或者人口数超过 25,000,000 的国家。 SQL Schema Solution 627. *Swap Sa..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-10-21T07:03:09.000Z"}],["meta",{"property":"article:author","content":"MrJason"}],["meta",{"property":"article:tag","content":"MySQL"}],["meta",{"property":"article:published_time","content":"2024-03-10T11:59:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-10-21T07:03:09.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"16、Leetcode中SQL题目\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2024-03-10T11:59:00.000Z\\",\\"dateModified\\":\\"2024-10-21T07:03:09.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"MrJason\\",\\"url\\":\\"https://mrjason.me\\"}]}"]]},"headers":[{"level":3,"title":"595. Big Countries","slug":"_595-big-countries","link":"#_595-big-countries","children":[]},{"level":3,"title":"627. *Swap Salary","slug":"_627-swap-salary","link":"#_627-swap-salary","children":[]},{"level":3,"title":"620. Not Boring Movies","slug":"_620-not-boring-movies","link":"#_620-not-boring-movies","children":[]},{"level":3,"title":"596. Classes More Than 5 Students","slug":"_596-classes-more-than-5-students","link":"#_596-classes-more-than-5-students","children":[]},{"level":3,"title":"182. Duplicate Emails","slug":"_182-duplicate-emails","link":"#_182-duplicate-emails","children":[]},{"level":3,"title":"196. *Delete Duplicate Emails","slug":"_196-delete-duplicate-emails","link":"#_196-delete-duplicate-emails","children":[]},{"level":3,"title":"175. Combine Two Tables","slug":"_175-combine-two-tables","link":"#_175-combine-two-tables","children":[]},{"level":3,"title":"181. * Employees Earning More Than Their Managers","slug":"_181-employees-earning-more-than-their-managers","link":"#_181-employees-earning-more-than-their-managers","children":[]},{"level":3,"title":"183. Customers Who Never Order","slug":"_183-customers-who-never-order","link":"#_183-customers-who-never-order","children":[]},{"level":3,"title":"184. * Department Highest Salary","slug":"_184-department-highest-salary","link":"#_184-department-highest-salary","children":[]},{"level":3,"title":"176. Second Highest Salary","slug":"_176-second-highest-salary","link":"#_176-second-highest-salary","children":[]},{"level":3,"title":"177. * Nth Highest Salary","slug":"_177-nth-highest-salary","link":"#_177-nth-highest-salary","children":[]},{"level":3,"title":"178. Rank Scores","slug":"_178-rank-scores","link":"#_178-rank-scores","children":[]},{"level":3,"title":"180. * Consecutive Numbers","slug":"_180-consecutive-numbers","link":"#_180-consecutive-numbers","children":[]},{"level":3,"title":"626. Exchange Seats","slug":"_626-exchange-seats","link":"#_626-exchange-seats","children":[]},{"level":2,"title":"参考文章","slug":"参考文章","link":"#参考文章","children":[]}],"git":{"createdTime":1729494189000,"updatedTime":1729494189000,"contributors":[{"name":"MrJason","email":"845886914@qq.com","commits":1}]},"readingTime":{"minutes":7.49,"words":2248},"filePathRelative":"posts/Database/MySQL/sql-x-leetcode.md","localizedDate":"2024年3月10日","excerpt":"\\n<h3>595. Big Countries</h3>\\n<p><a href=\\"https://leetcode.com/problems/big-countries/description/\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">https://leetcode.com/problems/big-countries/description/</a></p>\\n<h4>Description</h4>\\n<div class=\\"language-html\\" data-ext=\\"html\\" data-title=\\"html\\"><pre class=\\"shiki shiki-themes one-dark-pro one-dark-pro vp-code\\" style=\\"background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf\\" tabindex=\\"0\\"><code><span class=\\"line\\"><span style=\\"color:#ABB2BF;--shiki-dark:#ABB2BF\\">+-----------------+------------+------------+--------------+---------------+</span></span>\\n<span class=\\"line\\"><span style=\\"color:#ABB2BF;--shiki-dark:#ABB2BF\\">| name            | continent  | area       | population   | gdp           |</span></span>\\n<span class=\\"line\\"><span style=\\"color:#ABB2BF;--shiki-dark:#ABB2BF\\">+-----------------+------------+------------+--------------+---------------+</span></span>\\n<span class=\\"line\\"><span style=\\"color:#ABB2BF;--shiki-dark:#ABB2BF\\">| Afghanistan     | Asia       | 652230     | 25500100     | 20343000      |</span></span>\\n<span class=\\"line\\"><span style=\\"color:#ABB2BF;--shiki-dark:#ABB2BF\\">| Albania         | Europe     | 28748      | 2831741      | 12960000      |</span></span>\\n<span class=\\"line\\"><span style=\\"color:#ABB2BF;--shiki-dark:#ABB2BF\\">| Algeria         | Africa     | 2381741    | 37100000     | 188681000     |</span></span>\\n<span class=\\"line\\"><span style=\\"color:#ABB2BF;--shiki-dark:#ABB2BF\\">| Andorra         | Europe     | 468        | 78115        | 3712000       |</span></span>\\n<span class=\\"line\\"><span style=\\"color:#ABB2BF;--shiki-dark:#ABB2BF\\">| Angola          | Africa     | 1246700    | 20609294     | 100990000     |</span></span>\\n<span class=\\"line\\"><span style=\\"color:#ABB2BF;--shiki-dark:#ABB2BF\\">+-----------------+------------+------------+--------------+---------------+</span></span></code></pre>\\n</div>","autoDesc":true}');export{e as comp,k as data};
