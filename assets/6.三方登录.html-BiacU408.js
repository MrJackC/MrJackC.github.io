import{_ as o,c as t,a as r,o as a}from"./app-CzniW49G.js";const n={};function i(s,e){return a(),t("div",null,e[0]||(e[0]=[r('<h1 id="三方登录" tabindex="-1"><a class="header-anchor" href="#三方登录"><span>三方登录</span></a></h1><p>系统对接国内多个第三方平台，实现三方登录的功能。例如说：</p><ul><li>管理后台：企业微信、阿里钉钉</li><li>用户 App：微信公众号、微信小程序</li></ul><figure><img src="https://doc.iocoder.cn/img/三方登录/01.png" alt="管理后台" tabindex="0" loading="lazy"><figcaption>管理后台</figcaption></figure><p>友情提示：为了表述方便，本文主要使用管理后台的三方登录作为示例。</p><p>用户 App 也是支持该功能，你可以自己去体验一下。</p><h2 id="_1-表结构" tabindex="-1"><a class="header-anchor" href="#_1-表结构"><span><a href="https://doc.iocoder.cn/social-user/#_1-%E8%A1%A8%E7%BB%93%E6%9E%84" target="_blank" rel="noopener noreferrer">#</a>1. 表结构</span></a></h2><figure><img src="https://doc.iocoder.cn/img/三方登录/02.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>① 三方登录完成时，系统会将三方用户存储到 <a href="https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-system/yudao-module-system-biz/src/main/java/cn/iocoder/yudao/module/system/dal/dataobject/social/SocialUserDO.java" target="_blank" rel="noopener noreferrer"><code>system_social_user</code> (opens new window)</a>表中，通过 <a href="https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-system/yudao-module-system-api/src/main/java/cn/iocoder/yudao/module/system/enums/social/SocialTypeEnum.java" target="_blank" rel="noopener noreferrer"><code>type</code> (opens new window)</a>标记对应的第三方平台。</p><p>② 【未】关联本系统 User 的三方用户，需要在三方登录完成后，使用账号密码进行「<strong>绑定登录</strong>」，成功后记录到 <a href="https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-system/yudao-module-system-biz/src/main/java/cn/iocoder/yudao/module/system/dal/dataobject/social/SocialUserBindDO.java" target="_blank" rel="noopener noreferrer"><code>system_social_user_bind</code> (opens new window)</a>表中。</p><p>【已】关联本系统 User 的三方用户，在三方登录完成后，直接进入系统，即「<strong>快捷登录</strong>」。</p><h2 id="_2-绑定登录" tabindex="-1"><a class="header-anchor" href="#_2-绑定登录"><span><a href="https://doc.iocoder.cn/social-user/#_2-%E7%BB%91%E5%AE%9A%E7%99%BB%E5%BD%95" target="_blank" rel="noopener noreferrer">#</a>2. 绑定登录</span></a></h2><p>① 使用浏览器访问 <a href="http://127.0.0.1:1024/login" target="_blank" rel="noopener noreferrer">http://127.0.0.1:1024/login (opens new window)</a>地址，点击 [钉钉] 或者 [企业微信] 进行三方登录。此时，会调用 <a href="https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-system/yudao-module-system-biz/src/main/java/cn/iocoder/yudao/module/system/controller/admin/auth/AuthController.java#L97-L106" target="_blank" rel="noopener noreferrer"><code>/admin-api/system/auth/social-auth-redirect</code> (opens new window)</a>接口，获得第三方平台的登录地址，并进行跳转。</p><figure><img src="https://doc.iocoder.cn/img/三方登录/12.png" alt="三方登录" tabindex="0" loading="lazy"><figcaption>三方登录</figcaption></figure><p>然后，使用 [钉钉] 或者 [企业微信] 进行扫码，完成三方登录。</p><p>② 三方登录成功后，跳转回 <a href="http://127.0.0.1:1024/social-login" target="_blank" rel="noopener noreferrer">http://127.0.0.1:1024/social-login (opens new window)</a>地址。此时，会调用 <a href="https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-system/yudao-module-system-biz/src/main/java/cn/iocoder/yudao/module/system/controller/admin/auth/AuthController.java#L149-L154" target="_blank" rel="noopener noreferrer"><code>/admin-api/system/auth/social-login</code> (opens new window)</a>接口，尝试「快捷登录」。由于该三方用户【未】关联管理后台的 AdminUser 用户，所以会看到 “未绑定账号，需要进行绑定” 报错。</p><figure><img src="https://doc.iocoder.cn/img/三方登录/11.png" alt="三方登录页" tabindex="0" loading="lazy"><figcaption>三方登录页</figcaption></figure><p>③ 输入账号密码，点击 [提交] 按钮，进行「绑定登录」。此时，会调用 <a href="https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-system/yudao-module-system-biz/src/main/java/cn/iocoder/yudao/module/system/controller/admin/auth/AuthController.java#L61-L66" target="_blank" rel="noopener noreferrer"><code>/admin-api/system/auth/login</code> (opens new window)</a>接口（在账号密码登录的基础上，额外带上 <code>socialType</code> + <code>socialCode</code> + <code>socialState</code> 参数）。成功后，即可进入系统的首页。</p><figure><img src="https://doc.iocoder.cn/img/三方登录/13.png" alt="三方登录页" tabindex="0" loading="lazy"><figcaption>三方登录页</figcaption></figure><h2 id="_3-快捷登录" tabindex="-1"><a class="header-anchor" href="#_3-快捷登录"><span><a href="https://doc.iocoder.cn/social-user/#_3-%E5%BF%AB%E6%8D%B7%E7%99%BB%E5%BD%95" target="_blank" rel="noopener noreferrer">#</a>3. 快捷登录</span></a></h2><p>退出系统，再进行一次三方登录的流程。</p><p>【相同】① 使用浏览器访问 <a href="http://127.0.0.1:1024/login" target="_blank" rel="noopener noreferrer">http://127.0.0.1:1024/login (opens new window)</a>地址，点击 [钉钉] 或者 [企业微信] 进行三方登录。此时，会调用 <a href="https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-system/yudao-module-system-biz/src/main/java/cn/iocoder/yudao/module/system/controller/admin/auth/AuthController.java#L97-L106" target="_blank" rel="noopener noreferrer"><code>/admin-api/system/auth/social-auth-redirect</code> (opens new window)</a>接口，获得第三方平台的登录地址，并进行跳转。</p><figure><img src="https://doc.iocoder.cn/img/三方登录/12.png" alt="三方登录" tabindex="0" loading="lazy"><figcaption>三方登录</figcaption></figure><p>【不同】② 三方登录成功后，跳转回 <a href="http://127.0.0.1:1024/social-login" target="_blank" rel="noopener noreferrer">http://127.0.0.1:1024/social-login (opens new window)</a>地址。此时，会调用 <a href="https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-system/yudao-module-system-biz/src/main/java/cn/iocoder/yudao/module/system/controller/admin/auth/AuthController.java#L149-L154" target="_blank" rel="noopener noreferrer"><code>/admin-api/system/auth/social-login</code> (opens new window)</a>接口，尝试「快捷登录」。由于该三方用户【已】关联管理后台的 AdminUser 用户，所以直接进入系统的首页。</p><figure><img src="https://doc.iocoder.cn/img/三方登录/13.png" alt="三方登录页" tabindex="0" loading="lazy"><figcaption>三方登录页</figcaption></figure><h2 id="_4-绑定与解绑" tabindex="-1"><a class="header-anchor" href="#_4-绑定与解绑"><span><a href="https://doc.iocoder.cn/social-user/#_4-%E7%BB%91%E5%AE%9A%E4%B8%8E%E8%A7%A3%E7%BB%91" target="_blank" rel="noopener noreferrer">#</a>4. 绑定与解绑</span></a></h2><p>访问 <a href="http://127.0.0.1:1024/user/profile" target="_blank" rel="noopener noreferrer">http://127.0.0.1:1024/user/profile (opens new window)</a>地址，选择 [社交信息] 选项，可以三方用户的绑定与解绑。</p><figure><img src="https://doc.iocoder.cn/img/三方登录/21.png" alt="绑定与解绑" tabindex="0" loading="lazy"><figcaption>绑定与解绑</figcaption></figure><h2 id="_5-配置文件" tabindex="-1"><a class="header-anchor" href="#_5-配置文件"><span><a href="https://doc.iocoder.cn/social-user/#_5-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6" target="_blank" rel="noopener noreferrer">#</a>5. 配置文件</span></a></h2><p>在 <a href="https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-server/src/main/resources/application-local.yaml#L196-L211" target="_blank" rel="noopener noreferrer"><code>application-{env}.yaml</code> (opens new window)</a>配置文件中，对应 <code>justauth</code> 配置项，填写你的第三方平台的配置信息。</p><figure><img src="https://doc.iocoder.cn/img/三方登录/31.png" alt="配置文件" tabindex="0" loading="lazy"><figcaption>配置文件</figcaption></figure><p>系统使用 <a href="https://github.com/justauth/justauth-spring-boot-starter" target="_blank" rel="noopener noreferrer"><code>justauth-spring-boot-starter</code> (opens new window)</a><a href="https://github.com/justauth/justauth-spring-boot-starter" target="_blank" rel="noopener noreferrer">JustAuth (opens new window)</a>组件，想要对接其它第三方平台，只需要新增对应的配置信息即可。</p><p>疑问：yudao-spring-boot-starter-biz-social 技术组件的作用是什么？</p><p><a href="https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-framework/yudao-spring-boot-starter-biz-social/" target="_blank" rel="noopener noreferrer"><code>yudao-spring-boot-starter-biz-social</code> (opens new window)</a>对 JustAuth 进行二次封装，提供微信小程序的集成。</p><h2 id="_6-第三方平台的申请" tabindex="-1"><a class="header-anchor" href="#_6-第三方平台的申请"><span><a href="https://doc.iocoder.cn/social-user/#_6-%E7%AC%AC%E4%B8%89%E6%96%B9%E5%B9%B3%E5%8F%B0%E7%9A%84%E7%94%B3%E8%AF%B7" target="_blank" rel="noopener noreferrer">#</a>6. 第三方平台的申请</span></a></h2><ul><li>阿里钉钉：<a href="https://justauth.wiki/guide/oauth/dingtalk/" target="_blank" rel="noopener noreferrer">https://justauth.wiki/guide/oauth/dingtalk/(opens new window)</a></li><li>企业微信：<a href="https://justauth.wiki/guide/oauth/wechat_enterprise_qrcode/" target="_blank" rel="noopener noreferrer">https://justauth.wiki/guide/oauth/wechat_enterprise_qrcode/(opens new window)</a></li><li>微信开放平台：<a href="https://justauth.wiki/guide/oauth/wechat_open/" target="_blank" rel="noopener noreferrer">https://justauth.wiki/guide/oauth/wechat_open/(opens new window)</a></li></ul><p>注意，如果第三方平台如果需要配置具体的授信地址，需要添加 <code>/social-login</code> 用于三方登录回调页、<code>/user/profile</code> 用于三方用户的绑定与解绑。</p>',37)]))}const c=o(n,[["render",i],["__file","6.三方登录.html.vue"]]),l=JSON.parse('{"path":"/posts/Java/Ruoyi-Vue-Pro/2.%E5%90%8E%E7%AB%AF%E6%89%8B%E5%86%8C/6.%E4%B8%89%E6%96%B9%E7%99%BB%E5%BD%95.html","title":"三方登录","lang":"zh-CN","frontmatter":{"description":"三方登录 系统对接国内多个第三方平台，实现三方登录的功能。例如说： 管理后台：企业微信、阿里钉钉 用户 App：微信公众号、微信小程序 管理后台管理后台 友情提示：为了表述方便，本文主要使用管理后台的三方登录作为示例。 用户 App 也是支持该功能，你可以自己去体验一下。 #1. 表结构 imgimg ① 三方登录完成时，系统会将三方用户存储到 sys...","watermark":true,"head":[["meta",{"property":"og:url","content":"https://mrjackc.github.io/posts/Java/Ruoyi-Vue-Pro/2.%E5%90%8E%E7%AB%AF%E6%89%8B%E5%86%8C/6.%E4%B8%89%E6%96%B9%E7%99%BB%E5%BD%95.html"}],["meta",{"property":"og:site_name","content":"mrjason’s Blog"}],["meta",{"property":"og:title","content":"三方登录"}],["meta",{"property":"og:description","content":"三方登录 系统对接国内多个第三方平台，实现三方登录的功能。例如说： 管理后台：企业微信、阿里钉钉 用户 App：微信公众号、微信小程序 管理后台管理后台 友情提示：为了表述方便，本文主要使用管理后台的三方登录作为示例。 用户 App 也是支持该功能，你可以自己去体验一下。 #1. 表结构 imgimg ① 三方登录完成时，系统会将三方用户存储到 sys..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://doc.iocoder.cn/img/%E4%B8%89%E6%96%B9%E7%99%BB%E5%BD%95/01.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-11-21T07:41:53.000Z"}],["meta",{"property":"article:author","content":"MrJason"}],["meta",{"property":"article:modified_time","content":"2024-11-21T07:41:53.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"三方登录\\",\\"image\\":[\\"https://doc.iocoder.cn/img/%E4%B8%89%E6%96%B9%E7%99%BB%E5%BD%95/01.png\\",\\"https://doc.iocoder.cn/img/%E4%B8%89%E6%96%B9%E7%99%BB%E5%BD%95/02.png\\",\\"https://doc.iocoder.cn/img/%E4%B8%89%E6%96%B9%E7%99%BB%E5%BD%95/12.png\\",\\"https://doc.iocoder.cn/img/%E4%B8%89%E6%96%B9%E7%99%BB%E5%BD%95/11.png\\",\\"https://doc.iocoder.cn/img/%E4%B8%89%E6%96%B9%E7%99%BB%E5%BD%95/13.png\\",\\"https://doc.iocoder.cn/img/%E4%B8%89%E6%96%B9%E7%99%BB%E5%BD%95/12.png\\",\\"https://doc.iocoder.cn/img/%E4%B8%89%E6%96%B9%E7%99%BB%E5%BD%95/13.png\\",\\"https://doc.iocoder.cn/img/%E4%B8%89%E6%96%B9%E7%99%BB%E5%BD%95/21.png\\",\\"https://doc.iocoder.cn/img/%E4%B8%89%E6%96%B9%E7%99%BB%E5%BD%95/31.png\\"],\\"dateModified\\":\\"2024-11-21T07:41:53.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"MrJason\\",\\"url\\":\\"https://mrjackc.github.io\\"}]}"]]},"headers":[{"level":2,"title":"#1. 表结构","slug":"_1-表结构","link":"#_1-表结构","children":[]},{"level":2,"title":"#2. 绑定登录","slug":"_2-绑定登录","link":"#_2-绑定登录","children":[]},{"level":2,"title":"#3. 快捷登录","slug":"_3-快捷登录","link":"#_3-快捷登录","children":[]},{"level":2,"title":"#4. 绑定与解绑","slug":"_4-绑定与解绑","link":"#_4-绑定与解绑","children":[]},{"level":2,"title":"#5. 配置文件","slug":"_5-配置文件","link":"#_5-配置文件","children":[]},{"level":2,"title":"#6. 第三方平台的申请","slug":"_6-第三方平台的申请","link":"#_6-第三方平台的申请","children":[]}],"git":{"createdTime":1732174913000,"updatedTime":1732174913000,"contributors":[{"name":"MrJason","email":"845886914@qq.com","commits":1}]},"readingTime":{"minutes":4,"words":1199},"filePathRelative":"posts/Java/Ruoyi-Vue-Pro/2.后端手册/6.三方登录.md","localizedDate":"2024年11月21日","excerpt":"\\n<p>系统对接国内多个第三方平台，实现三方登录的功能。例如说：</p>\\n<ul>\\n<li>管理后台：企业微信、阿里钉钉</li>\\n<li>用户 App：微信公众号、微信小程序</li>\\n</ul>\\n<figure><img src=\\"https://doc.iocoder.cn/img/三方登录/01.png\\" alt=\\"管理后台\\" tabindex=\\"0\\" loading=\\"lazy\\"><figcaption>管理后台</figcaption></figure>\\n<p>友情提示：为了表述方便，本文主要使用管理后台的三方登录作为示例。</p>\\n<p>用户 App 也是支持该功能，你可以自己去体验一下。</p>","autoDesc":true}');export{c as comp,l as data};
