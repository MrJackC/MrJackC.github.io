import{_ as o,c as r,a,o as t}from"./app-CZJgH_ea.js";const n={};function i(c,e){return t(),r("div",null,e[0]||(e[0]=[a('<h1 id="系统日志" tabindex="-1"><a class="header-anchor" href="#系统日志"><span>系统日志</span></a></h1><p>项目提供 2 类 4 种系统日志：</p><ul><li>审计日志：用户的操作日志、登录日志</li><li>API 日志：RESTful API 的访问日志、错误日志</li></ul><h2 id="_1-操作日志" tabindex="-1"><a class="header-anchor" href="#_1-操作日志"><span><a href="https://doc.iocoder.cn/system-log/#_1-%E6%93%8D%E4%BD%9C%E6%97%A5%E5%BF%97" target="_blank" rel="noopener noreferrer">#</a>1. 操作日志</span></a></h2><p>操作日志，记录「谁」在「什么时间」对「什么对象」做了「什么事情」。</p><p>打开 [系统管理 -&gt; 审计日志 -&gt; 操作日志] 菜单，可以看到对应的列表，如下图所示：</p><figure><img src="https://doc.iocoder.cn/img/系统日志/01.png" alt="系统管理 -&gt; 操作日志" tabindex="0" loading="lazy"><figcaption>系统管理 -&gt; 操作日志</figcaption></figure><p>操作日志的记录，由 <a href="https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-framework/yudao-spring-boot-starter-biz-operatelog/" target="_blank" rel="noopener noreferrer"><code>yudao-spring-boot-starter-biz-operatelog</code> (opens new window)</a>技术组件实现，<a href="https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-framework/yudao-spring-boot-starter-biz-operatelog/src/main/java/cn/iocoder/yudao/framework/operatelog/core/aop/OperateLogAspect.java" target="_blank" rel="noopener noreferrer">OperateLogAspect (opens new window)</a>通过 Spring AOP 拦声明了 <a href="https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-framework/yudao-spring-boot-starter-biz-operatelog/src/main/java/cn/iocoder/yudao/framework/operatelog/core/annotations/OperateLog.java" target="_blank" rel="noopener noreferrer"><code>@OperateLog</code> (opens new window)</a>注解的方法，<strong>异步</strong>记录日志。使用示例如下：</p><figure><img src="https://doc.iocoder.cn/img/系统日志/02.png" alt=" 使用示例" tabindex="0" loading="lazy"><figcaption> 使用示例</figcaption></figure><p>操作日志的存储，由 <code>yudao-module-system</code> 的 <a href="https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-system/yudao-module-system-biz/src/main/java/cn/iocoder/yudao/module/system/service/logger/OperateLogServiceImpl.java" target="_blank" rel="noopener noreferrer">OperateLog (opens new window)</a>模块实现，记录到数据库的 <a href="https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-system/yudao-module-system-biz/src/main/java/cn/iocoder/yudao/module/system/dal/dataobject/logger/OperateLogDO.java" target="_blank" rel="noopener noreferrer"><code>system_operate_log</code> (opens new window)</a>表。</p><h3 id="_1-1-operatelog-注解" tabindex="-1"><a class="header-anchor" href="#_1-1-operatelog-注解"><span><a href="https://doc.iocoder.cn/system-log/#_1-1-operatelog-%E6%B3%A8%E8%A7%A3" target="_blank" rel="noopener noreferrer">#</a>1.1 <code>@OperateLog</code> 注解</span></a></h3><p><code>@OperateLog</code> 注解，一共有 6 个属性，如下图所示：</p><figure><img src="https://doc.iocoder.cn/img/系统日志/03.png" alt=" 属性" tabindex="0" loading="lazy"><figcaption> 属性</figcaption></figure><ul><li><code>module</code> 属性：操作模块，例如说：用户、岗位、部门等等。为空时，默认会读取类上的 Swagger <code>@Tag</code> 注解的 <code>name</code> 属性。</li><li><code>name</code> 属性：操作名，例如说：新增用户、修改用户等等。为空时，默认会读取方法的 Swagger <code>@Operation</code> 注解的 <code>summary</code> 属性。</li><li><code>type</code> 属性：操作类型，在 <a href="https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-framework/yudao-spring-boot-starter-biz-operatelog/src/main/java/cn/iocoder/yudao/framework/operatelog/core/enums/OperateTypeEnum.java" target="_blank" rel="noopener noreferrer">OperateTypeEnum (opens new window)</a>枚举。目前有 <code>GET</code> 查询、<code>CREATE</code> 新增、<code>UPDATE</code> 修改、<code>DELETE</code> 删除、<code>EXPORT</code> 导出、<code>IMPORT</code> 导入、<code>OTHER</code> 其它，可进行自定义。</li></ul><h3 id="_1-2-自动记录" tabindex="-1"><a class="header-anchor" href="#_1-2-自动记录"><span><a href="https://doc.iocoder.cn/system-log/#_1-2-%E8%87%AA%E5%8A%A8%E8%AE%B0%E5%BD%95" target="_blank" rel="noopener noreferrer">#</a>1.2 自动记录</span></a></h3><p>操作日志往往记录的是针对某个对象的<strong>写</strong>操作，所以针对 POST、PUT、DELETE 等写请求，<code>yudao-spring-boot-starter-biz-operatelog</code> 组件会自动记录操作日志。</p><ul><li>基于请求方法，转换出对应的 <code>type</code> 操作方法：POST 对应 <code>CREATE</code> 类型，PUT 对应 <code>UPDATE</code> 类型，DELETE 对应 <code>DELETE</code> 类型，其它对应 <code>OTHER</code> 类型。</li><li>基于 Swagger 注解，转换出对应的 <code>module</code> 操作模块、<code>name</code> 操作名。</li></ul><p>因此，绝大多数 RESTful API 对应的方法，无需添加 <code>@OperateLog</code> 注解。例如说：</p><figure><img src="https://doc.iocoder.cn/img/系统日志/05.png" alt=" 属性" tabindex="0" loading="lazy"><figcaption> 属性</figcaption></figure><p>一般来说，只有两种场景需要添加 <code>@OperateLog</code> 注解。</p><p>① 场景一：需要自定义 <code>@OperateLog</code> 注解的属性。例如说：</p><figure><img src="https://doc.iocoder.cn/img/系统日志/06.png" alt=" 自定义属性" tabindex="0" loading="lazy"><figcaption> 自定义属性</figcaption></figure><p>② 场景二：不想自动记录操作日志。例如说：</p><figure><img src="https://doc.iocoder.cn/img/系统日志/07.png" alt=" 自定义属性" tabindex="0" loading="lazy"><figcaption> 自定义属性</figcaption></figure><h3 id="_1-3-后续优化" tabindex="-1"><a class="header-anchor" href="#_1-3-后续优化"><span><a href="https://doc.iocoder.cn/system-log/#_1-3-%E5%90%8E%E7%BB%AD%E4%BC%98%E5%8C%96" target="_blank" rel="noopener noreferrer">#</a>1.3 后续优化</span></a></h3><p><code>yudao-spring-boot-starter-biz-operatelog</code> 组件目前提供的是<strong>轻量级</strong>的操作日志的解决方案，暂时未提供很好的记录操作对应、操作明细、拓展字段的能力。例如说：</p><figure><img src="https://doc.iocoder.cn/img/系统日志/08.png" alt="牛皮的操作日志示例" tabindex="0" loading="lazy"><figcaption>牛皮的操作日志示例</figcaption></figure><ul><li>【新增】2021-09-16 10:00 订单创建，订单号：NO.11089999，其中涉及变量订单号 “NO.11089999”</li><li>【修改】2021-09-16 10:00 用户小明修改了订单的配送地址：从 “金灿灿小区” 修改到 “银盏盏小区”</li></ul><p>未来，艿艿会引入老友开源的 <a href="https://github.com/mouzt/mzt-biz-log" target="_blank" rel="noopener noreferrer">https://github.com/mouzt/mzt-biz-log (opens new window)</a>操作日志组件，优化项目的操作日志功能。大家记得给个 Star 哟！</p><p>目前，如果要记录具体的操作明细、拓展字段，可以调用 <a href="https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-framework/yudao-spring-boot-starter-biz-operatelog/src/main/java/cn/iocoder/yudao/framework/operatelog/core/util/OperateLogUtils.java" target="_blank" rel="noopener noreferrer">OperateLogUtils (opens new window)</a>的静态方法，代码如下：</p><figure><img src="https://doc.iocoder.cn/img/系统日志/04.png" alt="OperateLogUtils" tabindex="0" loading="lazy"><figcaption>OperateLogUtils</figcaption></figure><h2 id="_2-登录日志" tabindex="-1"><a class="header-anchor" href="#_2-登录日志"><span><a href="https://doc.iocoder.cn/system-log/#_2-%E7%99%BB%E5%BD%95%E6%97%A5%E5%BF%97" target="_blank" rel="noopener noreferrer">#</a>2. 登录日志</span></a></h2><p>登录日志，记录用户的登录、登出行为，包括成功的、失败的。</p><p>打开 [系统管理 -&gt; 审计日志 -&gt; 登录日志] 菜单，可以看对应的列表，如下图所示：</p><figure><img src="https://doc.iocoder.cn/img/系统日志/11.png" alt="系统管理 -&gt; 登录日志" tabindex="0" loading="lazy"><figcaption>系统管理 -&gt; 登录日志</figcaption></figure><p>登录日志的存储，由 <code>yudao-module-system</code> 的 <a href="https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-system/yudao-module-system-biz/src/main/java/cn/iocoder/yudao/module/system/service/logger/LoginLogServiceImpl.java" target="_blank" rel="noopener noreferrer">LoginLog (opens new window)</a>模块实现，记录到数据库的 <a href="https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-system/yudao-module-system-biz/src/main/java/cn/iocoder/yudao/module/system/dal/dataobject/logger/LoginLogDO.java" target="_blank" rel="noopener noreferrer"><code>system_login_log</code> (opens new window)</a>表。</p><p>登录类型通过 <a href="https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-system/yudao-module-system-api/src/main/java/cn/iocoder/yudao/module/system/enums/logger/LoginLogTypeEnum.java" target="_blank" rel="noopener noreferrer">LoginLogTypeEnum (opens new window)</a>枚举，登录结果通过 <a href="https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-system/yudao-module-system-api/src/main/java/cn/iocoder/yudao/module/system/enums/logger/LoginResultEnum.java" target="_blank" rel="noopener noreferrer">LoginResultEnum (opens new window)</a>枚举，都可以自定义。代码如下：</p><figure><img src="https://doc.iocoder.cn/img/系统日志/12.png" alt="系统管理 -&gt; 登录日志" tabindex="0" loading="lazy"><figcaption>系统管理 -&gt; 登录日志</figcaption></figure><h2 id="_3-api-访问日志" tabindex="-1"><a class="header-anchor" href="#_3-api-访问日志"><span><a href="https://doc.iocoder.cn/system-log/#_3-api-%E8%AE%BF%E9%97%AE%E6%97%A5%E5%BF%97" target="_blank" rel="noopener noreferrer">#</a>3. API 访问日志</span></a></h2><p>API 访问日志，记录 API 的每次调用，包括 HTTP 请求、用户、开始时间、时长等等信息。</p><p>打开 [基础设施 -&gt; API 日志 -&gt; 访问日志] 菜单，可以看对应的列表，如下图所示：</p><figure><img src="https://doc.iocoder.cn/img/系统日志/21.png" alt="系统管理 -&gt; 访问日志" tabindex="0" loading="lazy"><figcaption>系统管理 -&gt; 访问日志</figcaption></figure><p>访问日志的记录，由 <a href="https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-framework/yudao-spring-boot-starter-web/" target="_blank" rel="noopener noreferrer"><code>yudao-spring-boot-starter-web</code> (opens new window)</a>技术组件实现，通过 <a href="https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-framework/yudao-spring-boot-starter-web/src/main/java/cn/iocoder/yudao/framework/apilog/core/filter/ApiAccessLogFilter.java" target="_blank" rel="noopener noreferrer">ApiAccessLogFilter (opens new window)</a>过滤 RESTful API 请求，<strong>异步</strong>记录日志。</p><p>访问日志的存储，由 <code>yudao-module-infra</code> 的 <a href="https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-infra/yudao-module-infra-biz/src/main/java/cn/iocoder/yudao/module/infra/service/logger/ApiAccessLogServiceImpl.java" target="_blank" rel="noopener noreferrer">AccessLog (opens new window)</a>模块实现，记录到数据库的 <a href="https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-infra/yudao-module-infra-biz/src/main/java/cn/iocoder/yudao/module/infra/dal/dataobject/logger/ApiAccessLogDO.java" target="_blank" rel="noopener noreferrer"><code>infra_api_access_log</code> (opens new window)</a>表。</p><h2 id="_4-api-错误日志" tabindex="-1"><a class="header-anchor" href="#_4-api-错误日志"><span><a href="https://doc.iocoder.cn/system-log/#_4-api-%E9%94%99%E8%AF%AF%E6%97%A5%E5%BF%97" target="_blank" rel="noopener noreferrer">#</a>4. API 错误日志</span></a></h2><p>API 错误日志，记录每次 API 的异常调用，包括 HTTP 请求、用户、异常的堆栈等等信息。</p><p>打开 [基础设施 -&gt; API 日志 -&gt; 错误日志] 菜单，可以看对应的列表，如下图所示：</p><figure><img src="https://doc.iocoder.cn/img/系统日志/31.png" alt="系统管理 -&gt; 错误日志" tabindex="0" loading="lazy"><figcaption>系统管理 -&gt; 错误日志</figcaption></figure><p>错误日志的记录，由 <a href="https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-framework/yudao-spring-boot-starter-web/" target="_blank" rel="noopener noreferrer"><code>yudao-spring-boot-starter-web</code> (opens new window)</a>技术组件实现，通过 <a href="https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-framework/yudao-spring-boot-starter-web/src/main/java/cn/iocoder/yudao/framework/web/core/handler/GlobalExceptionHandler.java" target="_blank" rel="noopener noreferrer">GlobalExceptionHandler (opens new window)</a>拦截每次 RESTful API 的系统异常，<strong>异步</strong>记录日志。</p><figure><img src="https://doc.iocoder.cn/img/系统日志/32.png" alt="GlobalExceptionHandler" tabindex="0" loading="lazy"><figcaption>GlobalExceptionHandler</figcaption></figure><p>错误日志的存储，由 <code>yudao-module-infra</code> 的 <a href="https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-infra/yudao-module-infra-biz/src/main/java/cn/iocoder/yudao/module/infra/service/logger/ApiErrorLogServiceImpl.java" target="_blank" rel="noopener noreferrer">ErrorLog (opens new window)</a>模块实现，记录到数据库的 <a href="https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-infra/yudao-module-infra-biz/src/main/java/cn/iocoder/yudao/module/infra/dal/dataobject/logger/ApiErrorLogDO.java" target="_blank" rel="noopener noreferrer"><code>infra_api_error_log</code> (opens new window)</a>表。</p>',51)]))}const d=o(n,[["render",i],["__file","15.系统日志.html.vue"]]),g=JSON.parse('{"path":"/posts/Java/Ruoyi-Vue-Pro/2.%E5%90%8E%E7%AB%AF%E6%89%8B%E5%86%8C/15.%E7%B3%BB%E7%BB%9F%E6%97%A5%E5%BF%97.html","title":"系统日志","lang":"zh-CN","frontmatter":{"description":"系统日志 项目提供 2 类 4 种系统日志： 审计日志：用户的操作日志、登录日志 API 日志：RESTful API 的访问日志、错误日志 #1. 操作日志 操作日志，记录「谁」在「什么时间」对「什么对象」做了「什么事情」。 打开 [系统管理 -> 审计日志 -> 操作日志] 菜单，可以看到对应的列表，如下图所示： 系统管理 -> 操作日志系统管理 ...","watermark":true,"head":[["meta",{"property":"og:url","content":"https://springg.us.kg/posts/Java/Ruoyi-Vue-Pro/2.%E5%90%8E%E7%AB%AF%E6%89%8B%E5%86%8C/15.%E7%B3%BB%E7%BB%9F%E6%97%A5%E5%BF%97.html"}],["meta",{"property":"og:site_name","content":"mrjason’s Blog"}],["meta",{"property":"og:title","content":"系统日志"}],["meta",{"property":"og:description","content":"系统日志 项目提供 2 类 4 种系统日志： 审计日志：用户的操作日志、登录日志 API 日志：RESTful API 的访问日志、错误日志 #1. 操作日志 操作日志，记录「谁」在「什么时间」对「什么对象」做了「什么事情」。 打开 [系统管理 -> 审计日志 -> 操作日志] 菜单，可以看到对应的列表，如下图所示： 系统管理 -> 操作日志系统管理 ..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://doc.iocoder.cn/img/%E7%B3%BB%E7%BB%9F%E6%97%A5%E5%BF%97/01.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-11-21T07:41:53.000Z"}],["meta",{"property":"article:author","content":"MrJason"}],["meta",{"property":"article:modified_time","content":"2024-11-21T07:41:53.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"系统日志\\",\\"image\\":[\\"https://doc.iocoder.cn/img/%E7%B3%BB%E7%BB%9F%E6%97%A5%E5%BF%97/01.png\\",\\"https://doc.iocoder.cn/img/%E7%B3%BB%E7%BB%9F%E6%97%A5%E5%BF%97/02.png\\",\\"https://doc.iocoder.cn/img/%E7%B3%BB%E7%BB%9F%E6%97%A5%E5%BF%97/03.png\\",\\"https://doc.iocoder.cn/img/%E7%B3%BB%E7%BB%9F%E6%97%A5%E5%BF%97/05.png\\",\\"https://doc.iocoder.cn/img/%E7%B3%BB%E7%BB%9F%E6%97%A5%E5%BF%97/06.png\\",\\"https://doc.iocoder.cn/img/%E7%B3%BB%E7%BB%9F%E6%97%A5%E5%BF%97/07.png\\",\\"https://doc.iocoder.cn/img/%E7%B3%BB%E7%BB%9F%E6%97%A5%E5%BF%97/08.png\\",\\"https://doc.iocoder.cn/img/%E7%B3%BB%E7%BB%9F%E6%97%A5%E5%BF%97/04.png\\",\\"https://doc.iocoder.cn/img/%E7%B3%BB%E7%BB%9F%E6%97%A5%E5%BF%97/11.png\\",\\"https://doc.iocoder.cn/img/%E7%B3%BB%E7%BB%9F%E6%97%A5%E5%BF%97/12.png\\",\\"https://doc.iocoder.cn/img/%E7%B3%BB%E7%BB%9F%E6%97%A5%E5%BF%97/21.png\\",\\"https://doc.iocoder.cn/img/%E7%B3%BB%E7%BB%9F%E6%97%A5%E5%BF%97/31.png\\",\\"https://doc.iocoder.cn/img/%E7%B3%BB%E7%BB%9F%E6%97%A5%E5%BF%97/32.png\\"],\\"dateModified\\":\\"2024-11-21T07:41:53.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"MrJason\\",\\"url\\":\\"https://springg.us.kg\\"}]}"]]},"headers":[{"level":2,"title":"#1. 操作日志","slug":"_1-操作日志","link":"#_1-操作日志","children":[{"level":3,"title":"#1.1 @OperateLog 注解","slug":"_1-1-operatelog-注解","link":"#_1-1-operatelog-注解","children":[]},{"level":3,"title":"#1.2 自动记录","slug":"_1-2-自动记录","link":"#_1-2-自动记录","children":[]},{"level":3,"title":"#1.3 后续优化","slug":"_1-3-后续优化","link":"#_1-3-后续优化","children":[]}]},{"level":2,"title":"#2. 登录日志","slug":"_2-登录日志","link":"#_2-登录日志","children":[]},{"level":2,"title":"#3. API 访问日志","slug":"_3-api-访问日志","link":"#_3-api-访问日志","children":[]},{"level":2,"title":"#4. API 错误日志","slug":"_4-api-错误日志","link":"#_4-api-错误日志","children":[]}],"git":{"createdTime":1732174913000,"updatedTime":1732174913000,"contributors":[{"name":"MrJason","email":"845886914@qq.com","commits":1}]},"readingTime":{"minutes":5.36,"words":1608},"filePathRelative":"posts/Java/Ruoyi-Vue-Pro/2.后端手册/15.系统日志.md","localizedDate":"2024年11月21日","excerpt":"\\n<p>项目提供 2 类 4 种系统日志：</p>\\n<ul>\\n<li>审计日志：用户的操作日志、登录日志</li>\\n<li>API 日志：RESTful API 的访问日志、错误日志</li>\\n</ul>\\n<h2><a class=\\"header-anchor\\" href=\\"#_1-操作日志\\"><span></span></a><a href=\\"https://doc.iocoder.cn/system-log/#_1-%E6%93%8D%E4%BD%9C%E6%97%A5%E5%BF%97\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">#</a>1. 操作日志</h2>","autoDesc":true}');export{d as comp,g as data};
