import{_ as n,c as r,a,o as t}from"./app-tJW29Kmg.js";const i={};function l(s,e){return t(),r("div",null,e[0]||(e[0]=[a(`<h1 id="gitlab-runner的安装与使用" tabindex="-1"><a class="header-anchor" href="#gitlab-runner的安装与使用"><span>Gitlab-Runner的安装与使用</span></a></h1><h2 id="_1-安装步骤" tabindex="-1"><a class="header-anchor" href="#_1-安装步骤"><span>1. 安装步骤</span></a></h2><h3 id="_1-1-安装gitlab-ci-multi-runner" tabindex="-1"><a class="header-anchor" href="#_1-1-安装gitlab-ci-multi-runner"><span>1.1 安装gitlab-ci-multi-runner</span></a></h3><ul><li><p>添加yum源</p><div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span>curl -L https://packages.gitlab.com/install/repositories/runner/gitlab-ci-multi-runner/script.rpm.sh | sudo bash</span></span></code></pre></div></li><li><p>安装</p><div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span>yum install gitlab-ci-multi-runner</span></span></code></pre></div><p>这里是官网的安装教程，其它操作系统的请参考<br><a href="https://gitlab.com/gitlab-org/gitlab-ci-multi-runner" target="_blank" rel="noopener noreferrer">https://gitlab.com/gitlab-org/gitlab-ci-multi-runner</a></p></li></ul><h3 id="_1-2-使用gitlab-ci-multi-runner注册runner" tabindex="-1"><a class="header-anchor" href="#_1-2-使用gitlab-ci-multi-runner注册runner"><span>1.2 使用gitlab-ci-multi-runner注册Runner</span></a></h3><p>安装好gitlab-ci-multi-runner这个软件之后，我们可以用它想gitlab-ci注册runner</p><p>向gitlab-CI注册runner需要两样东西:<strong>GitLab-CI的url</strong>和<strong>注册token</strong>。</p><p>其中，token是为了确定你这个Runner是<strong>所有工程都能够使用的Shared Runner</strong>还是具体<strong>某一个工程才能使用的Specific Runner</strong>。</p><h4 id="_1-2-1-所有工程都能够使用的shared-runner" tabindex="-1"><a class="header-anchor" href="#_1-2-1-所有工程都能够使用的shared-runner"><span>1.2.1 所有工程都能够使用的Shared Runner</span></a></h4><p>如果要注册Shared Runner，你需要到管理界面的Runners页面里面去找注册token。如下图所示：</p><h4 id="_1-2-2-某一个工程才能使用的specific-runner" tabindex="-1"><a class="header-anchor" href="#_1-2-2-某一个工程才能使用的specific-runner"><span>1.2.2 某一个工程才能使用的Specific Runner</span></a></h4><p>如果要注册Specific Runner，你需要到项目的设置的Runner页面里面去找注册token。如下图所示：</p><figure><img src="https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202404231020625.png" alt="image-20200109135721629" tabindex="0" loading="lazy"><figcaption>image-20200109135721629</figcaption></figure><h4 id="_1-2-3-注册runner" tabindex="-1"><a class="header-anchor" href="#_1-2-3-注册runner"><span>1.2.3 注册runner</span></a></h4><p>找到token之后，运行下面这条命令注册Runner（当然，除了url和token之外，还需要其他的信息，比如执行器<code>executor</code>、构建目录<code>builds_dir</code>等）。</p><div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span># 如果启动sudo 这里也要加上sudo</span></span>
<span class="line"><span>gitlab-ci-multi-runner register</span></span></code></pre></div><figure><img src="https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202404231020669.png" alt="image-20200109140942669" tabindex="0" loading="lazy"><figcaption>image-20200109140942669</figcaption></figure><p>依据提示输入</p><h3 id="注意事项" tabindex="-1"><a class="header-anchor" href="#注意事项"><span>注意事项</span></a></h3><ul><li><p>Whether to run untagged builds [true/false]:</p><p>是否运行在没有 tag 的 build 上面。在配置 gitlab-ci 时，会有很多 job，每个 job 可以通过 tags 属性来选择 Runner。<strong>这里为 true 表示如果 job 没有配置 tags，也执行。</strong></p></li><li><p>Whether to lock the Runner to current project [true/false]:</p><p>是否锁定 Runner 到当前项目</p></li><li><p>选择 executor，这里列出了很多 executor</p><p>shell</p></li></ul><p>注册完成之后，GitLab-CI就会多出一条Runner记录，如下图所示：</p><figure><img src="https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202404231020693.png" alt="image-20200109141223152" tabindex="0" loading="lazy"><figcaption>image-20200109141223152</figcaption></figure><h3 id="_1-3-让注册好的runner运行起来" tabindex="-1"><a class="header-anchor" href="#_1-3-让注册好的runner运行起来"><span>1.3 让注册好的Runner运行起来</span></a></h3><p>Runner注册完成之后还不行，还必须让它运行起来，否则它无法接收到GitLab-CI的通知并且执行软件集成脚本。怎么让Runner运行起来呢？<code>gitlab-ci-multi-runner</code>提供了这样一条命令<code>gitlab-ci-multi-runner run-single</code>，详情如下：</p><div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span>gitlab-ci-multi-runner start gitbook-runner</span></span></code></pre></div><p>查看runner运行状态</p><div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span>ps -aux | grep gitlab-runner</span></span></code></pre></div><p>gitlab运行成功了</p><h2 id="_2-可能遇到的问题" tabindex="-1"><a class="header-anchor" href="#_2-可能遇到的问题"><span>2. 可能遇到的问题</span></a></h2><h3 id="_2-1-注册-runner-后-gitlab-runner-出现灰色感叹号" tabindex="-1"><a class="header-anchor" href="#_2-1-注册-runner-后-gitlab-runner-出现灰色感叹号"><span>2.1 注册 runner 后，gitlab runner 出现灰色感叹号</span></a></h3><p>在服务器注册完 runner 后，在 gitlab 的 runner 处出现灰色感叹号，并提示 new runner has not connected yet。这个问题一般都是权限问题造成的，加 sudo 和不加 sudo 所创建的配置文件不同。在使用 <code>gitlab-runner register</code> 注册的时候，加上 sudo，在启动 runner 时也要加上 sudo ， <code>sudo gitlab-runner restart</code> 或 <code>sudo gitlab-runner start</code> 。</p><h3 id="参考文章" tabindex="-1"><a class="header-anchor" href="#参考文章"><span>参考文章</span></a></h3><p><a href="https://www.jianshu.com/p/2b43151fb92e" target="_blank" rel="noopener noreferrer">GitLab-CI与GitLab-Runner</a></p>`,33)]))}const c=n(i,[["render",l],["__file","gitlab-x-runner-install.html.vue"]]),p=JSON.parse('{"path":"/posts/Git/gitlab-x-runner-install.html","title":"Gitlab-Runner的安装与使用","lang":"zh-CN","frontmatter":{"description":"Gitlab-Runner的安装与使用 1. 安装步骤 1.1 安装gitlab-ci-multi-runner 添加yum源 安装 这里是官网的安装教程，其它操作系统的请参考 https://gitlab.com/gitlab-org/gitlab-ci-multi-runner 1.2 使用gitlab-ci-multi-runner注册Runne...","head":[["meta",{"property":"og:url","content":"https://springg.us.kg/posts/Git/gitlab-x-runner-install.html"}],["meta",{"property":"og:site_name","content":"mrjason’s Blog"}],["meta",{"property":"og:title","content":"Gitlab-Runner的安装与使用"}],["meta",{"property":"og:description","content":"Gitlab-Runner的安装与使用 1. 安装步骤 1.1 安装gitlab-ci-multi-runner 添加yum源 安装 这里是官网的安装教程，其它操作系统的请参考 https://gitlab.com/gitlab-org/gitlab-ci-multi-runner 1.2 使用gitlab-ci-multi-runner注册Runne..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202404231020625.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-10-21T07:03:09.000Z"}],["meta",{"property":"article:author","content":"MrJason"}],["meta",{"property":"article:modified_time","content":"2024-10-21T07:03:09.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Gitlab-Runner的安装与使用\\",\\"image\\":[\\"https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202404231020625.png\\",\\"https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202404231020669.png\\",\\"https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202404231020693.png\\"],\\"dateModified\\":\\"2024-10-21T07:03:09.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"MrJason\\",\\"url\\":\\"https://springg.us.kg\\"}]}"]]},"headers":[{"level":2,"title":"1. 安装步骤","slug":"_1-安装步骤","link":"#_1-安装步骤","children":[{"level":3,"title":"1.1 安装gitlab-ci-multi-runner","slug":"_1-1-安装gitlab-ci-multi-runner","link":"#_1-1-安装gitlab-ci-multi-runner","children":[]},{"level":3,"title":"1.2 使用gitlab-ci-multi-runner注册Runner","slug":"_1-2-使用gitlab-ci-multi-runner注册runner","link":"#_1-2-使用gitlab-ci-multi-runner注册runner","children":[]},{"level":3,"title":"注意事项","slug":"注意事项","link":"#注意事项","children":[]},{"level":3,"title":"1.3 让注册好的Runner运行起来","slug":"_1-3-让注册好的runner运行起来","link":"#_1-3-让注册好的runner运行起来","children":[]}]},{"level":2,"title":"2. 可能遇到的问题","slug":"_2-可能遇到的问题","link":"#_2-可能遇到的问题","children":[{"level":3,"title":"2.1 注册 runner 后，gitlab runner 出现灰色感叹号","slug":"_2-1-注册-runner-后-gitlab-runner-出现灰色感叹号","link":"#_2-1-注册-runner-后-gitlab-runner-出现灰色感叹号","children":[]},{"level":3,"title":"参考文章","slug":"参考文章","link":"#参考文章","children":[]}]}],"git":{"createdTime":1729494189000,"updatedTime":1729494189000,"contributors":[{"name":"MrJason","email":"845886914@qq.com","commits":1}]},"readingTime":{"minutes":2.3,"words":690},"filePathRelative":"posts/Git/gitlab-x-runner-install.md","localizedDate":"2024年10月21日","excerpt":"\\n<h2>1. 安装步骤</h2>\\n<h3>1.1 安装gitlab-ci-multi-runner</h3>\\n<ul>\\n<li>\\n<p>添加yum源</p>\\n<div class=\\"language-\\" data-ext=\\"\\" data-title=\\"\\"><pre class=\\"shiki shiki-themes one-dark-pro one-dark-pro vp-code\\" style=\\"background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf\\" tabindex=\\"0\\"><code><span class=\\"line\\"><span>curl -L https://packages.gitlab.com/install/repositories/runner/gitlab-ci-multi-runner/script.rpm.sh | sudo bash</span></span></code></pre>\\n</div></li>\\n<li>\\n<p>安装</p>\\n<div class=\\"language-\\" data-ext=\\"\\" data-title=\\"\\"><pre class=\\"shiki shiki-themes one-dark-pro one-dark-pro vp-code\\" style=\\"background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf\\" tabindex=\\"0\\"><code><span class=\\"line\\"><span>yum install gitlab-ci-multi-runner</span></span></code></pre>\\n</div><p>这里是官网的安装教程，其它操作系统的请参考<br>\\n<a href=\\"https://gitlab.com/gitlab-org/gitlab-ci-multi-runner\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">https://gitlab.com/gitlab-org/gitlab-ci-multi-runner</a></p>\\n</li>\\n</ul>","autoDesc":true}');export{c as comp,p as data};
