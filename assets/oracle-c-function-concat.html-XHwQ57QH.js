import{_ as a,c as n,a as r,o as i}from"./app-JRvFIbSa.js";const o={};function l(p,s){return i(),n("div",null,s[0]||(s[0]=[r(`<h1 id="oracle在1对多时把一列的值合并为一个值并用逗号分隔" tabindex="-1"><a class="header-anchor" href="#oracle在1对多时把一列的值合并为一个值并用逗号分隔"><span>Oracle在1对多时把一列的值合并为一个值并用逗号分隔</span></a></h1><p>Oracle把一列的值合并为一个值，并用逗号分隔。</p><p>实例中将把部门表（DEPT表）与员工表（EMP表）关联，查询每个部门下的所有员工姓名，员工姓名之间以逗号分隔（如图一）。</p><figure><img src="https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202403130955541.png" alt="image-20201221152131891" tabindex="0" loading="lazy"><figcaption>image-20201221152131891</figcaption></figure><h2 id="_1-wmsys-wm-concat-列名-函数" tabindex="-1"><a class="header-anchor" href="#_1-wmsys-wm-concat-列名-函数"><span>1. WMSYS.WM_CONCAT(列名)函数</span></a></h2><p>介绍：其函数在Oracle 10g推出，在10g版本中，返回字符串类型，在11g版本中返回clob类型。括号里面的参数是列，而且可以是多个列的集合，也就是说在括号里面可以自由地用‘||’合并字符串。</p><div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">SELECT</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> D</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">DEPTNO</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> AS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> 部门编号,</span><span style="color:#D19A66;--shiki-dark:#D19A66;">D</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">DNAME</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> AS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> 部门名称,</span><span style="color:#D19A66;--shiki-dark:#D19A66;">WMSYS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">WM_CONCAT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#D19A66;--shiki-dark:#D19A66;">E</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">ENAME</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#C678DD;--shiki-dark:#C678DD;">AS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> 员工列表 </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">FROM</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> DEPT D</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">LEFT JOIN</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> EMP E </span><span style="color:#C678DD;--shiki-dark:#C678DD;">ON</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> D</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">DEPTNO</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> E</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">DEPTNO</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">GROUP BY</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> D</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">DEPTNO</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#D19A66;--shiki-dark:#D19A66;">D</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">DNAME</span></span></code></pre></div><p>拼接多列（拼接员工姓名和员工编号）</p><div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">SELECT</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> D</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">DEPTNO</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> AS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> 部门编号,</span><span style="color:#D19A66;--shiki-dark:#D19A66;">D</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">DNAME</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> AS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> 部门名称,</span><span style="color:#D19A66;--shiki-dark:#D19A66;">WMSYS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">WM_CONCAT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#D19A66;--shiki-dark:#D19A66;">E</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">ENAME</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">||</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;(&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">||</span><span style="color:#D19A66;--shiki-dark:#D19A66;">E</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">EMPNO</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">||</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;)&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#C678DD;--shiki-dark:#C678DD;">AS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> 员工列表 </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">FROM</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> DEPT D</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">LEFT JOIN</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> EMP E </span><span style="color:#C678DD;--shiki-dark:#C678DD;">ON</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> D</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">DEPTNO</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> E</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">DEPTNO</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">GROUP BY</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> D</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">DEPTNO</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#D19A66;--shiki-dark:#D19A66;">D</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">DNAME</span></span></code></pre></div><h2 id="_2-listagg-列名-分隔符-within-group-order-by-列名-函数" tabindex="-1"><a class="header-anchor" href="#_2-listagg-列名-分隔符-within-group-order-by-列名-函数"><span>2. LISTAGG(列名,&lt;分隔符&gt;) WITHIN GROUP(ORDER BY 列名)函数</span></a></h2><p>介绍：其函数在Oracle 11g 版本中推出，对分组后的数据按照一定的排序进行字符串连接。</p><div class="language-sql" data-ext="sql" data-title="sql"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">SELECT</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> D</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">DEPTNO</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> AS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> 部门编号,</span><span style="color:#D19A66;--shiki-dark:#D19A66;">D</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">DNAME</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> AS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> 部门名称,LISTAGG(</span><span style="color:#D19A66;--shiki-dark:#D19A66;">E</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">ENAME</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;,&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#C678DD;--shiki-dark:#C678DD;">WITHIN</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> GROUP</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#C678DD;--shiki-dark:#C678DD;">ORDER BY</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> E</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">ENAME</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#C678DD;--shiki-dark:#C678DD;">AS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> 员工列表 </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">FROM</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> DEPT D</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">LEFT JOIN</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> EMP E </span><span style="color:#C678DD;--shiki-dark:#C678DD;">ON</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> D</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">DEPTNO</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> E</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">DEPTNO</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">GROUP BY</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> D</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">DEPTNO</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">,</span><span style="color:#D19A66;--shiki-dark:#D19A66;">D</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#D19A66;--shiki-dark:#D19A66;">DNAME</span></span></code></pre></div><p>LISTAGG 中的字段可以不写在GROUP BY</p><h2 id="参考文章" tabindex="-1"><a class="header-anchor" href="#参考文章"><span>参考文章</span></a></h2><p><a href="https://blog.csdn.net/pan_junbiao/article/details/79948222" target="_blank" rel="noopener noreferrer">Oracle把一列的值合并为一个值并用逗号分隔</a></p>`,15)]))}const t=a(o,[["render",l],["__file","oracle-c-function-concat.html.vue"]]),B=JSON.parse('{"path":"/posts/Database/ORACLE/oracle-c-function-concat.html","title":"Oracle在1对多时把一列的值合并为一个值并用逗号分隔","lang":"zh-CN","frontmatter":{"aliases":"Oracle在1对多时把一列的值合并为一个值并用逗号分隔","tags":null,"cssclass":null,"source":null,"created":"2024-02-22 10:49","updated":"2024-03-13 09:55","description":"Oracle在1对多时把一列的值合并为一个值并用逗号分隔 Oracle把一列的值合并为一个值，并用逗号分隔。 实例中将把部门表（DEPT表）与员工表（EMP表）关联，查询每个部门下的所有员工姓名，员工姓名之间以逗号分隔（如图一）。 image-20201221152131891image-20201221152131891 1. WMSYS.WM_CO...","watermark":true,"head":[["meta",{"property":"og:url","content":"https://springg.us.kg/posts/Database/ORACLE/oracle-c-function-concat.html"}],["meta",{"property":"og:site_name","content":"mrjason’s Blog"}],["meta",{"property":"og:title","content":"Oracle在1对多时把一列的值合并为一个值并用逗号分隔"}],["meta",{"property":"og:description","content":"Oracle在1对多时把一列的值合并为一个值并用逗号分隔 Oracle把一列的值合并为一个值，并用逗号分隔。 实例中将把部门表（DEPT表）与员工表（EMP表）关联，查询每个部门下的所有员工姓名，员工姓名之间以逗号分隔（如图一）。 image-20201221152131891image-20201221152131891 1. WMSYS.WM_CO..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202403130955541.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-10-21T07:03:09.000Z"}],["meta",{"property":"article:author","content":"MrJason"}],["meta",{"property":"article:modified_time","content":"2024-10-21T07:03:09.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Oracle在1对多时把一列的值合并为一个值并用逗号分隔\\",\\"image\\":[\\"https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202403130955541.png\\"],\\"dateModified\\":\\"2024-10-21T07:03:09.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"MrJason\\",\\"url\\":\\"https://springg.us.kg\\"}]}"]]},"headers":[{"level":2,"title":"1. WMSYS.WM_CONCAT(列名)函数","slug":"_1-wmsys-wm-concat-列名-函数","link":"#_1-wmsys-wm-concat-列名-函数","children":[]},{"level":2,"title":"2. LISTAGG(列名,<分隔符>) WITHIN GROUP(ORDER BY 列名)函数","slug":"_2-listagg-列名-分隔符-within-group-order-by-列名-函数","link":"#_2-listagg-列名-分隔符-within-group-order-by-列名-函数","children":[]},{"level":2,"title":"参考文章","slug":"参考文章","link":"#参考文章","children":[]}],"git":{"createdTime":1729494189000,"updatedTime":1729494189000,"contributors":[{"name":"MrJason","email":"845886914@qq.com","commits":1}]},"readingTime":{"minutes":1.4,"words":419},"filePathRelative":"posts/Database/ORACLE/oracle-c-function-concat.md","localizedDate":"2024年10月21日","excerpt":"\\n<p>Oracle把一列的值合并为一个值，并用逗号分隔。</p>\\n<p>实例中将把部门表（DEPT表）与员工表（EMP表）关联，查询每个部门下的所有员工姓名，员工姓名之间以逗号分隔（如图一）。</p>\\n<figure><img src=\\"https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202403130955541.png\\" alt=\\"image-20201221152131891\\" tabindex=\\"0\\" loading=\\"lazy\\"><figcaption>image-20201221152131891</figcaption></figure>","autoDesc":true}');export{t as comp,B as data};
