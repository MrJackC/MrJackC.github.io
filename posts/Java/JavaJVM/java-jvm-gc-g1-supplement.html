<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.12" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.46" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://mrjackc.github.io/posts/Java/JavaJVM/java-jvm-gc-g1-supplement.html"><meta property="og:site_name" content="mrjasonâ€™s Blog"><meta property="og:title" content="GC - Java åƒåœ¾å›æ”¶å™¨ä¹‹G1ï¼ˆè¡¥å……ï¼‰"><meta property="og:description" content="GC - Java åƒåœ¾å›æ”¶å™¨ä¹‹G1ï¼ˆè¡¥å……ï¼‰ 1. å‰è¨€ G1:æ»¡è¶³é«˜ååé‡çš„åŒæ—¶æ»¡è¶³GCåœé¡¿çš„æ—¶é—´å°½å¯èƒ½çŸ­ G1æ”¶é›†å™¨æ˜¯ä¸€æ¬¾åœ¨serverç«¯è¿è¡Œçš„åƒåœ¾æ”¶é›†å™¨ï¼Œä¸“é—¨é’ˆå¯¹äºæ‹¥æœ‰å¤šæ ¸å¤„ç†å™¨å’Œå¤§å†…å­˜çš„æœºå™¨ï¼Œåœ¨JDK 7u4ç‰ˆæœ¬å‘è¡Œæ—¶è¢«æ­£å¼æ¨å‡ºï¼Œåœ¨JDK9ä¸­æ›´è¢«æŒ‡å®šä¸ºå®˜æ–¹GCæ”¶é›†å™¨ã€‚å®ƒæ»¡è¶³é«˜ååé‡çš„åŒæ—¶æ»¡è¶³GCåœé¡¿çš„æ—¶é—´å°½å¯èƒ½çŸ­ã€‚ 1.1. G1 ä¼˜åŠ¿ G1æ”¶..."><meta property="og:type" content="article"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202403120957681.png"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-10-21T07:03:09.000Z"><meta property="article:author" content="MrJason"><meta property="article:modified_time" content="2024-10-21T07:03:09.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"GC - Java åƒåœ¾å›æ”¶å™¨ä¹‹G1ï¼ˆè¡¥å……ï¼‰","image":["https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202403120957681.png","https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202403120957719.png","https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202403120957748.png","https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202403120957778.png","https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202403120957806.png"],"dateModified":"2024-10-21T07:03:09.000Z","author":[{"@type":"Person","name":"MrJason","url":"https://mrjackc.github.io"}]}</script><meta name="referrer" content="no-referrer-when-downgrade"><link rel="icon" href="/favicon.ico"><link rel="icon" href="/assets/icon/chrome-mask-512.png" type="image/png" sizes="512x512"><link rel="icon" href="/assets/icon/chrome-mask-192.png" type="image/png" sizes="192x192"><link rel="icon" href="/assets/icon/chrome-512.png" type="image/png" sizes="512x512"><link rel="icon" href="/assets/icon/chrome-192.png" type="image/png" sizes="192x192"><link rel="manifest" href="/manifest.webmanifest" crossorigin="use-credentials"><meta name="theme-color" content="#46bd87"><link rel="apple-touch-icon" href="/assets/icon/apple-icon-152.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="msapplication-TileImage" content="/assets/icon/ms-icon-144.png"><meta name="msapplication-TileColor" content="#ffffff"><link rel="alternate" type="application/rss+xml" href="https://mrjackc.github.io/rss.xml" title="mrjasonâ€™s Blog RSS Feed"><title>GC - Java åƒåœ¾å›æ”¶å™¨ä¹‹G1ï¼ˆè¡¥å……ï¼‰ | mrjasonâ€™s Blog</title><meta name="description" content="GC - Java åƒåœ¾å›æ”¶å™¨ä¹‹G1ï¼ˆè¡¥å……ï¼‰ 1. å‰è¨€ G1:æ»¡è¶³é«˜ååé‡çš„åŒæ—¶æ»¡è¶³GCåœé¡¿çš„æ—¶é—´å°½å¯èƒ½çŸ­ G1æ”¶é›†å™¨æ˜¯ä¸€æ¬¾åœ¨serverç«¯è¿è¡Œçš„åƒåœ¾æ”¶é›†å™¨ï¼Œä¸“é—¨é’ˆå¯¹äºæ‹¥æœ‰å¤šæ ¸å¤„ç†å™¨å’Œå¤§å†…å­˜çš„æœºå™¨ï¼Œåœ¨JDK 7u4ç‰ˆæœ¬å‘è¡Œæ—¶è¢«æ­£å¼æ¨å‡ºï¼Œåœ¨JDK9ä¸­æ›´è¢«æŒ‡å®šä¸ºå®˜æ–¹GCæ”¶é›†å™¨ã€‚å®ƒæ»¡è¶³é«˜ååé‡çš„åŒæ—¶æ»¡è¶³GCåœé¡¿çš„æ—¶é—´å°½å¯èƒ½çŸ­ã€‚ 1.1. G1 ä¼˜åŠ¿ G1æ”¶...">
    <link rel="preload" href="/assets/style-D5zIXRKB.css" as="style"><link rel="stylesheet" href="/assets/style-D5zIXRKB.css">
    <link rel="modulepreload" href="/assets/app-DQS7qcOs.js"><link rel="modulepreload" href="/assets/java-jvm-gc-g1-supplement.html-BHgAPaJu.js">
    
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container external-link-icon has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/"><img class="vp-nav-logo" src="/logo.svg" alt><!----><span class="vp-site-name hide-in-pad">mrjasonâ€™s Blog</span></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="ä¸»é¡µ"><!--[--><span class="font-icon icon iconfont icon-home" style=""></span><!--]-->ä¸»é¡µ<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/demo/" aria-label="å¯¼èˆª"><!--[--><span class="font-icon icon iconfont icon-discover" style=""></span><!--]-->å¯¼èˆª<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="ç¬”è®°åˆ†ç±»"><!--[--><span class="font-icon icon iconfont icon-edit" style=""></span>ç¬”è®°åˆ†ç±»<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">ä»£ç ç¬”è®°</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/posts/Computer-Basics/" aria-label="è®¡ç®—æœºåŸºç¡€"><!--[--><span class="font-icon icon iconfont icon-windows" style=""></span><!--]-->è®¡ç®—æœºåŸºç¡€<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/posts/Data-Structure/" aria-label="æ•°æ®ç»“æ„ä¸ç®—æ³•"><!--[--><span class="font-icon icon iconfont icon-calculate" style=""></span><!--]-->æ•°æ®ç»“æ„ä¸ç®—æ³•<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/posts/Web/" aria-label="å‰ç«¯ç¬”è®°"><!--[--><span class="font-icon icon iconfont icon-code" style=""></span><!--]-->å‰ç«¯ç¬”è®°<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/posts/Linux/" aria-label="Linux"><!--[--><span class="font-icon icon iconfont icon-linux" style=""></span><!--]-->Linux<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/posts/Python/" aria-label="Python"><!--[--><span class="font-icon icon iconfont icon-python" style=""></span><!--]-->Python<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/posts/Database/" aria-label="æ•°æ®åº“"><!--[--><span class="font-icon icon iconfont icon-table" style=""></span><!--]-->æ•°æ®åº“<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/posts/Docker/" aria-label="Docker"><!--[--><span class="font-icon icon iconfont icon-expansion" style=""></span><!--]-->Docker<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/posts/Git/" aria-label="Git"><!--[--><span class="font-icon icon iconfont icon-git" style=""></span><!--]-->Git<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/posts/Redis/" aria-label="Redis"><!--[--><span class="font-icon icon iconfont icon-lock" style=""></span><!--]-->Redis<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/posts/MiddleWare/" aria-label="ä¸­é—´ä»¶"><!--[--><span class="font-icon icon iconfont icon-process" style=""></span><!--]-->ä¸­é—´ä»¶<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/posts/BigData/" aria-label="å¤§æ•°æ®"><!--[--><span class="font-icon icon iconfont icon-hot" style=""></span><!--]-->å¤§æ•°æ®<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/posts/Architect/" aria-label="æ¶æ„å¸ˆ"><!--[--><span class="font-icon icon iconfont icon-study" style=""></span><!--]-->æ¶æ„å¸ˆ<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/posts/Daily-Thoughts/" aria-label="æ—¥å¸¸æ€è€ƒ"><!--[--><span class="font-icon icon iconfont icon-mark" style=""></span><!--]-->æ—¥å¸¸æ€è€ƒ<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/posts/Development-Tools/" aria-label="å¼€å‘å·¥å…·"><!--[--><span class="font-icon icon iconfont icon-tool" style=""></span><!--]-->å¼€å‘å·¥å…·<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">åšå®¢ç›¸å…³</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/blog/" aria-label="åšå®¢ç›¸å…³"><!--[--><span class="font-icon icon iconfont icon-blog" style=""></span><!--]-->åšå®¢ç›¸å…³<!----></a></li></ul></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><a class="route-link route-link-active auto-link" href="/posts/Java/" aria-label="Java"><!--[--><span class="font-icon icon iconfont icon-java" style=""></span><!--]-->Java<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/collect.html" aria-label="æ”¶è—"><!--[--><span class="font-icon icon iconfont icon-hk-shoucang1" style=""></span><!--]-->æ”¶è—<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/news/" aria-label="è¯´è¯´"><!--[--><span class="font-icon icon iconfont icon-news" style=""></span><!--]-->è¯´è¯´<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/visitorsbook.html" aria-label="ç•™è¨€æ¿"><!--[--><span class="font-icon icon iconfont icon-mark" style=""></span><!--]-->ç•™è¨€æ¿<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/friend.html" aria-label="å‹é“¾"><!--[--><span class="font-icon icon iconfont icon-link" style=""></span><!--]-->å‹é“¾<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="å…³äº"><!--[--><span class="font-icon icon iconfont icon-info" style=""></span>å…³äº<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/intro.html" aria-label="å…³äºæˆ‘"><!--[--><span class="font-icon icon iconfont icon-people" style=""></span><!--]-->å…³äºæˆ‘<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/about.html" aria-label="å…³äºæœ¬ç«™"><!--[--><span class="font-icon icon iconfont icon-info" style=""></span><!--]-->å…³äºæœ¬ç«™<!----></a></li></ul></button></div></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/MrjackC/mrjackc.github.io" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://foreverblog.cn/go.html" title="ç©¿æ¢­è™«æ´-éšæœºè®¿é—®åå¹´ä¹‹çº¦å‹é“¾åšå®¢" target="_blank" rel="noopener noreferrer" aria-label="wormhole"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024" fill="currentColor" style="width:1.25rem;height:1.25rem;vertical-align:middle"><path d="M644.608 665.6c192.512-171.008 342.016-395.776 254.464-494.592-27.648-31.232-66.56-45.568-108.032-41.472-34.816 3.584-70.656 20.992-107.008 50.176-116.224-59.904-254.464-55.296-366.592 11.776-86.016 51.2-148.48 134.656-172.544 231.936-18.944 74.24-14.336 152.064 12.8 223.744-44.544 50.688-86.528 154.624-34.816 212.992 21.504 24.576 52.736 35.328 90.112 35.328 114.176-0.512 286.72-100.864 431.616-229.888z m155.648-452.608c14.848-1.536 26.624 2.56 36.352 13.824 9.728 10.752 7.168 39.936-10.752 80.896-18.944-28.672-41.984-55.296-68.096-77.824 17.92-10.752 32.256-15.872 42.496-16.896z m-598.528 517.12c18.944 27.136 40.96 51.712 66.048 73.216-43.008 12.8-72.192 11.776-81.92 1.024-8.704-10.752 0.512-45.056 15.872-74.24z m685.568-246.784c-51.2 75.264-122.368 154.112-200.704 224.256-81.408 72.192-171.008 134.656-254.464 176.64 26.112 5.632 52.224 8.704 78.848 8.704 68.096 0 135.168-18.944 194.048-53.76 124.416-73.216 195.072-211.968 182.272-355.84z m0 0" p-id="4157"></path></svg></a></div><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://www.travellings.cn/go.html" title="å¼€å¾€" target="_blank" rel="noopener noreferrer" aria-label="travelling"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024" fill="currentColor" style="width:1.25rem;height:1.25rem;vertical-align:middle"><path d="M658.836 519.32c-22.121 0-40.145 18.431-40.145 40.957 0 22.528 18.023 40.962 40.145 40.962 22.117 0 40.141-18.434 40.141-40.962 0-22.526-18.024-40.957-40.141-40.957zM364.742 519.32c-22.121 0-40.141 18.431-40.141 40.957 0.41 22.528 18.02 40.962 40.141 40.962 22.117 0 40.141-18.434 40.141-40.962 0-22.526-18.024-40.957-40.141-40.957z" p-id="8700"></path><path d="M512 0C229.23 0 0 229.23 0 512s229.23 512 512 512 512-229.23 512-512S794.77 0 512 0z m133.727 804.81c0 7.375-6.145 13.52-13.516 13.52H391.773c-7.371 0-13.515-6.145-13.515-13.52v-13.516c0-7.371 6.144-13.517 13.515-13.517h240.438c7.371 0 13.516 6.146 13.516 13.517v13.516z m120.832 37.273c-12.289 6.965-27.441 2.867-34.406-9.418l-54.887-96.668c-4.504 0.82-9.422 1.23-13.926 1.23H361.054c-4.914 0-9.421-0.41-13.925-1.23l-54.887 96.668c-6.965 12.285-22.527 16.383-34.406 9.418-12.289-6.961-16.383-22.938-9.422-35.223l51.199-90.113c-27.031-19.66-43.418-52.43-40.957-88.883l19.25-293.273c3.277-49.152 34.406-88.066 87.246-88.066h80.281c0-37.684 29.899-67.993 66.762-67.993 36.868 0 66.766 30.309 66.766 67.993h93.391c53.246 0 70.449 38.914 73.727 88.066l19.25 293.273c2.461 36.453-13.926 69.223-40.957 88.883l51.199 90.113c6.964 12.696 2.867 28.262-9.012 35.223z" p-id="8701"></path><path d="M672.352 314.931H351.633c-14.747 0-26.622 12.285-26.622 27.441v108.953c0 15.157 11.875 27.446 26.622 27.446h320.719c14.746 0 26.625-12.289 26.625-27.446V342.372c0-15.156-11.879-27.441-26.625-27.441z" p-id="8702"></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon" name="outlook"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="vp-outlook-dropdown"><!----></div></button></div><!--[--><div id="docsearch-container" style="display:none;"></div><div><button type="button" class="DocSearch DocSearch-Button" aria-label="æœç´¢"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">æœç´¢</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"><svg width="15" height="15" class="DocSearch-Control-Key-Icon"><path d="M4.505 4.496h2M5.505 5.496v5M8.216 4.496l.055 5.993M10 7.5c.333.333.5.667.5 1v2M12.326 4.5v5.996M8.384 4.496c1.674 0 2.116 0 2.116 1.5s-.442 1.5-2.116 1.5M3.205 9.303c-.09.448-.277 1.21-1.241 1.203C1 10.5.5 9.513.5 8V7c0-1.57.5-2.5 1.464-2.494.964.006 1.134.598 1.24 1.342M12.553 10.5h1.953" stroke-width="1.2" stroke="currentColor" fill="none" stroke-linecap="square"></path></svg></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!----><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">JavaåŸºç¡€</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Javaé›†åˆ</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">JavaWeb</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Java IO</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">Java JVM</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/jvm-overview.html" aria-label="JVMç›¸å…³çŸ¥è¯†ä½“ç³»è¯¦è§£"><!---->JVMç›¸å…³çŸ¥è¯†ä½“ç³»è¯¦è§£<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-jvm-class.html" aria-label="JVM åŸºç¡€ - ç±»å­—èŠ‚ç è¯¦è§£"><!---->JVM åŸºç¡€ - ç±»å­—èŠ‚ç è¯¦è§£<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-jvm-class-enhancer.html" aria-label="JVM åŸºç¡€ - å­—èŠ‚ç çš„å¢å¼ºæŠ€æœ¯"><!---->JVM åŸºç¡€ - å­—èŠ‚ç çš„å¢å¼ºæŠ€æœ¯<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-jvm-classload.html" aria-label="JVM åŸºç¡€ - Java ç±»åŠ è½½æœºåˆ¶"><!---->JVM åŸºç¡€ - Java ç±»åŠ è½½æœºåˆ¶<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-jvm-struct.html" aria-label="JVM åŸºç¡€ - JVM å†…å­˜ç»“æ„"><!---->JVM åŸºç¡€ - JVM å†…å­˜ç»“æ„<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-jvm-heap-s.html" aria-label="JVM åŸºç¡€ - Javaå†…å­˜ç»“æ„(ç²¾ç®€ç‰ˆ)"><!---->JVM åŸºç¡€ - Javaå†…å­˜ç»“æ„(ç²¾ç®€ç‰ˆ)<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-jvm-x-introduce.html" aria-label="JVM åŸºç¡€ - Java å†…å­˜æ¨¡å‹å¼•å…¥"><!---->JVM åŸºç¡€ - Java å†…å­˜æ¨¡å‹å¼•å…¥<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-jvm-jmm.html" aria-label="JVM åŸºç¡€ - Java å†…å­˜æ¨¡å‹è¯¦è§£"><!---->JVM åŸºç¡€ - Java å†…å­˜æ¨¡å‹è¯¦è§£<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-jvm-gc.html" aria-label="GC - Java åƒåœ¾å›æ”¶åŸºç¡€çŸ¥è¯†"><!---->GC - Java åƒåœ¾å›æ”¶åŸºç¡€çŸ¥è¯†<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-jvm-gc-g1.html" aria-label="GC - Java åƒåœ¾å›æ”¶å™¨ä¹‹G1è¯¦è§£"><!---->GC - Java åƒåœ¾å›æ”¶å™¨ä¹‹G1è¯¦è§£<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link vp-sidebar-page active" href="/posts/Java/JavaJVM/java-jvm-gc-g1-supplement.html" aria-label="GC - Java åƒåœ¾å›æ”¶å™¨ä¹‹G1ï¼ˆè¡¥å……ï¼‰"><!---->GC - Java åƒåœ¾å›æ”¶å™¨ä¹‹G1ï¼ˆè¡¥å……ï¼‰<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-jvm-cms-gc.html" aria-label="GC - Java åƒåœ¾å›æ”¶å™¨ä¹‹CMS GCé—®é¢˜åˆ†æä¸è§£å†³"><!---->GC - Java åƒåœ¾å›æ”¶å™¨ä¹‹CMS GCé—®é¢˜åˆ†æä¸è§£å†³<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-jvm-param.html" aria-label="è°ƒè¯•æ’é”™ - JVM è°ƒä¼˜å‚æ•°"><!---->è°ƒè¯•æ’é”™ - JVM è°ƒä¼˜å‚æ•°<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-jvm-oom.html" aria-label="è°ƒè¯•æ’é”™ - Java å†…å­˜åˆ†æä¹‹å †å†…å­˜å’ŒMetaSpaceå†…å­˜"><!---->è°ƒè¯•æ’é”™ - Java å†…å­˜åˆ†æä¹‹å †å†…å­˜å’ŒMetaSpaceå†…å­˜<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-jvm-oom-offheap.html" aria-label="è°ƒè¯•æ’é”™ - Java å†…å­˜åˆ†æä¹‹å †å¤–å†…å­˜"><!---->è°ƒè¯•æ’é”™ - Java å†…å­˜åˆ†æä¹‹å †å¤–å†…å­˜<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-jvm-thread-dump.html" aria-label="è°ƒè¯•æ’é”™ - Java çº¿ç¨‹åˆ†æä¹‹çº¿ç¨‹Dumpåˆ†æ"><!---->è°ƒè¯•æ’é”™ - Java çº¿ç¨‹åˆ†æä¹‹çº¿ç¨‹Dumpåˆ†æ<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-jvm-oom-tool.html" aria-label="è°ƒè¯•æ’é”™ - Java é—®é¢˜æ’æŸ¥ä¹‹JVMå¯è§†åŒ–å·¥å…·"><!---->è°ƒè¯•æ’é”™ - Java é—®é¢˜æ’æŸ¥ä¹‹JVMå¯è§†åŒ–å·¥å…·<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-jvm-agent-arthas.html" aria-label="è°ƒè¯•æ’é”™ - Java é—®é¢˜æ’æŸ¥ä¹‹åº”ç”¨åœ¨çº¿è°ƒè¯•Arthas"><!---->è°ƒè¯•æ’é”™ - Java é—®é¢˜æ’æŸ¥ä¹‹åº”ç”¨åœ¨çº¿è°ƒè¯•Arthas<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-jvm-agent-arthas-problem.html" aria-label="è°ƒè¯•æ’é”™ - Arthas é‡åˆ°çš„é—®é¢˜"><!---->è°ƒè¯•æ’é”™ - Arthas é‡åˆ°çš„é—®é¢˜<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-jvm-debug-idea.html" aria-label="è°ƒè¯•æ’é”™ - Java é—®é¢˜æ’æŸ¥ä¹‹ä½¿ç”¨IDEAæœ¬åœ°è°ƒè¯•å’Œè¿œç¨‹è°ƒè¯•"><!---->è°ƒè¯•æ’é”™ - Java é—®é¢˜æ’æŸ¥ä¹‹ä½¿ç”¨IDEAæœ¬åœ°è°ƒè¯•å’Œè¿œç¨‹è°ƒè¯•<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-jvm-agent-usage.html" aria-label="è°ƒè¯•æ’é”™ - JavaåŠ¨æ€è°ƒè¯•æŠ€æœ¯åŸç†"><!---->è°ƒè¯•æ’é”™ - JavaåŠ¨æ€è°ƒè¯•æŠ€æœ¯åŸç†<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-thread-x-lock-ReentrantLock.html" aria-label="JUCé”: ReentrantLockè¯¦è§£"><!---->JUCé”: ReentrantLockè¯¦è§£<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-jvm-gc-help.html" aria-label="GCä¸­å¯¹è±¡è‡ªæ•‘"><!---->GCä¸­å¯¹è±¡è‡ªæ•‘<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-jvm-gc-log.html" aria-label="gcæ—¥å¿—åˆ†æ"><!---->gcæ—¥å¿—åˆ†æ<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-jvm-optimization-size.html" aria-label="Javaå †è®¾ç½®å¤šå¤§åˆé€‚"><!---->Javaå †è®¾ç½®å¤šå¤§åˆé€‚<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-jvm-gc-adapter.html" aria-label="Javaå¦‚ä½•é€‰æ‹©åˆé€‚çš„åƒåœ¾å›æ”¶å™¨"><!---->Javaå¦‚ä½•é€‰æ‹©åˆé€‚çš„åƒåœ¾å›æ”¶å™¨<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-jvm-tools-overview.html" aria-label="JDKç›‘æ§å’Œæ•…éšœå¤„ç†å·¥å…·æ±‡æ€»"><!---->JDKç›‘æ§å’Œæ•…éšœå¤„ç†å·¥å…·æ±‡æ€»<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-jvm-optimization-jstack.html" aria-label="jstackç­‰å‘½ä»¤çš„å®ç°åŸç†"><!---->jstackç­‰å‘½ä»¤çš„å®ç°åŸç†<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-jvm-gc-dispatch.html" aria-label="JVM å†…å­˜åˆ†é…ä¸å›æ”¶"><!---->JVM å†…å­˜åˆ†é…ä¸å›æ”¶<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-jvm-tools-visualvm.html" aria-label="macç‰ˆideaé…ç½®visualvm"><!---->macç‰ˆideaé…ç½®visualvm<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-jvm-tools-mat-use.html" aria-label="MATä½¿ç”¨"><!---->MATä½¿ç”¨<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-jvm-tools-mat.html" aria-label="MATå®‰è£…"><!---->MATå®‰è£…<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-jvm-tools-mat-shallow.html" aria-label="Shallow heapå’ŒRetained heap"><!---->Shallow heapå’ŒRetained heap<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-jvm-classload-tomcat.html" aria-label="tomcatç±»åŠ è½½å™¨"><!---->tomcatç±»åŠ è½½å™¨<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-jvm-gc-overview.html" aria-label="åƒåœ¾æ”¶é›†å™¨"><!---->åƒåœ¾æ”¶é›†å™¨<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-jvm-gc-orth.html" aria-label="åƒåœ¾æ”¶é›†å™¨åƒåœ¾æ”¶é›†ç®—æ³•"><!---->åƒåœ¾æ”¶é›†å™¨åƒåœ¾æ”¶é›†ç®—æ³•<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-jvm-optimization.html" aria-label="å¦‚ä½•åˆç†çš„è§„åˆ’ JVM æ€§èƒ½è°ƒä¼˜"><!---->å¦‚ä½•åˆç†çš„è§„åˆ’ JVM æ€§èƒ½è°ƒä¼˜<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-jvm-gc-object-die.html" aria-label="å¯¹è±¡å·²ç»æ­»äº¡ï¼Ÿ"><!---->å¯¹è±¡å·²ç»æ­»äº¡ï¼Ÿ<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-jvm-classload1.html" aria-label="ç±»åŠ è½½å™¨"><!---->ç±»åŠ è½½å™¨<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-jvm-classload-interview.html" aria-label="ç±»åŠ è½½å™¨ï¼ˆå¸¸è§é¢è¯•ï¼‰"><!---->ç±»åŠ è½½å™¨ï¼ˆå¸¸è§é¢è¯•ï¼‰<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/jvm.html" aria-label="ç±»åŠ è½½è¿‡ç¨‹"><!---->ç±»åŠ è½½è¿‡ç¨‹<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-jvm-classload-simplify.html" aria-label="ç±»åŠ è½½è¿‡ç¨‹(ç²¾ç®€ç‰ˆ)"><!---->ç±»åŠ è½½è¿‡ç¨‹(ç²¾ç®€ç‰ˆ)<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-jvm-gc-fullgc.html" aria-label="çº¿ä¸Šå¦‚ä½•æ’æŸ¥FullGC(ç³»ç»Ÿ CPU çªç„¶é£™å‡ä¸” GC é¢‘ç¹ï¼Œä½ è¯¥å¦‚ä½•æ’æŸ¥)"><!---->çº¿ä¸Šå¦‚ä½•æ’æŸ¥FullGC(ç³»ç»Ÿ CPU çªç„¶é£™å‡ä¸” GC é¢‘ç¹ï¼Œä½ è¯¥å¦‚ä½•æ’æŸ¥)<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-jvm-tools-mat-peoject.html" aria-label="è®°ä¸€æ¬¡MATåˆ†æçº¿ä¸Šé¡¹ç›®è¿‡ç¨‹"><!---->è®°ä¸€æ¬¡MATåˆ†æçº¿ä¸Šé¡¹ç›®è¿‡ç¨‹<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-jvm-debug-tools-linux.html" aria-label="è°ƒè¯•æ’é”™ - Java é—®é¢˜æ’æŸ¥ä¹‹Linuxå‘½ä»¤"><!---->è°ƒè¯•æ’é”™ - Java é—®é¢˜æ’æŸ¥ä¹‹Linuxå‘½ä»¤<!----></a></li><li><a class="route-link auto-link vp-sidebar-link vp-sidebar-page" href="/posts/Java/JavaJVM/java-jvm-debug-tools-list.html" aria-label="è°ƒè¯•æ’é”™ - Java é—®é¢˜æ’æŸ¥ä¹‹å·¥å…·å•"><!---->è°ƒè¯•æ’é”™ - Java é—®é¢˜æ’æŸ¥ä¹‹å·¥å…·å•<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Java8ç‰¹æ€§</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Javaå¤šçº¿ç¨‹</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Javaæ¡†æ¶</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Javaç¬¬ä¸‰æ–¹ä¾èµ–</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Javaç¼–è¯‘</span><span class="vp-arrow end"></span></button><!----></section></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->GC - Java åƒåœ¾å›æ”¶å™¨ä¹‹G1ï¼ˆè¡¥å……ï¼‰</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://mrjackc.github.io" target="_blank" rel="noopener noreferrer">MrJason</a></span><span property="author" content="MrJason"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-10-21T07:03:09.000Z"></span><span class="page-pageview-info" aria-label="è®¿é—®é‡ğŸ”¢" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon eye-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="eye icon" name="eye"><path d="M992 512.096c0-5.76-.992-10.592-1.28-11.136-.192-2.88-1.152-8.064-2.08-10.816-.256-.672-.544-1.376-.832-2.08-.48-1.568-1.024-3.104-1.6-4.32C897.664 290.112 707.104 160 512 160c-195.072 0-385.632 130.016-473.76 322.592-1.056 2.112-1.792 4.096-2.272 5.856a55.512 55.512 0 00-.64 1.6c-1.76 5.088-1.792 8.64-1.632 7.744-.832 3.744-1.568 11.168-1.568 11.168-.224 2.272-.224 4.032.032 6.304 0 0 .736 6.464 1.088 7.808.128 1.824.576 4.512 1.12 6.976h-.032c.448 2.08 1.12 4.096 1.984 6.08.48 1.536.992 2.976 1.472 4.032C126.432 733.856 316.992 864 512 864c195.136 0 385.696-130.048 473.216-321.696 1.376-2.496 2.24-4.832 2.848-6.912.256-.608.48-1.184.672-1.728 1.536-4.48 1.856-8.32 1.728-8.32l-.032.032c.608-3.104 1.568-7.744 1.568-13.28zM512 672c-88.224 0-160-71.776-160-160s71.776-160 160-160 160 71.776 160 160-71.776 160-160 160z"></path></svg><span id="ArtalkPV" class="vp-pageview waline-pageview-count" data-path="/posts/Java/JavaJVM/java-jvm-gc-g1-supplement.html" data-page-key="/posts/Java/JavaJVM/java-jvm-gc-g1-supplement.html">...</span></span><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 21 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT21M"></span><span class="page-category-info" aria-label="åˆ†ç±»ğŸŒˆ" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color8 clickable" role="navigation">Java</span><span class="page-category-item color7 clickable" role="navigation">JVM</span><!--]--><meta property="articleSection" content="Java,JVM"></span><!----></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!----><div class="vp-toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_1-å‰è¨€">1. å‰è¨€</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-1-g1-ä¼˜åŠ¿">1.1. G1 ä¼˜åŠ¿</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_1-2-ä¸cmsä¸åŒç‚¹">1.2 ä¸CMSä¸åŒç‚¹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_2-æ¦‚è§ˆ">2. æ¦‚è§ˆ</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-1-åˆ†åŒºregion-å„åŒºæ¯”ä¾‹">2.1 åˆ†åŒºregion å„åŒºæ¯”ä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-2-ä¸ºä»€ä¹ˆå«g1-å…¨å±€å¹¶å‘æ ‡è®°-ä¼˜å…ˆå›æ”¶">2.2 ä¸ºä»€ä¹ˆå«G1ï¼ˆå…¨å±€å¹¶å‘æ ‡è®°-&gt;ä¼˜å…ˆå›æ”¶ï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_2-3-æš‚åœé¢„æµ‹æ¨¡å‹">2.3 æš‚åœé¢„æµ‹æ¨¡å‹</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_3-g1ä¸­çš„region">3. G1ä¸­çš„Region</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_4-g1ä¸­çš„gcæ”¶é›†">4. G1ä¸­çš„GCæ”¶é›†</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_5-ygc">5.YGC</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_5-1-ygcå¼€å§‹">5.1 YGCå¼€å§‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_5-2-ygcç»“æŸ">5.2 YGCç»“æŸ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_5-3-ygcæ˜¯å¦éœ€è¦æ‰«ææ•´ä¸ªè€å¹´ä»£-rset">5.3 YGCæ˜¯å¦éœ€è¦æ‰«ææ•´ä¸ªè€å¹´ä»£ï¼ŸRset</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_6-mixgc">6. MIXGC</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_6-1-å…¨å±€å¹¶å‘æ ‡è®°">6.1 å…¨å±€å¹¶å‘æ ‡è®°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_6-2-å…¨å±€å¹¶å‘æ ‡è®°æ€»ç»“">6.2 å…¨å±€å¹¶å‘æ ‡è®°æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_6-3-stab-ç»´æŒå¹¶å‘gcçš„æ­£ç¡®æ€§">6.3 STABï¼ˆç»´æŒå¹¶å‘GCçš„æ­£ç¡®æ€§ï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_6-4-stabå…·ä½“ç»†èŠ‚">6.4 STABå…·ä½“ç»†èŠ‚</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_7-g1å‘½ä»¤è¡Œé€‰é¡¹ä¸æœ€ä½³å®è·µ">7. G1å‘½ä»¤è¡Œé€‰é¡¹ä¸æœ€ä½³å®è·µ</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_7-1-å‘½ä»¤è¡Œé€‰é¡¹">7.1 å‘½ä»¤è¡Œé€‰é¡¹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_7-2-æœ€ä½³å®è·µ">7.2 æœ€ä½³å®è·µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#_7-3-å®Œæ•´çš„g1-gcå¼€å…³åˆ—è¡¨">7.3 å®Œæ•´çš„G1 GCå¼€å…³åˆ—è¡¨</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#_8-æ€»ç»“">8. æ€»ç»“</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#å‚è€ƒæ–‡ç« ">å‚è€ƒæ–‡ç« </a></li><!----><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content"><h1 id="gc-java-åƒåœ¾å›æ”¶å™¨ä¹‹g1-è¡¥å……" tabindex="-1"><a class="header-anchor" href="#gc-java-åƒåœ¾å›æ”¶å™¨ä¹‹g1-è¡¥å……"><span>GC - Java åƒåœ¾å›æ”¶å™¨ä¹‹G1ï¼ˆè¡¥å……ï¼‰</span></a></h1><h2 id="_1-å‰è¨€" tabindex="-1"><a class="header-anchor" href="#_1-å‰è¨€"><span>1. å‰è¨€</span></a></h2><blockquote><p>G1:æ»¡è¶³é«˜ååé‡çš„åŒæ—¶æ»¡è¶³GCåœé¡¿çš„æ—¶é—´å°½å¯èƒ½çŸ­</p></blockquote><p>G1æ”¶é›†å™¨æ˜¯ä¸€æ¬¾åœ¨serverç«¯è¿è¡Œçš„åƒåœ¾æ”¶é›†å™¨ï¼Œä¸“é—¨é’ˆå¯¹äºæ‹¥æœ‰å¤šæ ¸å¤„ç†å™¨å’Œå¤§å†…å­˜çš„æœºå™¨ï¼Œåœ¨JDK 7u4ç‰ˆæœ¬å‘è¡Œæ—¶è¢«æ­£å¼æ¨å‡ºï¼Œåœ¨JDK9ä¸­æ›´è¢«æŒ‡å®šä¸ºå®˜æ–¹GCæ”¶é›†å™¨ã€‚<strong>å®ƒæ»¡è¶³é«˜ååé‡çš„åŒæ—¶æ»¡è¶³GCåœé¡¿çš„æ—¶é—´å°½å¯èƒ½çŸ­</strong>ã€‚</p><h3 id="_1-1-g1-ä¼˜åŠ¿" tabindex="-1"><a class="header-anchor" href="#_1-1-g1-ä¼˜åŠ¿"><span>1.1. G1 ä¼˜åŠ¿</span></a></h3><p>G1æ”¶é›†å™¨ä¸“é—¨é’ˆå¯¹ä»¥ä¸‹åº”ç”¨åœºæ™¯è®¾è®¡</p><ul><li>å¯ä»¥åƒCMSæ”¶é›†å™¨ä¸€æ ·å¯ä»¥å’Œåº”ç”¨å¹¶å‘è¿è¡Œ</li><li>å‹ç¼©ç©ºé—²çš„å†…å­˜ç¢ç‰‡ï¼Œå´ä¸éœ€è¦å†—é•¿çš„GCåœé¡¿</li><li>å¯¹GCåœé¡¿å¯ä»¥åšæ›´å¥½çš„é¢„æµ‹</li><li>ä¸æƒ³ç‰ºç‰²å¤§é‡çš„ååé‡æ€§èƒ½</li><li>ä¸éœ€è¦æ›´å¤§çš„Java Heap</li></ul><blockquote><p>Can operate concurrently with applications threads like the CMS collector.<br> Compact free space without lengthy GC induced pause times.<br> Need more predictable GC pause durations.<br> Do not want to sacrifice a lot of throughput performance.<br> Do not require a much larger Java heap.</p></blockquote><h3 id="_1-2-ä¸cmsä¸åŒç‚¹" tabindex="-1"><a class="header-anchor" href="#_1-2-ä¸cmsä¸åŒç‚¹"><span>1.2 ä¸CMSä¸åŒç‚¹</span></a></h3><p>G1ä»é•¿æœŸè®¡åˆ’æ¥çœ‹æ˜¯ä»¥å–ä»£CMSä¸ºç›®æ ‡ã€‚ä¸CMSç›¸æ¯”æœ‰å‡ ä¸ªä¸åŒç‚¹ä½¿å¾—G1æˆä¸ºGCçš„æ›´å¥½è§£å†³æ–¹æ¡ˆã€‚</p><ul><li>ç¬¬ä¸€ç‚¹ï¼šG1ä¼šå‹ç¼©ç©ºé—²å†…å­˜ä½¿ä¹‹è¶³å¤Ÿç´§å‡‘ï¼Œåšæ³•<strong>æ˜¯ç”¨regionsä»£æ›¿ç»†ç²’åº¦çš„ç©ºé—²åˆ—è¡¨è¿›è¡Œåˆ†é…</strong>ï¼Œå‡å°‘å†…å­˜ç¢ç‰‡çš„äº§ç”Ÿã€‚</li><li>ç¬¬äºŒç‚¹ï¼šG1çš„STWæ›´å¯æ§ï¼ŒG1åœ¨åœé¡¿æ—¶é—´ä¸Šæ·»åŠ äº†<strong>é¢„æµ‹æœºåˆ¶</strong>ï¼Œç”¨æˆ·å¯ä»¥æŒ‡å®šæœŸæœ›åœé¡¿æ—¶é—´ã€‚</li></ul><blockquote><p>G1 is planned as the long term replacement for the Concurrent Mark-Sweep Collector (CMS). Comparing G1 with CMS, there are differences that make G1 a better solution. One difference is that G1 is a compacting collector. G1 compacts sufficiently to completely avoid the use of fine-grained free lists for allocation, and instead relies on regions. This considerably simplifies parts of the collector, and mostly eliminates potential fragmentation issues. Also, G1 offers more predictable garbage collection pauses than the CMS collector, and allows users to specify desired pause targets.</p></blockquote><h2 id="_2-æ¦‚è§ˆ" tabindex="-1"><a class="header-anchor" href="#_2-æ¦‚è§ˆ"><span>2. æ¦‚è§ˆ</span></a></h2><p>åœ¨ä¼ ç»Ÿçš„GCæ”¶é›†å™¨(serial,parallel,CMS)æ— ä¸€ä¸ä¾‹å¤–éƒ½æŠŠheapåˆ†æˆå›ºå®šå¤§å°è¿ç»­çš„ä¸‰ä¸ªç©ºé—´ï¼šyoung generation, old generation, and permanent generation</p><figure><img src="https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202403120957681.png" alt="image-20221209111945943" tabindex="0" loading="lazy"><figcaption>image-20221209111945943</figcaption></figure><p>ä½†G1å´ç‹¬è¾Ÿè¹Šå¾„ï¼Œé‡‡ç”¨äº†ä¸€ç§å…¨æ–°çš„å†…å­˜å¸ƒå±€</p><figure><img src="https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202403120957719.png" alt="image-20221209112005861" tabindex="0" loading="lazy"><figcaption>image-20221209112005861</figcaption></figure><p>åœ¨G1ä¸­å †è¢«åˆ†æˆä¸€å—å—å¤§å°ç›¸ç­‰çš„heap regionï¼Œä¸€èˆ¬æœ‰2000å¤šå—ï¼Œè¿™äº›regionåœ¨é€»è¾‘ä¸Šæ˜¯è¿ç»­çš„ã€‚æ¯å—regionéƒ½ä¼šè¢«æ‰“å”¯ä¸€çš„åˆ†ä»£æ ‡å¿—(eden,survivor,old)ã€‚åœ¨é€»è¾‘ä¸Šï¼Œeden regionsæ„æˆEdenç©ºé—´ï¼Œsurvivor regionsæ„æˆSurvivorç©ºé—´ï¼Œold regionsæ„æˆäº†old ç©ºé—´ã€‚</p><h3 id="_2-1-åˆ†åŒºregion-å„åŒºæ¯”ä¾‹" tabindex="-1"><a class="header-anchor" href="#_2-1-åˆ†åŒºregion-å„åŒºæ¯”ä¾‹"><span>2.1 åˆ†åŒºregion å„åŒºæ¯”ä¾‹</span></a></h3><p>é€šè¿‡å‘½ä»¤è¡Œå‚æ•°</p><ul><li><code>-XX:NewRatio=n</code>æ¥é…ç½®æ–°ç”Ÿä»£ä¸è€å¹´ä»£çš„æ¯”ä¾‹ï¼Œé»˜è®¤ä¸º2ï¼Œå³æ¯”ä¾‹ä¸º2:1ï¼›</li><li><code>XX:SurvivorRatio=n</code>åˆ™å¯ä»¥é…ç½®Edenä¸Survivorçš„æ¯”ä¾‹ï¼Œé»˜è®¤ä¸º8ã€‚</li></ul><h3 id="_2-2-ä¸ºä»€ä¹ˆå«g1-å…¨å±€å¹¶å‘æ ‡è®°-ä¼˜å…ˆå›æ”¶" tabindex="-1"><a class="header-anchor" href="#_2-2-ä¸ºä»€ä¹ˆå«g1-å…¨å±€å¹¶å‘æ ‡è®°-ä¼˜å…ˆå›æ”¶"><span>2.2 ä¸ºä»€ä¹ˆå«G1ï¼ˆå…¨å±€å¹¶å‘æ ‡è®°-&gt;ä¼˜å…ˆå›æ”¶ï¼‰</span></a></h3><blockquote><p>å…¨å±€å¹¶å‘æ ‡è®°-&gt;å¯å›æ”¶å¯¹è±¡å¤š-&gt;ä¼˜å…ˆå›æ”¶</p></blockquote><p>GCæ—¶G1çš„è¿è¡Œæ–¹å¼ä¸CMSæ–¹å¼ç±»ä¼¼ï¼Œä¼šæœ‰ä¸€ä¸ªå…¨å±€å¹¶å‘æ ‡è®°(concurrent global marking phase)çš„è¿‡ç¨‹ï¼Œå»ç¡®å®šå †é‡Œå¯¹è±¡çš„çš„å­˜æ´»æƒ…å†µã€‚å¹¶å‘æ ‡è®°å®Œæˆä¹‹åï¼ŒG1çŸ¥é“å“ªäº›regionsç©ºé—²ç©ºé—´å¤š(å¯å›æ”¶å¯¹è±¡å¤š),ä¼˜å…ˆå›æ”¶è¿™äº›ç©ºçš„regionsï¼Œé‡Šæ”¾å‡ºå¤§é‡çš„ç©ºé—²ç©ºé—´ã€‚è¿™æ˜¯ä¸ºä»€ä¹ˆè¿™ç§åƒåœ¾å›æ”¶æ–¹å¼å«G1çš„åŸå› (Garbage-First)ã€‚</p><h3 id="_2-3-æš‚åœé¢„æµ‹æ¨¡å‹" tabindex="-1"><a class="header-anchor" href="#_2-3-æš‚åœé¢„æµ‹æ¨¡å‹"><span>2.3 æš‚åœé¢„æµ‹æ¨¡å‹</span></a></h3><p>G1å°†å…¶æ”¶é›†å’Œå‹ç¼©æ´»åŠ¨é›†ä¸­åœ¨å †ä¸­å¯èƒ½å……æ»¡å¯å›æ”¶å¯¹è±¡(å³åƒåœ¾)çš„åŒºåŸŸï¼Œä½¿ç”¨æš‚åœé¢„æµ‹æ¨¡å‹æ¥æ»¡è¶³ç”¨æˆ·å®šä¹‰çš„æš‚åœæ—¶é—´ç›®æ ‡ï¼Œå¹¶æ ¹æ®æŒ‡å®šçš„æš‚åœæ—¶é—´ç›®æ ‡é€‰æ‹©è¦æ”¶é›†çš„åŒºåŸŸæ•°é‡ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒG1ä¸æ˜¯å®æ—¶æ”¶é›†å™¨ã€‚å®ƒèƒ½å¤Ÿä»¥è¾ƒé«˜çš„æ¦‚ç‡æ»¡è¶³è®¾å®šçš„æš‚åœæ—¶é—´ç›®æ ‡ï¼Œä½†ä¸æ˜¯ç»å¯¹ç¡®å®šçš„ã€‚æ ¹æ®ä»¥å‰æ”¶é›†çš„æ•°æ®ï¼ŒG1ä¼°ç®—å‡ºåœ¨ç”¨æˆ·æŒ‡å®šçš„ç›®æ ‡æ—¶é—´å†…å¯ä»¥æ”¶é›†å¤šå°‘ä¸ªåŒºåŸŸã€‚å› æ­¤ï¼Œæ”¶é›†å™¨å¯¹äºæ”¶é›†åŒºåŸŸçš„æˆæœ¬æœ‰ä¸€ä¸ªç›¸å½“å‡†ç¡®çš„æ¨¡å‹ï¼Œå®ƒä½¿ç”¨è¿™ä¸ªæ¨¡å‹æ¥ç¡®å®šåœ¨æš‚åœæ—¶é—´ç›®æ ‡å†…æ”¶é›†å“ªäº›åŒºåŸŸå’Œæ”¶é›†å¤šå°‘åŒºåŸŸã€‚</p><blockquote><p>It is important to note that G1 is not a real-time collector. It meets the set pause time target with high probability but not absolute certainty. Based on data from previous collections, G1 does an estimate of how many regions can be collected within the user specified target time. Thus, the collector has a reasonably accurate model of the cost of collecting the regions, and it uses this model to determine which and how many regions to collect while staying within the pause time target.</p></blockquote><h2 id="_3-g1ä¸­çš„region" tabindex="-1"><a class="header-anchor" href="#_3-g1ä¸­çš„region"><span>3. G1ä¸­çš„Region</span></a></h2><p>G1ä¸­æ¯ä¸ªRegionå¤§å°æ˜¯å›ºå®šç›¸ç­‰çš„ï¼ŒRegionçš„å¤§å°å¯ä»¥é€šè¿‡å‚æ•°-XX:G1HeapRegionSizeè®¾å®šï¼Œå–å€¼èŒƒå›´ä»1Måˆ°32Mï¼Œä¸”æ˜¯2çš„æŒ‡æ•°ã€‚å¦‚æœä¸è®¾å®šï¼Œé‚£ä¹ˆG1ä¼šæ ¹æ®Heapå¤§å°è‡ªåŠ¨å†³å®šã€‚</p><p>å†³å®šé€»è¾‘:</p><p><code>size =ï¼ˆå †æœ€å°å€¼+å †æœ€å¤§å€¼ï¼‰/ TARGET_REGION_NUMBER(2048)</code> ï¼Œç„¶åsizeå–æœ€é è¿‘2çš„å¹‚æ¬¡æ•°å€¼ï¼Œ å¹¶å°†sizeæ§åˆ¶åœ¨[1M,32M]ä¹‹é—´ã€‚å…·ä½“ä»£ç å¦‚ä¸‹</p><div class="language-cpp line-numbers-mode" data-ext="cpp" data-title="cpp"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// share/vm/gc_implementation/g1/heapRegion.cpp</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// Minimum region size; we won&#39;t go lower than that.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// We might want to decrease this in the future, to deal with small</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// heaps a bit more efficiently.</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">#define</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> MIN_REGION_SIZE</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  (      1024 * 1024 )</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// Maximum region size; we don&#39;t go higher than that. There&#39;s a good</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// reason for having an upper bound. We don&#39;t want regions to get too</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// large, otherwise cleanup&#39;s effectiveness would decrease as there</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// will be fewer opportunities to find totally empty regions after</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// marking.</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">#define</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> MAX_REGION_SIZE</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  ( 32 * 1024 * 1024 )</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// The automatic region size calculation will try to have around this</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// many regions in the heap (based on the min heap size).</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">#define</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> TARGET_REGION_NUMBER</span><span style="color:#D19A66;--shiki-dark:#D19A66;">          2048</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">void</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> HeapRegion</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">::</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">setup_heap_region_size</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#C678DD;--shiki-dark:#C678DD;">size_t</span><span style="color:#E06C75;font-style:italic;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> initial_heap_size</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#C678DD;--shiki-dark:#C678DD;">size_t</span><span style="color:#E06C75;font-style:italic;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> max_heap_size</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  uintx region_size </span><span style="color:#C678DD;--shiki-dark:#C678DD;">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> G1HeapRegionSize;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">  if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">FLAG_IS_DEFAULT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(G1HeapRegionSize)) {</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    size_t</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> average_heap_size </span><span style="color:#C678DD;--shiki-dark:#C678DD;">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (initial_heap_size </span><span style="color:#C678DD;--shiki-dark:#C678DD;">+</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> max_heap_size) </span><span style="color:#C678DD;--shiki-dark:#C678DD;">/</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    region_size </span><span style="color:#C678DD;--shiki-dark:#C678DD;">=</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> MAX2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(average_heap_size </span><span style="color:#C678DD;--shiki-dark:#C678DD;">/</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> TARGET_REGION_NUMBER,</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">                       (uintx) MIN_REGION_SIZE);</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">  int</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> region_size_log </span><span style="color:#C678DD;--shiki-dark:#C678DD;">=</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> log2_long</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">((jlong) region_size);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // Recalculate the region size to make sure it&#39;s a power of</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // 2. This means that region_size is the largest power of 2 that&#39;s</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // &lt;= what we&#39;ve calculated so far.</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  region_size </span><span style="color:#C678DD;--shiki-dark:#C678DD;">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ((uintx)</span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> &lt;&lt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> region_size_log);</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // Now make sure that we don&#39;t go over or under our limits.</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">  if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (region_size </span><span style="color:#C678DD;--shiki-dark:#C678DD;">&lt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> MIN_REGION_SIZE) {</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    region_size </span><span style="color:#C678DD;--shiki-dark:#C678DD;">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> MIN_REGION_SIZE;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  } </span><span style="color:#C678DD;--shiki-dark:#C678DD;">else</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (region_size </span><span style="color:#C678DD;--shiki-dark:#C678DD;">&gt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> MAX_REGION_SIZE) {</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    region_size </span><span style="color:#C678DD;--shiki-dark:#C678DD;">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> MAX_REGION_SIZE;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-g1ä¸­çš„gcæ”¶é›†" tabindex="-1"><a class="header-anchor" href="#_4-g1ä¸­çš„gcæ”¶é›†"><span>4. G1ä¸­çš„GCæ”¶é›†</span></a></h2><p><strong>G1ä¿ç•™äº†YGCå¹¶åŠ ä¸Šäº†ä¸€ç§å…¨æ–°çš„MIXGCç”¨äºæ”¶é›†è€å¹´ä»£ã€‚G1ä¸­æ²¡æœ‰Full GCï¼ŒG1ä¸­çš„Full GCæ˜¯é‡‡ç”¨serial old Full GCã€‚</strong></p><blockquote><p>Q:ç†è§£ä¸äº†â€œG1ä¸­æ²¡æœ‰Full GCï¼ŒG1ä¸­çš„Full GCæ˜¯é‡‡ç”¨serial old Full GCã€‚â€œè¿™å¥è¯ï¼Œä¸æ˜¯è¯´æ²¡æœ‰Full GCå—</p><p>A1: G1ä¸­å®é™…æ˜¯æœ‰full gcçš„åªæ˜¯éå¸¸æ…¢ï¼Œæ‰€ä»¥g1çš„ä¼˜åŒ–ç›®æ ‡æ˜¯å°½é‡é¿å…full gcï¼Œå› æ­¤æ‰æœ‰å¦‚ä¸Šè¯´æ³•</p><p>A2:å¦‚æœmixed GCå®åœ¨æ— æ³•è·Ÿä¸Šç¨‹åºåˆ†é…å†…å­˜çš„é€Ÿåº¦ï¼Œå¯¼è‡´old genå¡«æ»¡æ— æ³•ç»§ç»­è¿›è¡Œmixed GCï¼Œå°±ä¼šåˆ‡æ¢åˆ°&quot;G1ä¹‹å¤–çš„serial old GC&quot;æ¥æ”¶é›†æ•´ä¸ªGC heapï¼ˆæ³¨æ„ï¼ŒåŒ…æ‹¬youngã€oldã€permï¼‰ã€‚è¿™æ‰æ˜¯çœŸæ­£çš„full GCã€‚Full GCä¹‹æ‰€ä»¥å«fullå°±æ˜¯è¦æ”¶é›†æ•´ä¸ªå †ï¼Œåªé€‰æ‹©old gençš„éƒ¨åˆ†regionç®—ä¸ä¸Šfull GCã€‚è¿›å…¥è¿™ç§çŠ¶æ€çš„G1å°±è·Ÿ-XX:+UseSerialGCçš„full GCä¸€æ ·</p></blockquote><h2 id="_5-ygc" tabindex="-1"><a class="header-anchor" href="#_5-ygc"><span>5.YGC</span></a></h2><p>å½“Edenç©ºé—´è¢«å æ»¡ä¹‹åï¼Œå°±ä¼šè§¦å‘YGCã€‚åœ¨G1ä¸­YGCä¾ç„¶é‡‡ç”¨å¤åˆ¶å­˜æ´»å¯¹è±¡åˆ°survivorç©ºé—´çš„æ–¹å¼ï¼Œå½“å¯¹è±¡çš„å­˜æ´»å¹´é¾„æ»¡è¶³æ™‹å‡æ¡ä»¶æ—¶ï¼ŒæŠŠå¯¹è±¡æå‡åˆ°old generation regions(è€å¹´ä»£)ã€‚</p><p>G1æ§åˆ¶YGCå¼€é”€çš„æ‰‹æ®µæ˜¯åŠ¨æ€æ”¹å˜young regionçš„ä¸ªæ•°ï¼ŒYGCçš„è¿‡ç¨‹ä¸­ä¾ç„¶ä¼šSTW(stop the world åº”ç”¨åœé¡¿)ï¼Œå¹¶é‡‡ç”¨å¤šçº¿ç¨‹å¹¶å‘å¤åˆ¶å¯¹è±¡ï¼Œå‡å°‘GCåœé¡¿æ—¶é—´ã€‚</p><h3 id="_5-1-ygcå¼€å§‹" tabindex="-1"><a class="header-anchor" href="#_5-1-ygcå¼€å§‹"><span>5.1 YGCå¼€å§‹</span></a></h3><figure><img src="https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202403120957748.png" alt="image-20221209113334611" tabindex="0" loading="lazy"><figcaption>image-20221209113334611</figcaption></figure><h3 id="_5-2-ygcç»“æŸ" tabindex="-1"><a class="header-anchor" href="#_5-2-ygcç»“æŸ"><span>5.2 YGCç»“æŸ</span></a></h3><figure><img src="https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202403120957778.png" alt="image-20221209113401283" tabindex="0" loading="lazy"><figcaption>image-20221209113401283</figcaption></figure><p>æˆ‘ä»¬ä»å›¾ä¸­çœ‹åˆ°EdenåŒºä¸­å­˜æ´»å¯¹è±¡è¢«å¤åˆ¶åˆ°æ–°çš„SurvioråŒºã€‚</p><h3 id="_5-3-ygcæ˜¯å¦éœ€è¦æ‰«ææ•´ä¸ªè€å¹´ä»£-rset" tabindex="-1"><a class="header-anchor" href="#_5-3-ygcæ˜¯å¦éœ€è¦æ‰«ææ•´ä¸ªè€å¹´ä»£-rset"><span>5.3 YGCæ˜¯å¦éœ€è¦æ‰«ææ•´ä¸ªè€å¹´ä»£ï¼ŸRset</span></a></h3><p>æˆ‘ä»¬çŸ¥é“åˆ¤æ–­å¯¹è±¡æ˜¯å¦å­˜æ´»éœ€è¦ä»GC ROOTSç»“ç‚¹å‡ºå‘ï¼Œä»GC ROOTSç»“ç‚¹å¯è¾¾çš„å¯¹è±¡å°±æ˜¯å­˜æ´»çš„ã€‚åœ¨YGCæ—¶ï¼Œè€å¹´ä»£ä¸­çš„å¯¹è±¡æ˜¯ä¸å›æ”¶çš„ï¼Œä¹Ÿå°±æ„å‘³ç€GC ROOTSé‡Œé¢åº”åŒ…å«äº†è€å¹´ä»£ä¸­çš„å¯¹è±¡ã€‚<strong>ä½†æ‰«ææ•´ä¸ªè€å¹´ä»£ä¼šå¾ˆè€—è´¹æ—¶é—´ï¼ŒåŠ¿å¿…å½±å“æ•´ä¸ªGCçš„æ€§èƒ½ï¼</strong>ã€‚æ‰€ä»¥åœ¨CMSä¸­ä½¿ç”¨äº†Card Tableçš„ç»“æ„ï¼Œé‡Œé¢è®°å½•äº†è€å¹´ä»£å¯¹è±¡åˆ°æ–°ç”Ÿä»£å¼•ç”¨ã€‚**Card Tableçš„ç»“æ„æ˜¯ä¸€ä¸ªè¿ç»­çš„byte[]æ•°ç»„ï¼Œæ‰«æCard Tableçš„æ—¶é—´æ¯”æ‰«ææ•´ä¸ªè€å¹´ä»£çš„ä»£ä»·è¦å°å¾ˆå¤šï¼G1ä¹Ÿå‚ç…§äº†è¿™ä¸ªæ€è·¯ï¼Œä¸è¿‡é‡‡ç”¨äº†ä¸€ç§æ–°çš„æ•°æ®ç»“æ„ Remembered Set ç®€ç§°Rsetã€‚**RSetè®°å½•äº†å…¶ä»–Regionä¸­çš„å¯¹è±¡å¼•ç”¨æœ¬Regionä¸­å¯¹è±¡çš„å…³ç³»ï¼Œå±äºpoints-intoç»“æ„ï¼ˆè°å¼•ç”¨äº†æˆ‘çš„å¯¹è±¡ï¼‰ã€‚è€ŒCard Tableåˆ™æ˜¯ä¸€ç§points-outï¼ˆæˆ‘å¼•ç”¨äº†è°çš„å¯¹è±¡ï¼‰çš„ç»“æ„ï¼Œæ¯ä¸ªCard è¦†ç›–ä¸€å®šèŒƒå›´çš„Heapï¼ˆä¸€èˆ¬ä¸º512Bytesï¼‰ã€‚G1çš„RSetæ˜¯åœ¨Card Tableçš„åŸºç¡€ä¸Šå®ç°çš„ï¼šæ¯ä¸ªRegionä¼šè®°å½•ä¸‹åˆ«çš„Regionæœ‰æŒ‡å‘è‡ªå·±çš„æŒ‡é’ˆï¼Œå¹¶æ ‡è®°è¿™äº›æŒ‡é’ˆåˆ†åˆ«åœ¨å“ªäº›Cardçš„èŒƒå›´å†…ã€‚ è¿™ä¸ªRSetå…¶å®æ˜¯ä¸€ä¸ªHash Tableï¼ŒKeyæ˜¯åˆ«çš„Regionçš„èµ·å§‹åœ°å€ï¼ŒValueæ˜¯ä¸€ä¸ªé›†åˆï¼Œé‡Œé¢çš„å…ƒç´ æ˜¯Card Tableçš„Indexã€‚<strong>æ¯ä¸ªRegionéƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„Rset</strong>ã€‚</p><figure><img src="https://cdn.jsdelivr.net/gh/MrJackC/PicGoImages/other/202403120957806.png" alt="image-20221209140929589" tabindex="0" loading="lazy"><figcaption>image-20221209140929589</figcaption></figure><p>RSetç©¶ç«Ÿæ˜¯æ€ä¹ˆè¾…åŠ©GCçš„å‘¢ï¼Ÿåœ¨åšYGCçš„æ—¶å€™ï¼Œåªéœ€è¦é€‰å®šyoung generation regionçš„RSetä½œä¸ºæ ¹é›†ï¼Œè¿™äº›RSetè®°å½•äº†<code>old-&gt;young</code>çš„è·¨ä»£å¼•ç”¨ï¼Œé¿å…äº†æ‰«ææ•´ä¸ªold generationã€‚ è€Œmixed gcçš„æ—¶å€™ï¼Œold generationä¸­è®°å½•äº†<code>old-&gt;old</code>çš„RSetï¼Œ<code>young-&gt;old</code>çš„å¼•ç”¨ç”±æ‰«æå…¨éƒ¨young generation regionå¾—åˆ°ï¼Œè¿™æ ·ä¹Ÿä¸ç”¨æ‰«æå…¨éƒ¨old generation regionã€‚æ‰€ä»¥RSetçš„å¼•å…¥å¤§å¤§å‡å°‘äº†GCçš„å·¥ä½œé‡ã€‚</p><p><strong>æ‰€ä»¥G1ä¸­YGCä¸éœ€è¦æ‰«ææ•´ä¸ªè€å¹´ä»£ï¼Œåªéœ€è¦æ‰«æRsetå°±å¯ä»¥çŸ¥é“è€å¹´ä»£å¼•ç”¨äº†å“ªäº›æ–°ç”Ÿä»£ä¸­çš„å¯¹è±¡ã€‚</strong></p><h2 id="_6-mixgc" tabindex="-1"><a class="header-anchor" href="#_6-mixgc"><span>6. MIXGC</span></a></h2><p>G1ä¸­çš„MIXGCé€‰å®šæ‰€æœ‰æ–°ç”Ÿä»£é‡Œçš„Regionï¼Œå¤–åŠ æ ¹æ®global concurrent markingç»Ÿè®¡å¾—å‡ºæ”¶é›†æ”¶ç›Šé«˜çš„è‹¥å¹²è€å¹´ä»£Regionï¼Œåœ¨ç”¨æˆ·æŒ‡å®šçš„å¼€é”€ç›®æ ‡èŒƒå›´å†…å°½å¯èƒ½é€‰æ‹©æ”¶ç›Šé«˜çš„è€å¹´ä»£Regionè¿›è¡Œå›æ”¶ã€‚æ‰€ä»¥MIXGCå›æ”¶çš„å†…å­˜åŒºåŸŸæ˜¯æ–°ç”Ÿä»£+è€å¹´ä»£ã€‚</p><p>åœ¨ä»‹ç»MIXGCä¹‹å‰æˆ‘ä»¬éœ€è¦å…ˆäº†è§£global concurrent markingï¼Œå…¨å±€å¹¶å‘æ ‡è®°ã€‚å› ä¸ºè€å¹´ä»£å›æ”¶è¦ä¾èµ–è¯¥è¿‡ç¨‹ã€‚</p><h3 id="_6-1-å…¨å±€å¹¶å‘æ ‡è®°" tabindex="-1"><a class="header-anchor" href="#_6-1-å…¨å±€å¹¶å‘æ ‡è®°"><span>6.1 å…¨å±€å¹¶å‘æ ‡è®°</span></a></h3><p>å…¨å±€å¹¶å‘æ ‡è®°è¿‡ç¨‹åˆ†ä¸ºäº”ä¸ªé˜¶æ®µ</p><p>(1) Initial Markåˆå§‹æ ‡è®° STW</p><p>Initial Markåˆå§‹æ ‡è®°æ˜¯ä¸€ä¸ªSTWäº‹ä»¶ï¼Œå…¶å®Œæˆå·¥ä½œæ˜¯æ ‡è®°GC ROOTS ç›´æ¥å¯è¾¾çš„å¯¹è±¡ã€‚å¹¶å°†å®ƒä»¬çš„å­—æ®µå‹å…¥æ‰«ææ ˆï¼ˆmarking stackï¼‰ä¸­ç­‰åˆ°åç»­æ‰«æã€‚G1ä½¿ç”¨å¤–éƒ¨çš„bitmapæ¥è®°å½•markä¿¡æ¯ï¼Œè€Œä¸ä½¿ç”¨å¯¹è±¡å¤´çš„mark wordé‡Œçš„mark bitã€‚å› ä¸º STWï¼Œæ‰€ä»¥é€šå¸¸YGCçš„æ—¶å€™å€Ÿç”¨YGCçš„STWé¡ºä¾¿å¯åŠ¨Initial Markï¼Œä¹Ÿå°±æ˜¯å¯åŠ¨å…¨å±€å¹¶å‘æ ‡è®°ï¼Œå…¨å±€å¹¶å‘æ ‡è®°ä¸YGCåœ¨é€»è¾‘ä¸Šç‹¬ç«‹ã€‚</p><blockquote><p>(1) Initial Mark<br> *(Stop the World Event)*This is a stop the world event. With G1, it is piggybacked on a normal young GC. Mark survivor regions (root regions) which may have references to objects in old generation.</p></blockquote><p>(2)Root Region Scanning æ ¹åŒºåŸŸæ‰«æ</p><p>æ ¹åŒºåŸŸæ‰«ææ˜¯ä»SurvioråŒºçš„å¯¹è±¡å‡ºå‘ï¼Œæ ‡è®°è¢«å¼•ç”¨åˆ°è€å¹´ä»£ä¸­çš„å¯¹è±¡ï¼Œå¹¶æŠŠå®ƒä»¬çš„å­—æ®µåœ¨å‹å…¥æ‰«ææ ˆï¼ˆmarking stackï¼‰ä¸­ç­‰åˆ°åç»­æ‰«æã€‚ä¸Initial Markä¸ä¸€æ ·çš„æ˜¯ï¼ŒRoot Region Scanningä¸éœ€è¦STWä¸åº”ç”¨ç¨‹åºæ˜¯å¹¶å‘è¿è¡Œã€‚Root Region Scanningå¿…é¡»åœ¨YGCå¼€å§‹å‰å®Œæˆã€‚</p><blockquote><p>(2) Root Region Scanning<br> Scan survivor regions for references into the old generation. This happens while the application continues to run. The phase must be completed before a young GC can occur.</p></blockquote><p>(3)Concurrent Marking å¹¶å‘æ ‡è®°</p><p>ä¸éœ€è¦STWã€‚ä¸æ–­ä»æ‰«ææ ˆå–å‡ºå¼•ç”¨é€’å½’æ‰«ææ•´ä¸ªå †é‡Œçš„å¯¹è±¡ã€‚æ¯æ‰«æåˆ°ä¸€ä¸ªå¯¹è±¡å°±ä¼šå¯¹å…¶æ ‡è®°ï¼Œå¹¶å°†å…¶å­—æ®µå‹å…¥æ‰«ææ ˆã€‚é‡å¤æ‰«æè¿‡ç¨‹ç›´åˆ°æ‰«ææ ˆæ¸…ç©ºã€‚è¿‡ç¨‹ä¸­è¿˜ä¼šæ‰«æSATB write barrieræ‰€è®°å½•ä¸‹çš„å¼•ç”¨ã€‚Concurrent Marking å¯ä»¥è¢«YGCä¸­æ–­</p><blockquote><p>(3) Concurrent Marking<br> Find live objects over the entire heap. This happens while the application is running. This phase can be interrupted by young generation garbage collections.</p></blockquote><p>(4)Remark æœ€ç»ˆæ ‡è®° STW</p><p>STWæ“ä½œã€‚åœ¨å®Œæˆå¹¶å‘æ ‡è®°åï¼Œæ¯ä¸ªJavaçº¿ç¨‹è¿˜ä¼šæœ‰ä¸€äº›å‰©ä¸‹çš„SATB write barrierè®°å½•çš„å¼•ç”¨å°šæœªå¤„ç†ã€‚è¿™ä¸ªé˜¶æ®µå°±è´Ÿè´£æŠŠå‰©ä¸‹çš„å¼•ç”¨å¤„ç†å®Œã€‚åŒæ—¶è¿™ä¸ªé˜¶æ®µä¹Ÿè¿›è¡Œå¼±å¼•ç”¨å¤„ç†ï¼ˆreference processingï¼‰ã€‚æ³¨æ„è¿™ä¸ªæš‚åœä¸CMSçš„remarkæœ‰ä¸€ä¸ªæœ¬è´¨ä¸Šçš„åŒºåˆ«ï¼Œé‚£å°±æ˜¯è¿™ä¸ªæš‚åœåªéœ€è¦æ‰«æSATB bufferï¼Œè€ŒCMSçš„remarkéœ€è¦é‡æ–°æ‰«æmod-union tableé‡Œçš„dirty cardå¤–åŠ æ•´ä¸ªæ ¹é›†åˆï¼Œè€Œæ­¤æ—¶æ•´ä¸ªyoung genï¼ˆä¸ç®¡å¯¹è±¡æ­»æ´»ï¼‰éƒ½ä¼šè¢«å½“ä½œæ ¹é›†åˆçš„ä¸€éƒ¨åˆ†ï¼Œå› è€ŒCMS remarkæœ‰å¯èƒ½ä¼šéå¸¸æ…¢ã€‚</p><blockquote><p>(4) Remark<br> Completes the marking of live object in the heap. Uses an algorithm called snapshot-at-the-beginning (SATB) which is much faster than what was used in the CMS collector.</p></blockquote><p>(5)Cleanup æ¸…é™¤ STW AND <em>Concurrent</em></p><p>STWæ“ä½œï¼Œæ¸…ç‚¹å‡ºæœ‰å­˜æ´»å¯¹è±¡çš„Regionå’Œæ²¡æœ‰å­˜æ´»å¯¹è±¡çš„Region(Empty Region)</p><p>STWæ“ä½œï¼Œæ›´æ–°Rset</p><p>Concurrentæ“ä½œï¼ŒæŠŠEmpty Regionæ”¶é›†èµ·æ¥åˆ°å¯åˆ†é…Regioné˜Ÿåˆ—ã€‚</p><blockquote><p>(5) Cleanup<br> Performs accounting on live objects and completely free regions. (Stop the world)<br> Scrubs the Remembered Sets. (Stop the world)<br> Reset the empty regions and return them to the free list. (Concurrent)</p></blockquote><h3 id="_6-2-å…¨å±€å¹¶å‘æ ‡è®°æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#_6-2-å…¨å±€å¹¶å‘æ ‡è®°æ€»ç»“"><span>6.2 å…¨å±€å¹¶å‘æ ‡è®°æ€»ç»“</span></a></h3><p><strong>ç»è¿‡global concurrent markingï¼Œcollectorå°±çŸ¥é“å“ªäº›Regionæœ‰å­˜æ´»çš„å¯¹è±¡ã€‚å¹¶å°†é‚£äº›å®Œå…¨å¯å›æ”¶çš„Region(æ²¡æœ‰å­˜æ´»å¯¹è±¡)æ”¶é›†èµ·æ¥åŠ å…¥åˆ°å¯åˆ†é…Regioné˜Ÿåˆ—ï¼Œå®ç°å¯¹è¯¥éƒ¨åˆ†å†…å­˜çš„å›æ”¶ã€‚å¯¹äºæœ‰å­˜æ´»å¯¹è±¡çš„Regionï¼ŒG1ä¼šæ ¹æ®ç»Ÿè®¡æ¨¡å‹æ‰¾å¤„æ”¶ç›Šæœ€é«˜ã€å¼€é”€ä¸è¶…è¿‡ç”¨æˆ·æŒ‡å®šçš„ä¸Šé™çš„è‹¥å¹²Regionè¿›è¡Œå¯¹è±¡å›æ”¶ã€‚è¿™äº›é€‰ä¸­è¢«å›æ”¶çš„Regionç»„æˆçš„é›†åˆå°±å«åšcollection set ç®€ç§°Csetï¼</strong></p><p><strong>åœ¨MIXGCä¸­çš„Csetæ˜¯é€‰å®šæ‰€æœ‰young gené‡Œçš„regionï¼Œå¤–åŠ æ ¹æ®global concurrent markingç»Ÿè®¡å¾—å‡ºæ”¶é›†æ”¶ç›Šé«˜çš„è‹¥å¹²old gen regionã€‚</strong></p><p><strong>åœ¨YGCä¸­çš„Csetæ˜¯é€‰å®šæ‰€æœ‰young gené‡Œçš„regionã€‚é€šè¿‡æ§åˆ¶young gençš„regionä¸ªæ•°æ¥æ§åˆ¶young GCçš„å¼€é”€ã€‚</strong></p><p><strong>YGCä¸MIXGCéƒ½æ˜¯é‡‡ç”¨å¤šçº¿ç¨‹å¤åˆ¶æ¸…é™¤ï¼Œæ•´ä¸ªè¿‡ç¨‹ä¼šSTWã€‚ G1çš„ä½å»¶è¿ŸåŸç†åœ¨äºå…¶å›æ”¶çš„åŒºåŸŸå˜å¾—ç²¾ç¡®å¹¶ä¸”èŒƒå›´å˜å°äº†ã€‚</strong></p><h3 id="_6-3-stab-ç»´æŒå¹¶å‘gcçš„æ­£ç¡®æ€§" tabindex="-1"><a class="header-anchor" href="#_6-3-stab-ç»´æŒå¹¶å‘gcçš„æ­£ç¡®æ€§"><span>6.3 STABï¼ˆç»´æŒå¹¶å‘GCçš„æ­£ç¡®æ€§ï¼‰</span></a></h3><p>ä¸Šé¢global concurrent markingæåˆ°äº†STABç®—æ³•ï¼Œé‚£è¿™ä¸ªSTABåˆ°åº•ä¸ºä½•ç‰©ï¼ŸSTABå…¨ç§°ä¸ºsnapshot-at-the-beginningï¼Œå…¶ç›®çš„æ˜¯äº†ç»´æŒå¹¶å‘GCçš„æ­£ç¡®æ€§ã€‚<strong>GCçš„æ­£ç¡®æ€§æ˜¯ä¿è¯å­˜æ´»çš„å¯¹è±¡ä¸è¢«å›æ”¶ï¼Œæ¢å¥è¯æ¥è¯´å°±æ˜¯ä¿è¯å›æ”¶çš„éƒ½æ˜¯åƒåœ¾</strong>ã€‚å¦‚æœæ ‡è®°è¿‡ç¨‹æ˜¯STWçš„è¯ï¼Œé‚£GCçš„æ­£ç¡®æ€§æ˜¯ä¸€å®šèƒ½ä¿è¯çš„ã€‚ä½†å¦‚æœä¸€è¾¹æ ‡è®°ï¼Œä¸€è¾¹åº”ç”¨åœ¨å˜æ›´å †é‡Œé¢å¯¹è±¡çš„å¼•ç”¨ï¼Œé‚£ä¹ˆæ ‡è®°çš„æ­£ç¡®æ€§å°±ä¸ä¸€å®šèƒ½ä¿è¯äº†ã€‚</p><p><strong>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒSTABçš„åšæ³•åœ¨GCå¼€å§‹æ—¶å¯¹å†…å­˜è¿›è¡Œä¸€ä¸ªå¯¹è±¡å›¾çš„é€»è¾‘å¿«ç…§(snapshot)ï¼Œé€šè¿‡GC Roots tracing å‚ç…§å¹¶å‘æ ‡è®°çš„è¿‡ç¨‹ï¼Œåªè¦è¢«å¿«ç…§åˆ°å¯¹è±¡æ˜¯æ´»çš„ï¼Œé‚£åœ¨æ•´ä¸ªGCçš„è¿‡ç¨‹ä¸­å¯¹è±¡å°±è¢«è®¤å®šçš„æ˜¯æ´»çš„ï¼Œå³ä½¿è¯¥å¯¹è±¡çš„å¼•ç”¨ç¨åè¢«ä¿®æ”¹æˆ–è€…åˆ é™¤ã€‚åŒæ—¶æ–°åˆ†é…çš„å¯¹è±¡ä¹Ÿä¼šè¢«è®¤ä¸ºæ˜¯æ´»çš„ï¼Œé™¤æ­¤ä¹‹å¤–å…¶å®ƒä¸å¯è¾¾çš„å¯¹è±¡å°±è¢«è®¤ä¸ºæ˜¯æ­»æ‰äº†ã€‚è¿™æ ·STABå°±ä¿è¯äº†çœŸæ­£å­˜æ´»çš„å¯¹è±¡ä¸ä¼šè¢«GCè¯¯å›æ”¶ï¼Œä½†åŒæ—¶ä¹Ÿé€ æˆäº†æŸäº›å¯ä»¥è¢«å›æ”¶çš„å¯¹è±¡é€ƒè¿‡äº†GCï¼Œå¯¼è‡´äº†å†…å­˜é‡Œé¢å­˜åœ¨æµ®åŠ¨çš„åƒåœ¾(float garbage)ã€‚</strong></p><h3 id="_6-4-stabå…·ä½“ç»†èŠ‚" tabindex="-1"><a class="header-anchor" href="#_6-4-stabå…·ä½“ç»†èŠ‚"><span>6.4 STABå…·ä½“ç»†èŠ‚</span></a></h3><p>æ¯ä¸ªRegionä¸­éƒ½æœ‰é‚£ä¹ˆå‡ ä¸ªæŒ‡é’ˆ</p><p><code>|&lt;-- (1) --&gt;|&lt;-- (2) --&gt;|&lt;-- (3) --&gt;|&lt;-- (4) --&gt;|</code><br> bottom prevTAMS nextTAMS top end</p><p>å…¶ä¸­topæ˜¯è¯¥regionçš„å½“å‰åˆ†é…æŒ‡é’ˆï¼Œ[bottom, top)æ˜¯å½“å‰è¯¥regionå·²ç”¨ï¼ˆusedï¼‰çš„éƒ¨åˆ†ï¼Œ[top, end)æ˜¯å°šæœªä½¿ç”¨çš„å¯åˆ†é…ç©ºé—´ï¼ˆunusedï¼‰ã€‚</p><p>(1): [bottom, prevTAMS): è¿™éƒ¨åˆ†é‡Œçš„å¯¹è±¡å­˜æ´»ä¿¡æ¯å¯ä»¥é€šè¿‡prevBitmapæ¥å¾—çŸ¥</p><p>(2): [prevTAMS, nextTAMS): è¿™éƒ¨åˆ†é‡Œçš„å¯¹è±¡åœ¨ç¬¬n-1è½®concurrent markingæ˜¯éšå¼å­˜æ´»çš„</p><p>(3): [nextTAMS, top): è¿™éƒ¨åˆ†é‡Œçš„å¯¹è±¡åœ¨ç¬¬nè½®concurrent markingæ˜¯éšå¼å­˜æ´»çš„</p><p>ä¸ºä»€ä¹ˆä¼šç”¨prevTAMSå’ŒnextTAMSä¸¤ä¸ªæŒ‡é’ˆï¼Ÿ</p><p>å› ä¸ºG1çš„å¹¶å‘æ ‡è®°çš„è¿‡ç¨‹ç”¨äº†ä¸¤ä¸ªbitmapï¼š</p><p>ä¸€ä¸ªprevBitmapè®°å½•ç¬¬n-1è½®concurrent markæ‰€å¾—çš„å¯¹è±¡å­˜æ´»çŠ¶æ€ã€‚ç”±äºç¬¬nï¼1è½®concurrent markingå·²ç»å®Œæˆï¼Œè¿™ä¸ªbitmapçš„ä¿¡æ¯å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚</p><p>ä¸€ä¸ªnextBitmapè®°å½•ç¬¬nè½®concurrent markçš„ç»“æœã€‚è¿™ä¸ªbitmapæ˜¯å½“å‰å°†è¦æˆ–æ­£åœ¨è¿›è¡Œçš„concurrent markçš„ç»“æœï¼Œå°šæœªå®Œæˆï¼Œæ‰€ä»¥è¿˜ä¸èƒ½ä½¿ç”¨ã€‚</p><p>æ‰€ä»¥Regionä¼šåŒæ—¶å­˜åœ¨prevTAMSå’ŒnextTAMSä¸¤ä¸ªæŒ‡é’ˆï¼Œè¿™ä¸¤ä¸ªæŒ‡é’ˆæ˜¯åœ¨ Initial Marké˜¶æ®µå°±ä¼šè®¾ç½®å¥½ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬å¾ˆå®¹æ˜“çŸ¥é“å“ªäº›å¯¹è±¡åœ¨ä¸€æ¬¡GCå¼€å§‹ä¹‹åæ–°åˆ†é…çš„ï¼šåœ¨TAMSä»¥ä¸Šçš„å¯¹è±¡å°±æ˜¯æ–°åˆ†é…çš„ï¼Œå› è€Œè¢«è§†ä¸ºéšå¼markedï¼Œæ ‡è®°ä¸ºå­˜æ´»ã€‚</p><p>åˆ‡æ¢åˆ°å¦å¤–ä¸€ä¸ªåœºæ™¯ï¼šå¦‚æœåœ¨æ ‡è®°çš„è¿‡ç¨‹ä¸­markäº†æŸä¸ªå¯¹è±¡ä½†å¯¹è±¡ä¸­æŸäº›å¼•ç”¨è¿™å­—æ®µè¿˜æ²¡æœ‰è¢«markåˆ°,æ­¤æ—¶åº”ç”¨å¹¶å‘ä¿®æ”¹å¼•ç”¨å­—æ®µçš„å€¼ï¼Œé‚£collecotrå°±æ‹¿ä¸åˆ°å®Œæ•´çš„å¿«ç…§äº†ï¼Œè¿™ä¸ç¬¦åˆSTABçš„è®¾æƒ³ã€‚</p><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜å°±æœ‰äº†SATB write barrierã€‚G1 GCå…·ä½“ä½¿ç”¨çš„æ˜¯Yuasaå¼çš„SATB write barrierçš„å˜ç§ã€‚å®ƒçš„ç›¸å…³è®ºæ–‡æ˜¯ï¼š</p><ul><li><a href="https://link.zhihu.com/?target=http%3A//dl.acm.org/citation.cfm%3Fid%3D82237" target="_blank" rel="noopener noreferrer">Real-time garbage collection on general-purpose</a></li></ul><p>Write barrieræ˜¯å¯¹â€œå¯¹å¼•ç”¨ç±»å‹å­—æ®µèµ‹å€¼â€è¿™ä¸ªåŠ¨ä½œçš„ç¯åˆ‡ï¼Œä¹Ÿå°±æ˜¯è¯´èµ‹å€¼çš„å‰åéƒ½åœ¨barrierè¦†ç›–çš„èŒƒç•´å†…ã€‚åœ¨èµ‹å€¼å‰çš„éƒ¨åˆ†çš„write barrierå«åšpre-write barrierï¼Œåœ¨èµ‹å€¼åçš„åˆ™å«åšpost-write barrierã€‚</p><p>åœ¨HotSpot VMé‡Œï¼Œåœ¨å¼•å…¥G1 GCä¹‹å‰ï¼Œå…¶å®ƒGCéƒ½åªç”¨äº†post-write barrierï¼Œæ‰€ä»¥å®ƒåœ¨æºç é‡Œæ²¡æœ‰ç‰¹åˆ«çš„å‰åç¼€ï¼›è€ŒG1 GCç‰¹æœ‰çš„pre-write barrieråˆ™åœ¨æºç é‡Œæœ‰_preçš„åç¼€ï¼Œå¯ä»¥ç•™æ„ä¸€ä¸‹ã€‚</p><div class="language-cpp" data-ext="cpp" data-title="cpp"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">void</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> oop_field_store</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">oop</span><span style="color:#C678DD;--shiki-dark:#C678DD;">*</span><span style="color:#E06C75;font-style:italic;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> field</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">oop</span><span style="color:#E06C75;font-style:italic;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> value</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">  pre_write_barrier</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(field);</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">  *</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">field </span><span style="color:#C678DD;--shiki-dark:#C678DD;">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> value;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // the actual store</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">  post_write_barrier</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(field, value);</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre></div><h4 id="_6-4-1-pre-post-write-barrierä¸satbçš„å…³ç³»" tabindex="-1"><a class="header-anchor" href="#_6-4-1-pre-post-write-barrierä¸satbçš„å…³ç³»"><span>6.4.1 Pre/Post-write barrierä¸SATBçš„å…³ç³»</span></a></h4><p>å‰é¢æåˆ°SATBè¦ç»´æŒâ€œåœ¨GCå¼€å§‹æ—¶æ´»çš„å¯¹è±¡â€çš„çŠ¶æ€è¿™ä¸ªé€»è¾‘snapshotã€‚é™¤äº†ä»rootå‡ºå‘æŠŠæ•´ä¸ªå¯¹è±¡å›¾markä¸‹æ¥ä¹‹å¤–ï¼Œå…¶å®åªéœ€è¦ç”¨pre-write barrieræŠŠæ¯æ¬¡å¼•ç”¨å…³ç³»å˜åŒ–æ—¶æ—§çš„å¼•ç”¨å€¼è®°ä¸‹æ¥å°±å¥½äº†ã€‚è¿™æ ·ï¼Œç­‰concurrent markeråˆ°è¾¾æŸä¸ªå¯¹è±¡æ—¶ï¼Œè¿™ä¸ªå¯¹è±¡çš„æ‰€æœ‰å¼•ç”¨ç±»å‹å­—æ®µçš„å˜åŒ–å…¨éƒ½æœ‰è®°å½•åœ¨æ¡ˆï¼Œå°±ä¸ä¼šæ¼æ‰ä»»ä½•åœ¨snapshoté‡Œæ´»çš„å¯¹è±¡ã€‚å½“ç„¶ï¼Œå¾ˆå¯èƒ½æœ‰å¯¹è±¡åœ¨snapshotä¸­æ˜¯æ´»çš„ï¼Œä½†éšç€å¹¶å‘GCçš„è¿›è¡Œå®ƒå¯èƒ½æœ¬æ¥å·²ç»æ­»äº†ï¼Œä½†SATBè¿˜æ˜¯ä¼šè®©å®ƒæ´»è¿‡è¿™æ¬¡GCã€‚</p><p>æ‰€ä»¥åœ¨G1 GCé‡Œï¼Œæ•´ä¸ªwrite barrier+oop_field_storeæ˜¯è¿™æ ·çš„ï¼š</p><div class="language-cpp" data-ext="cpp" data-title="cpp"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">void</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> oop_field_store</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">oop</span><span style="color:#C678DD;--shiki-dark:#C678DD;">*</span><span style="color:#E06C75;font-style:italic;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> field</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">oop</span><span style="color:#E06C75;font-style:italic;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> new_value</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">  pre_write_barrier</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(field);</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">             // pre-write barrier: for maintaining SATB invariant</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">  *</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">field </span><span style="color:#C678DD;--shiki-dark:#C678DD;">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> new_value;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                   // the actual store</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">  post_write_barrier</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(field, new_value);</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // post-write barrier: for tracking cross-region reference</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre></div><p>æŒ‰ç…§Yuasaå¼SATB barrierçš„è®¾è®¡ï¼Œpre-write barrieré‡Œé¢çš„æŠ½è±¡é€»è¾‘åº”å½“å¦‚ä¸‹ï¼š</p><div class="language-cpp" data-ext="cpp" data-title="cpp"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">void</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> pre_write_barrier</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">oop</span><span style="color:#C678DD;--shiki-dark:#C678DD;">*</span><span style="color:#E06C75;font-style:italic;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> field</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">  if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ($gc_phase </span><span style="color:#C678DD;--shiki-dark:#C678DD;">==</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> GC_CONCURRENT_MARK) {</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // SATB invariant only maintained during concurrent marking</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    oop old_value </span><span style="color:#C678DD;--shiki-dark:#C678DD;">=</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> *</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">field;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (old_value </span><span style="color:#C678DD;--shiki-dark:#C678DD;">!=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> null </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">&amp;&amp;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> !</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">is_marked</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(old_value)) {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">      mark_object</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(old_value);</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">      $</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">mark_stack</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">push</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(old_value);</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // scan all of old_value&#39;s fields later</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre></div><p>è¿™æ¯”åŸæœ¬çš„Yuasaå¼è®¾è®¡å°‘äº†äº›ä¸œè¥¿ï¼šæ²¡æœ‰æ£€æŸ¥ç›®æ ‡å¯¹è±¡æ˜¯å¦å·²ç»markï¼Œä¹Ÿä¸å»å¯¹ç›®æ ‡å¯¹è±¡åšmarkå’Œæ‰«æå®ƒçš„å­—æ®µã€‚å®é™…ä¸Šè¯¥åšçš„äº‹æƒ…è¿˜æ˜¯å¾—åšï¼Œåªæ˜¯ä¸åœ¨è¿™é‡Œåšè€Œå·²ã€‚é‚£æ”¾åœ¨é‚£é‡Œåšå‘¢æ”¾åˆ°äº†åé¢çš„logging barrierï¼Œè¿™ä¸ªåé¢è®²åˆ°ã€‚</p><p>Pre-write barrierçš„å®é™…ä»£ç æœ‰å¥½å‡ ä¸ªç‰ˆæœ¬ï¼Œå…¶ä¸­æœ€ç®€å•æ˜ç™½çš„ç‰ˆæœ¬æ˜¯ï¼š</p><div class="language-cpp" data-ext="cpp" data-title="cpp"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // This notes that we don&#39;t need to access any BarrierSet data</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // structures, so this can be called from a static context.</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">  template</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &lt;</span><span style="color:#C678DD;--shiki-dark:#C678DD;">class</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> T</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#C678DD;--shiki-dark:#C678DD;">static</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> void</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> write_ref_field_pre_static</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">T</span><span style="color:#C678DD;--shiki-dark:#C678DD;">*</span><span style="color:#E06C75;font-style:italic;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> field</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">oop</span><span style="color:#E06C75;font-style:italic;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> newVal</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    T heap_oop </span><span style="color:#C678DD;--shiki-dark:#C678DD;">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> oopDesc::</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">load_heap_oop</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(field);</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">!</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">oopDesc</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">::</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">is_null</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(heap_oop)) {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">      enqueue</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">oopDesc</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">::</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">decode_heap_oop</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(heap_oop));</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  }</span></span></code></pre></div><p>enqueueåŠ¨ä½œçš„å®é™…ä»£ç åˆ™åœ¨G1SATBCardTableModRefBS::enqueue(oop pre_val)ã€‚</p><p>å®ƒåˆ¤æ–­å½“å‰æ˜¯å¦åœ¨concurrent marking phaseç”¨çš„æ˜¯ï¼š</p><div class="language-cpp" data-ext="cpp" data-title="cpp"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">JavaThread</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">::</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">satb_mark_queue_set</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">().</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">is_active</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">()</span></span></code></pre></div><h4 id="_6-4-2-logging-write-barrier" tabindex="-1"><a class="header-anchor" href="#_6-4-2-logging-write-barrier"><span>6.4.2 logging write barrier</span></a></h4><p>ä¸ºäº†å°½é‡å‡å°‘write barrierå¯¹åº”ç”¨mutatoræ€§èƒ½çš„å½±å“ï¼ŒG1å°†ä¸€éƒ¨åˆ†åŸæœ¬è¦åœ¨barrieré‡Œåšçš„äº‹æƒ…æŒªåˆ°åˆ«çš„çº¿ç¨‹ä¸Šå¹¶å‘æ‰§è¡Œã€‚<br> å®ç°è¿™ç§åˆ†ç¦»çš„æ–¹å¼å°±æ˜¯é€šè¿‡loggingå½¢å¼çš„write barrierï¼šmutatoråªåœ¨barrieré‡ŒæŠŠè¦åšçš„äº‹æƒ…çš„ä¿¡æ¯è®°ï¼ˆlogï¼‰åˆ°ä¸€ä¸ªé˜Ÿåˆ—é‡Œï¼Œç„¶åå¦å¤–çš„çº¿ç¨‹ä»é˜Ÿåˆ—é‡Œå–å‡ºä¿¡æ¯æ‰¹é‡å®Œæˆå‰©ä½™çš„åŠ¨ä½œã€‚</p><p>ä»¥SATB write barrierä¸ºä¾‹ï¼Œæ¯ä¸ªJavaçº¿ç¨‹æœ‰ä¸€ä¸ªç‹¬ç«‹çš„ã€å®šé•¿çš„SATBMarkQueueï¼Œmutatoråœ¨barrieré‡ŒåªæŠŠold_valueå‹å…¥è¯¥é˜Ÿåˆ—ä¸­ã€‚ä¸€ä¸ªé˜Ÿåˆ—æ»¡äº†ä¹‹åï¼Œå®ƒå°±ä¼šè¢«åŠ åˆ°å…¨å±€çš„SATBé˜Ÿåˆ—é›†åˆSATBMarkQueueSeté‡Œç­‰å¾…å¤„ç†ï¼Œç„¶åç»™å¯¹åº”çš„Javaçº¿ç¨‹æ¢ä¸€ä¸ªæ–°çš„ã€å¹²å‡€çš„é˜Ÿåˆ—ç»§ç»­æ‰§è¡Œä¸‹å»ã€‚</p><p>å¹¶å‘æ ‡è®°ï¼ˆconcurrent markerï¼‰ä¼šå®šæœŸæ£€æŸ¥å…¨å±€SATBé˜Ÿåˆ—é›†åˆçš„å¤§å°ã€‚å½“å…¨å±€é›†åˆä¸­é˜Ÿåˆ—æ•°é‡è¶…è¿‡ä¸€å®šé˜ˆå€¼åï¼Œconcurrent markerå°±ä¼šå¤„ç†é›†åˆé‡Œçš„æ‰€æœ‰é˜Ÿåˆ—ï¼šæŠŠé˜Ÿåˆ—é‡Œè®°å½•çš„æ¯ä¸ªoopéƒ½æ ‡è®°ä¸Šï¼Œå¹¶å°†å…¶å¼•ç”¨å­—æ®µå‹åˆ°æ ‡è®°æ ˆï¼ˆmarking stackï¼‰ä¸Šç­‰åé¢åšè¿›ä¸€æ­¥æ ‡è®°ã€‚</p><p>æ‰€ä»¥æ•´ä¸ªSTABè¿‡ç¨‹è®²å®Œã€‚</p><h2 id="_7-g1å‘½ä»¤è¡Œé€‰é¡¹ä¸æœ€ä½³å®è·µ" tabindex="-1"><a class="header-anchor" href="#_7-g1å‘½ä»¤è¡Œé€‰é¡¹ä¸æœ€ä½³å®è·µ"><span>7. G1å‘½ä»¤è¡Œé€‰é¡¹ä¸æœ€ä½³å®è·µ</span></a></h2><h3 id="_7-1-å‘½ä»¤è¡Œé€‰é¡¹" tabindex="-1"><a class="header-anchor" href="#_7-1-å‘½ä»¤è¡Œé€‰é¡¹"><span>7.1 å‘½ä»¤è¡Œé€‰é¡¹</span></a></h3><ul><li><strong><code>-XX:+UseG1GC</code></strong> å‘Šè¯‰JVMä½¿ç”¨G1æ”¶é›†å™¨</li><li><strong>-XX:MaxGCPauseMillis=200</strong> è®¾ç½®æœ€å¤§GCç›®æ ‡æœ€å¤§åœé¡¿æ—¶é—´ä¸º200msï¼Œè¿™æ˜¯ä¸€ä¸ªè½¯æŒ‡æ ‡ã€‚JVMä¼šæœ€å¤§åŠªåŠ›å»è¾¾åˆ°å®ƒï¼Œå› æ­¤æœ‰æ—¶åœé¡¿æ—¶é—´ä¼šè¾¾ä¸åˆ°è®¾ç½®ç›®æ ‡ã€‚G1é…ç½®æ˜¯200ms</li><li><strong>-XX:InitiatingHeapOccupancyPercent=45</strong> å¯åŠ¨å¹¶å‘æ ‡è®°æ ‡è®°ç™¾åˆ†æ¯”ï¼Œå½“æ•´å †å†…å­˜ä½¿ç”¨é‡è¾¾åˆ°ç™¾åˆ†æ¯”æ—¶ï¼ŒG1ä½¿ç”¨å®ƒæ¥è§¦å‘ä¸€ä¸ªåŸºäºæ•´ä¸ªå †çš„å¹¶å‘æ ‡è®°å¾ªç¯ï¼Œè€Œä¸ä»…ä»…æ˜¯ä¸€ä¸ªä»£ã€‚é»˜å¿µå€¼æ˜¯45%</li></ul><h3 id="_7-2-æœ€ä½³å®è·µ" tabindex="-1"><a class="header-anchor" href="#_7-2-æœ€ä½³å®è·µ"><span>7.2 æœ€ä½³å®è·µ</span></a></h3><p>ä¸‹é¢æœ‰å‡ ä¸ªå…³äºä½¿ç”¨G1çš„æœ€ä½³å®è·µ</p><h4 id="_7-2-1-ä¸è¦è®¾ç½®young-generationå¤§å°" tabindex="-1"><a class="header-anchor" href="#_7-2-1-ä¸è¦è®¾ç½®young-generationå¤§å°"><span>7.2.1 <strong>ä¸è¦è®¾ç½®Young Generationå¤§å°</strong></span></a></h4><p>å› ä¸ºæ˜¾å¼é€šè¿‡-Xmnè®¾ç½®young generationå¤§å°å°†ä¼šå¹²é¢„G1æ”¶é›†å™¨çš„é»˜è®¤è¡Œä¸º</p><ul><li>G1å°†ä¸å†å°Šé‡è®¾å®šçš„pause time,æœ¬è´¨æ¥è¯´æ˜¯å› ä¸ºè®¾ç½®young generationå¤§å°ä½¿å¾—è®¾å®šçš„pause timeç›®æ ‡å¤±æ•ˆã€‚</li><li>G1ä¸å†èƒ½å¤Ÿæ ¹æ®éœ€è¦æ‰©å±•å’Œæ”¶ç¼©young generationçš„ç©ºé—´ã€‚ç”±äºå¤§å°æ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥ä¸èƒ½æ›´æ”¹å¤§å°ã€‚</li></ul><h4 id="_7-2-2-å“åº”æ—¶é—´æŒ‡æ ‡" tabindex="-1"><a class="header-anchor" href="#_7-2-2-å“åº”æ—¶é—´æŒ‡æ ‡"><span>7.2.2 <strong>å“åº”æ—¶é—´æŒ‡æ ‡</strong></span></a></h4><p>ä¸è¦ä½¿ç”¨å¹³å‡å“åº”æ—¶é—´(ART)ä½œä¸ºæŒ‡æ ‡æ¥è®¾ç½®<code>XX:MaxGCPauseMillis=&lt;N&gt;</code>ï¼Œè€Œè¦è€ƒè™‘è®¾ç½®90%ä»¥ä¸Šæ—¶é—´éƒ½èƒ½è¾¾åˆ°ç›®æ ‡çš„å€¼ã€‚è¿™æ„å‘³ç€90%å‘å‡ºè¯·æ±‚çš„ç”¨æˆ·ä¸ä¼šç»å†é«˜äºç›®æ ‡çš„å“åº”æ—¶é—´ã€‚è®°ä½ï¼Œæš‚åœæ—¶é—´æ˜¯ä¸€ä¸ªç›®æ ‡ï¼Œå¹¶ä¸èƒ½ä¿è¯æ€»èƒ½è¾¾åˆ°ã€‚</p><h4 id="_7-2-3-ä»€ä¹ˆæ˜¯evacuation-failure" tabindex="-1"><a class="header-anchor" href="#_7-2-3-ä»€ä¹ˆæ˜¯evacuation-failure"><span>7.2.3 <strong>ä»€ä¹ˆæ˜¯Evacuation Failure</strong></span></a></h4><p>å½“JVMåœ¨GCæœŸé—´å¤åˆ¶å¯¹è±¡åˆ°SurvioråŒºæˆ–æˆ–è€…æå‡å¯¹è±¡æ—¶ï¼Œå †ç©ºé—´è¢«è€—å°½ï¼Œå †åŒºåŸŸå‡çº§å¤±è´¥ã€‚å †æ— æ³•æ‰©å±•ï¼Œå› ä¸ºå®ƒå·²ç»å¤„äºæœ€å¤§å€¼ã€‚è¿™ç§æƒ…å†µåœ¨-XX:+PrintGCDetailså°†ä¼šä»¥TOç©ºé—´æº¢å‡º**(<code>to-space overflow</code>)**çš„å½¢å¼è¡¨ç¤ºã€‚ä»£ä»·æ˜¯ååˆ†æ˜‚è´µçš„ï¼Œå› ä¸º</p><ul><li>GCä»ç„¶éœ€è¦ç»§ç»­ï¼Œæ‰€ä»¥å¿…é¡»é‡Šæ”¾ç©ºé—´</li><li>æœªæˆåŠŸå¤åˆ¶çš„å¯¹è±¡å¿…é¡»åœ¨é€‚å½“çš„ä½ç½®ä¿ç•™</li><li>å¯¹CSetä¸­åŒºåŸŸçš„rsetçš„ä»»ä½•æ›´æ–°éƒ½å¿…é¡»é‡æ–°ç”Ÿæˆ</li><li>æ‰€æœ‰è¿™äº›æ­¥éª¤éƒ½å¾ˆæ˜‚è´µã€‚</li></ul><h4 id="_7-2-4-å¦‚ä½•é¿å…evacuation-failure" tabindex="-1"><a class="header-anchor" href="#_7-2-4-å¦‚ä½•é¿å…evacuation-failure"><span>7.2.4 <strong>å¦‚ä½•é¿å…Evacuation Failure</strong></span></a></h4><p>ä¸ºäº†é¿å…Evacuation Failureï¼Œè€ƒè™‘ä»¥ä¸‹é€‰é¡¹ã€‚</p><ul><li>å¢å¤§å †ï¼ˆå†…å­˜)å¤§å°</li><li><ul><li>å¢å¤§**<code>-XX:G1ReservePercent=n</code>**ï¼Œé»˜è®¤æ˜¯10</li><li>G1ä¼šé¢„ç•™ä¸€éƒ¨åˆ†å†…å­˜ï¼Œåˆ¶é€ ä¸€ä¸ªå‡å¤©èŠ±æ¿ï¼Œå½“çœŸæ­£Evacuation Failureæ—¶è¿˜æœ‰å†…å­˜å¯ç”¨ã€‚</li></ul></li><li>æ—©ç‚¹å¯åŠ¨æ ‡è®°å‘¨æœŸ</li><li>å¢å¤§å¹¶è¡Œæ ‡è®°çš„çº¿ç¨‹æ•°ï¼Œä½¿ç”¨**<code>-XX:ConcGCThreads=n</code>**é€‰é¡¹ã€‚</li></ul><h3 id="_7-3-å®Œæ•´çš„g1-gcå¼€å…³åˆ—è¡¨" tabindex="-1"><a class="header-anchor" href="#_7-3-å®Œæ•´çš„g1-gcå¼€å…³åˆ—è¡¨"><span>7.3 å®Œæ•´çš„G1 GCå¼€å…³åˆ—è¡¨</span></a></h3><ul><li>-XX:+UseG1GC ä½¿ç”¨G1 GCã€‚</li><li>-XX:MaxGCPauseMillis=n è®¾ç½®æœ€å¤§GCåœé¡¿æ—¶é—´ï¼Œè¿™æ˜¯ä¸€ä¸ªè½¯ç›®æ ‡ï¼ŒJVMä¼šå°½æœ€å¤§åŠªåŠ›å»è¾¾åˆ°å®ƒã€‚</li><li>-XX:InitiatingHeapOccupancyPercent=n å¯åŠ¨å¹¶å‘æ ‡è®°å¾ªç¯çš„å †å ç”¨ç‡çš„ç™¾åˆ†æ¯”ï¼Œå½“æ•´ä¸ªå †çš„å ç”¨è¾¾åˆ°æ¯”ä¾‹æ—¶ï¼Œå¯åŠ¨ä¸€ä¸ªå…¨å±€å¹¶å‘æ ‡è®°å¾ªç¯ï¼Œ0ä»£è¡¨å¹¶å‘æ ‡è®°ä¸€ç›´è¿è¡Œã€‚é»˜è®¤å€¼æ˜¯45%ã€‚</li><li>-XX:NewRatio=n æ–°ç”Ÿä»£å’Œè€å¹´ä»£å¤§å°çš„æ¯”ä¾‹ï¼Œé»˜è®¤æ˜¯2ã€‚</li><li>-XX:SurvivorRatio=n edenå’ŒsurvivoråŒºåŸŸç©ºé—´å¤§å°çš„æ¯”ä¾‹ï¼Œé»˜è®¤æ˜¯8ã€‚</li><li>-XX:MaxTenuringThreshold=n æ™‹å‡çš„é˜ˆå€¼ï¼Œé»˜è®¤æ˜¯15ï¼ˆä¸€ä¸ªå­˜æ´»å¯¹è±¡ç»å†å¤šå°‘æ¬¡GCå‘¨æœŸä¹‹åæ™‹å‡åˆ°è€å¹´ä»£)ã€‚</li><li>-XX:ParallelGCThreads=n è®¾ç½®GCå¹¶å‘é˜¶æ®µçš„çº¿ç¨‹æ•°ï¼Œé»˜è®¤å€¼ä¸JVMè¿è¡Œå¹³å°ç›¸å…³ã€‚</li><li>-XX:ConcGCThreads=n è®¾ç½®å¹¶å‘æ ‡è®°çš„çº¿ç¨‹æ•°ï¼Œé»˜è®¤å€¼ä¸JVMè¿è¡Œå¹³å°ç›¸å…³ã€‚</li><li>-XX:G1ReservePercent=n è®¾ç½®ä¿ç•™javaå †å¤§å°æ¯”ä¾‹ï¼Œç”¨äºé˜²æ­¢æ™‹å‡å¤±è´¥/Evacuation Failure,é»˜è®¤å€¼æ˜¯10%ã€‚</li><li>-XX:G1HeapRegionSize=n è®¾ç½®Regionçš„å¤§å°ï¼Œé»˜è®¤æ˜¯æ ¹æ®å †çš„å¤§å°åŠ¨æ€å†³å®šï¼Œå¤§å°èŒƒå›´æ˜¯[1M,32M]</li></ul><h2 id="_8-æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#_8-æ€»ç»“"><span>8. æ€»ç»“</span></a></h2><ul><li>G1æŠŠå†…å­˜åˆ†æˆä¸€å—å—çš„Regionï¼Œæ¯å—çš„Regionçš„å¤§å°éƒ½æ˜¯ä¸€æ ·çš„ã€‚</li><li>G1ä¿ç•™äº†YGCå¹¶åŠ ä¸Šäº†ä¸€ç§å…¨æ–°çš„MIXGCç”¨äºæ”¶é›†è€å¹´ä»£ã€‚G1ä¸­æ²¡æœ‰Full GCï¼ŒG1ä¸­çš„Full GCæ˜¯é‡‡ç”¨serial old Full GCã€‚åœ¨MIXGCä¸­çš„Csetæ˜¯é€‰å®šæ‰€æœ‰young gené‡Œçš„regionï¼Œå¤–åŠ æ ¹æ®global concurrent markingç»Ÿè®¡å¾—å‡ºæ”¶é›†æ”¶ç›Šé«˜çš„è‹¥å¹²old gen regionã€‚åœ¨YGCä¸­çš„Csetæ˜¯é€‰å®šæ‰€æœ‰young gené‡Œçš„regionã€‚é€šè¿‡æ§åˆ¶young gençš„regionä¸ªæ•°æ¥æ§åˆ¶young GCçš„å¼€é”€ã€‚YGCä¸MIXGCéƒ½æ˜¯é‡‡ç”¨å¤šçº¿ç¨‹å¤åˆ¶æ¸…é™¤ï¼Œæ•´ä¸ªè¿‡ç¨‹ä¼šSTWã€‚</li><li>G1çš„ä½å»¶è¿ŸåŸç†åœ¨äºå…¶å›æ”¶çš„åŒºåŸŸå˜å¾—ç²¾ç¡®å¹¶ä¸”èŒƒå›´å˜å°äº†ã€‚</li><li>å…¨å±€å¹¶å‘æ ‡è®°åˆ†çš„äº”ä¸ªé˜¶æ®µã€‚</li><li>ç”¨STABæ¥ç»´æŒå¹¶å‘GCçš„å‡†ç¡®æ€§ã€‚</li><li>ä½¿ç”¨G1çš„æœ€ä½³å®è·µ</li><li>G1 GCæ—¥å¿—æ‰“å°</li></ul><h2 id="å‚è€ƒæ–‡ç« " tabindex="-1"><a class="header-anchor" href="#å‚è€ƒæ–‡ç« "><span>å‚è€ƒæ–‡ç« </span></a></h2><p><a href="https://zhuanlan.zhihu.com/p/52841787" target="_blank" rel="noopener noreferrer">G1 æ”¶é›†å™¨åŸç†ç†è§£ä¸åˆ†æ</a></p></div><!--[--><div class="sponsor" data-v-98f29c97><div id="drinks-box" data-v-98f29c97><div id="drinks-box-s" class="drinks-button left-100" data-v-98f29c97><div id="drinks-icons" class="left-100 tr3" data-v-98f29c97><div id="coffee-donate" class="icon-donate" data-v-98f29c97><span class="font-icon icon iconfont icon-hk-flutter" data-v-98f29c97></span> èµåŠ© </div></div><div id="drinks-button-box" class="tr3 left-100" data-v-98f29c97><div id="drinks-button-bg" class="left-100" data-v-98f29c97></div><div id="github-box" data-v-98f29c97><a href="https://github.com/OrageKK/sponsor-page" target="_blank" data-v-98f29c97>Github</a></div><ul id="donate-buttons" class="list tr3" data-v-98f29c97><li id="paypal_donate" data-v-98f29c97><a href="https://www.paypal.me/oragekk" target="_blank" data-v-98f29c97>Paypal</a></li><!-- <li id="btc_donate" class="donate-button">Bitcoin</li> --><li id="alipay_donate" class="donate-button" data-v-98f29c97>AliPay</li><li id="wechat_donate" class="donate-button2" data-v-98f29c97>WeChat</li></ul></div><div id="drinks-qrcodes" class="left-100 tr3" data-v-98f29c97><div id="drinks-qrcode" data-v-98f29c97></div></div></div></div></div><!--]--><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/MrjackC/mrjackc.github.io/edit/main/src/posts/Java/JavaJVM/java-jvm-gc-g1-supplement.md" aria-label="åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ" rel="noopener noreferrer" target="_blank"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ<!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="contributors"><span class="vp-meta-label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="vp-meta-info" title="email: 845886914@qq.com">MrJason</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/posts/Java/JavaJVM/java-jvm-gc-g1.html" aria-label="GC - Java åƒåœ¾å›æ”¶å™¨ä¹‹G1è¯¦è§£"><div class="hint"><span class="arrow start"></span>ä¸Šä¸€é¡µ</div><div class="link"><!---->GC - Java åƒåœ¾å›æ”¶å™¨ä¹‹G1è¯¦è§£</div></a><a class="route-link auto-link next" href="/posts/Java/JavaJVM/java-jvm-cms-gc.html" aria-label="GC - Java åƒåœ¾å›æ”¶å™¨ä¹‹CMS GCé—®é¢˜åˆ†æä¸è§£å†³"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">GC - Java åƒåœ¾å›æ”¶å™¨ä¹‹CMS GCé—®é¢˜åˆ†æä¸è§£å†³<!----></div></a></nav><div id="vp-comment" class="waline-wrapper" darkmode="false" style="display:block;"><div data-waline provider="Waline"><div class="wl-reaction"><div class="wl-reaction-title">ä½ è®¤ä¸ºè¿™ç¯‡æ–‡ç« æ€ä¹ˆæ ·ï¼Ÿ</div><ul class="wl-reaction-list"><!--[--><li class="wl-reaction-item"><div class="wl-reaction-img"><img src="//unpkg.com/@waline/emojis/tieba/tieba_agree.png"><div class="wl-reaction-votes">0</div></div><div class="wl-reaction-text"></div></li><li class="wl-reaction-item"><div class="wl-reaction-img"><img src="//unpkg.com/@waline/emojis/tieba/tieba_look_down.png"><div class="wl-reaction-votes">0</div></div><div class="wl-reaction-text"></div></li><li class="wl-reaction-item"><div class="wl-reaction-img"><img src="//unpkg.com/@waline/emojis/tieba/tieba_sunglasses.png"><div class="wl-reaction-votes">0</div></div><div class="wl-reaction-text"></div></li><li class="wl-reaction-item"><div class="wl-reaction-img"><img src="//unpkg.com/@waline/emojis/tieba/tieba_pick_nose.png"><div class="wl-reaction-votes">0</div></div><div class="wl-reaction-text"></div></li><li class="wl-reaction-item"><div class="wl-reaction-img"><img src="//unpkg.com/@waline/emojis/tieba/tieba_awkward.png"><div class="wl-reaction-votes">0</div></div><div class="wl-reaction-text"></div></li><li class="wl-reaction-item"><div class="wl-reaction-img"><img src="//unpkg.com/@waline/emojis/tieba/tieba_sleep.png"><div class="wl-reaction-votes">0</div></div><div class="wl-reaction-text"></div></li><!--]--></ul></div><div class="wl-comment"><!--v-if--><div class="wl-panel"><div class="wl-header item3"><!--[--><div class="wl-header-item"><label for="wl-nick">æ˜µç§°</label><input id="wl-nick" class="wl-input wl-nick" name="nick" type="text" value></div><div class="wl-header-item"><label for="wl-mail">é‚®ç®±</label><input id="wl-mail" class="wl-input wl-mail" name="mail" type="email" value></div><div class="wl-header-item"><label for="wl-link">ç½‘å€(å¯é€‰)</label><input id="wl-link" class="wl-input wl-link" name="link" type="text" value></div><!--]--></div><textarea id="wl-edit" class="wl-editor" placeholder="è¯·ç•™è¨€ã€‚(å¡«å†™é‚®ç®±å¯åœ¨è¢«å›å¤æ—¶æ”¶åˆ°é‚®ä»¶æé†’)"></textarea><div class="wl-preview" style="display:none;"><hr><h4>é¢„è§ˆ:</h4><div class="wl-content"></div></div><div class="wl-footer"><div class="wl-actions"><a href="https://guides.github.com/features/mastering-markdown/" title="Markdown Guide" aria-label="Markdown is supported" class="wl-action" target="_blank" rel="noopener noreferrer"><svg width="16" height="16" ariaHidden="true"><path d="M14.85 3H1.15C.52 3 0 3.52 0 4.15v7.69C0 12.48.52 13 1.15 13h13.69c.64 0 1.15-.52 1.15-1.15v-7.7C16 3.52 15.48 3 14.85 3zM9 11H7V8L5.5 9.92 4 8v3H2V5h2l1.5 2L7 5h2v6zm2.99.5L9.5 8H11V5h2v3h1.5l-2.51 3.5z" fill="currentColor"></path></svg></a><button type="button" class="wl-action" title="è¡¨æƒ…" style="display:none;"><svg viewBox="0 0 1024 1024" width="24" height="24"><path d="M563.2 463.3 677 540c1.7 1.2 3.7 1.8 5.8 1.8.7 0 1.4-.1 2-.2 2.7-.5 5.1-2.1 6.6-4.4l25.3-37.8c1.5-2.3 2.1-5.1 1.6-7.8s-2.1-5.1-4.4-6.6l-73.6-49.1 73.6-49.1c2.3-1.5 3.9-3.9 4.4-6.6.5-2.7 0-5.5-1.6-7.8l-25.3-37.8a10.1 10.1 0 0 0-6.6-4.4c-.7-.1-1.3-.2-2-.2-2.1 0-4.1.6-5.8 1.8l-113.8 76.6c-9.2 6.2-14.7 16.4-14.7 27.5.1 11 5.5 21.3 14.7 27.4zM387 348.8h-45.5c-5.7 0-10.4 4.7-10.4 10.4v153.3c0 5.7 4.7 10.4 10.4 10.4H387c5.7 0 10.4-4.7 10.4-10.4V359.2c0-5.7-4.7-10.4-10.4-10.4zm333.8 241.3-41-20a10.3 10.3 0 0 0-8.1-.5c-2.6.9-4.8 2.9-5.9 5.4-30.1 64.9-93.1 109.1-164.4 115.2-5.7.5-9.9 5.5-9.5 11.2l3.9 45.5c.5 5.3 5 9.5 10.3 9.5h.9c94.8-8 178.5-66.5 218.6-152.7 2.4-5 .3-11.2-4.8-13.6zm186-186.1c-11.9-42-30.5-81.4-55.2-117.1-24.1-34.9-53.5-65.6-87.5-91.2-33.9-25.6-71.5-45.5-111.6-59.2-41.2-14-84.1-21.1-127.8-21.1h-1.2c-75.4 0-148.8 21.4-212.5 61.7-63.7 40.3-114.3 97.6-146.5 165.8-32.2 68.1-44.3 143.6-35.1 218.4 9.3 74.8 39.4 145 87.3 203.3.1.2.3.3.4.5l36.2 38.4c1.1 1.2 2.5 2.1 3.9 2.6 73.3 66.7 168.2 103.5 267.5 103.5 73.3 0 145.2-20.3 207.7-58.7 37.3-22.9 70.3-51.5 98.1-85 27.1-32.7 48.7-69.5 64.2-109.1 15.5-39.7 24.4-81.3 26.6-123.8 2.4-43.6-2.5-87-14.5-129zm-60.5 181.1c-8.3 37-22.8 72-43 104-19.7 31.1-44.3 58.6-73.1 81.7-28.8 23.1-61 41-95.7 53.4-35.6 12.7-72.9 19.1-110.9 19.1-82.6 0-161.7-30.6-222.8-86.2l-34.1-35.8c-23.9-29.3-42.4-62.2-55.1-97.7-12.4-34.7-18.8-71-19.2-107.9-.4-36.9 5.4-73.3 17.1-108.2 12-35.8 30-69.2 53.4-99.1 31.7-40.4 71.1-72 117.2-94.1 44.5-21.3 94-32.6 143.4-32.6 49.3 0 97 10.8 141.8 32 34.3 16.3 65.3 38.1 92 64.8 26.1 26 47.5 56 63.6 89.2 16.2 33.2 26.6 68.5 31 105.1 4.6 37.5 2.7 75.3-5.6 112.3z" fill="currentColor"></path></svg></button><button type="button" class="wl-action" title="è¡¨æƒ…åŒ…"><svg width="24" height="24" fill="currentcolor" viewBox="0 0 24 24"><path style="transform: translateY(0.5px)" d="M18.968 10.5H15.968V11.484H17.984V12.984H15.968V15H14.468V9H18.968V10.5V10.5ZM8.984 9C9.26533 9 9.49967 9.09367 9.687 9.281C9.87433 9.46833 9.968 9.70267 9.968 9.984V10.5H6.499V13.5H8.468V12H9.968V14.016C9.968 14.2973 9.87433 14.5317 9.687 14.719C9.49967 14.9063 9.26533 15 8.984 15H5.984C5.70267 15 5.46833 14.9063 5.281 14.719C5.09367 14.5317 5 14.2973 5 14.016V9.985C5 9.70367 5.09367 9.46933 5.281 9.282C5.46833 9.09467 5.70267 9.001 5.984 9.001H8.984V9ZM11.468 9H12.968V15H11.468V9V9Z"></path><path d="M18.5 3H5.75C3.6875 3 2 4.6875 2 6.75V18C2 20.0625 3.6875 21.75 5.75 21.75H18.5C20.5625 21.75 22.25 20.0625 22.25 18V6.75C22.25 4.6875 20.5625 3 18.5 3ZM20.75 18C20.75 19.2375 19.7375 20.25 18.5 20.25H5.75C4.5125 20.25 3.5 19.2375 3.5 18V6.75C3.5 5.5125 4.5125 4.5 5.75 4.5H18.5C19.7375 4.5 20.75 5.5125 20.75 6.75V18Z"></path></svg></button><input id="wl-image-upload" class="upload" aria-hidden="true" type="file" accept=".png,.jpg,.jpeg,.webp,.bmp,.gif"><label for="wl-image-upload" class="wl-action" title="ä¸Šä¼ å›¾ç‰‡" aria-label="ä¸Šä¼ å›¾ç‰‡"><svg viewBox="0 0 1024 1024" width="24" height="24"><path d="M784 112H240c-88 0-160 72-160 160v480c0 88 72 160 160 160h544c88 0 160-72 160-160V272c0-88-72-160-160-160zm96 640c0 52.8-43.2 96-96 96H240c-52.8 0-96-43.2-96-96V272c0-52.8 43.2-96 96-96h544c52.8 0 96 43.2 96 96v480z" fill="currentColor"></path><path d="M352 480c52.8 0 96-43.2 96-96s-43.2-96-96-96-96 43.2-96 96 43.2 96 96 96zm0-128c17.6 0 32 14.4 32 32s-14.4 32-32 32-32-14.4-32-32 14.4-32 32-32zm462.4 379.2-3.2-3.2-177.6-177.6c-25.6-25.6-65.6-25.6-91.2 0l-80 80-36.8-36.8c-25.6-25.6-65.6-25.6-91.2 0L200 728c-4.8 6.4-8 14.4-8 24 0 17.6 14.4 32 32 32 9.6 0 16-3.2 22.4-9.6L380.8 640l134.4 134.4c6.4 6.4 14.4 9.6 24 9.6 17.6 0 32-14.4 32-32 0-9.6-4.8-17.6-9.6-24l-52.8-52.8 80-80L769.6 776c6.4 4.8 12.8 8 20.8 8 17.6 0 32-14.4 32-32 0-8-3.2-16-8-20.8z" fill="currentColor"></path></svg></label><button type="button" class="wl-action" title="é¢„è§ˆ"><svg viewBox="0 0 1024 1024" width="24" height="24"><path d="M710.816 654.301c70.323-96.639 61.084-230.578-23.705-314.843-46.098-46.098-107.183-71.109-172.28-71.109-65.008 0-126.092 25.444-172.28 71.109-45.227 46.098-70.756 107.183-70.756 172.106 0 64.923 25.444 126.007 71.194 172.106 46.099 46.098 107.184 71.109 172.28 71.109 51.414 0 100.648-16.212 142.824-47.404l126.53 126.006c7.058 7.06 16.297 10.979 26.406 10.979 10.105 0 19.343-3.919 26.402-10.979 14.467-14.467 14.467-38.172 0-52.723L710.816 654.301zm-315.107-23.265c-65.88-65.88-65.88-172.54 0-238.42 32.069-32.07 74.245-49.149 119.471-49.149 45.227 0 87.407 17.603 119.472 49.149 65.88 65.879 65.88 172.539 0 238.42-63.612 63.178-175.242 63.178-238.943 0zm0 0" fill="currentColor"></path><path d="M703.319 121.603H321.03c-109.8 0-199.469 89.146-199.469 199.38v382.034c0 109.796 89.236 199.38 199.469 199.38h207.397c20.653 0 37.384-16.645 37.384-37.299 0-20.649-16.731-37.296-37.384-37.296H321.03c-68.582 0-124.352-55.77-124.352-124.267V321.421c0-68.496 55.77-124.267 124.352-124.267h382.289c68.582 0 124.352 55.771 124.352 124.267V524.72c0 20.654 16.736 37.299 37.385 37.299 20.654 0 37.384-16.645 37.384-37.299V320.549c-.085-109.8-89.321-198.946-199.121-198.946zm0 0" fill="currentColor"></path></svg></button></div><div class="wl-info"><div class="wl-captcha-container"></div><div class="wl-text-number">0 <span> Â /Â  <span class="">300</span></span> Â å­—</div><button type="button" class="wl-btn">ç™»å½•</button><button type="submit" class="primary wl-btn" title="Cmd|Ctrl + Enter"><!--[-->æäº¤<!--]--></button></div><div class="wl-gif-popup"><input type="text" placeholder="æœç´¢è¡¨æƒ…åŒ…"><!--v-if--><div class="wl-loading"><svg width="30" height="30" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid"><circle cx="50" cy="50" fill="none" stroke="currentColor" strokeWidth="4" r="40" stroke-dasharray="85 30"><animateTransform attributeName="transform" type="rotate" repeatCount="indefinite" dur="1s" values="0 50 50;360 50 50" keyTimes="0;1"></animateTransform></circle></svg></div></div><div class="wl-emoji-popup"><!--[--><!--]--><!--v-if--></div></div></div><!--v-if--></div><div class="wl-meta-head"><div class="wl-count"><!--v-if--> è¯„è®º</div><ul class="wl-sort"><!--[--><li class="active">æŒ‰æ­£åº</li><li class="">æŒ‰å€’åº</li><li class="">æŒ‰çƒ­åº¦</li><!--]--></ul></div><div class="wl-cards"><!--[--><!--]--></div><div class="wl-loading"><svg width="30" height="30" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid"><circle cx="50" cy="50" fill="none" stroke="currentColor" strokeWidth="4" r="40" stroke-dasharray="85 30"><animateTransform attributeName="transform" type="rotate" repeatCount="indefinite" dur="1s" values="0 50 50;360 50 50" keyTimes="0;1"></animateTransform></circle></svg></div><div class="wl-power"> Powered by <a href="https://github.com/walinejs/waline" target="_blank" rel="noopener noreferrer"> Waline </a> v3.3.2</div></div></div><!----><!--]--></main><!--]--><div style="--0dfcb062:;"><footer class="footer-wrapper" style="display:none;"><div class="busuanzi"><span id="busuanzi_container_site_pv" style="display:none;"> æœ¬ç«™æ€»è®¿é—®é‡ <span id="busuanzi_value_site_pv"></span>æ¬¡ <span class="post-meta-divider">|</span></span><span id="busuanzi_container_site_uv" style="display:none;"> æ‚¨æ˜¯æœ¬ç«™ç¬¬ <span id="busuanzi_value_site_uv"></span>ä½è®¿é—®è€… </span></div><div class="footer-content"><div class="footer">é»˜è®¤é¡µè„š</div><div class="copyright">Copyright Â© 2020-2024 MrJason</div></div><span id="runtime_span"></span><div class="footer-link"><a href="https://www.foreverblog.cn/go.html" target="_blank"><img src="https://img.foreverblog.cn/wormhole_1.gif" alt="" style="width:auto;height:32px;" title="ç©¿æ¢­è™«æ´-éšæœºè®¿é—®åå¹´ä¹‹çº¦å‹é“¾åšå®¢"></a><a href="https://www.travellings.cn/go.html" target="_blank"><img src="https://www.travellings.cn/assets/logo.gif" alt="" style="width:auto;height:32px;" title="å¼€å¾€-å‹é“¾æ¥åŠ›"></a></div></footer></div></div><!--]--><!--[--><!----><!----><div></div><!----><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-DQS7qcOs.js" defer></script>
  </body>
</html>
